ì
@C:\work\code\OWASP-WebGoat\WebGoat\App_Code\CustomerLoginData.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 

class 
CustomerLoginData "
{		 
public

 
string

 
email

 
=

 
string

 $
.

$ %
Empty

% *
;

* +
public 
string 
password 
=  
string! '
.' (
Empty( -
;- .
public 
bool 

isLoggedIn 
=  
false! &
;& '
public 
string 
message 
= 
string  &
.& '
Empty' ,
;, -
public 
CustomerLoginData  
(  !
string! '
email( -
,- .
string/ 5
password6 >
,> ?
bool@ D

isLoggedInE O
)O P
{ 	
this 
. 
email 
= 
email 
; 
this 
. 
password 
= 
password $
;$ %
this 
. 

isLoggedIn 
= 

isLoggedIn (
;( )
} 	
public 
String 
Message 
{ 	
get 
{ 
return 
this 
. 
message #
;# $
} 
set 
{ 
value 
= 
message 
;  
} 
} 	
}!! 
}"" º/
AC:\work\code\OWASP-WebGoat\WebGoat\Content\ForgotPassword.aspx.cs
	namespace

 	
OWASP


 
.

 
WebGoat

 
.

 
NET

 
{ 
public 

partial 
class 
ForgotPassword '
:( )
System* 0
.0 1
Web1 4
.4 5
UI5 7
.7 8
Page8 <
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
if 
( 
! 
Page 
. 

IsPostBack  
)  !
{ $
PanelForgotPasswordStep2 (
.( )
Visible) 0
=1 2
false3 8
;8 9$
PanelForgotPasswordStep3 (
.( )
Visible) 0
=1 2
false3 8
;8 9
} 
} 	
	protected 
void "
ButtonCheckEmail_Click -
(- .
object. 4
sender5 ;
,; <
	EventArgs= F
eG H
)H I
{ 	
string 
[ 
] 
result 
= 
du  
.  !(
GetSecurityQuestionAndAnswer! =
(= >
txtEmail> F
.F G
TextG K
)K L
;L M
if 
( 
string 
. 
IsNullOrEmpty $
($ %
result% +
[+ ,
$num, -
]- .
). /
)/ 0
{ 
labelQuestion 
. 
Text "
=# $
$str% X
;X Y$
PanelForgotPasswordStep2   (
.  ( )
Visible  ) 0
=  1 2
false  3 8
;  8 9$
PanelForgotPasswordStep3!! (
.!!( )
Visible!!) 0
=!!1 2
false!!3 8
;!!8 9
return## 
;## 
}$$ 
labelQuestion%% 
.%% 
Text%% 
=%%  
$str%%! Y
+%%Z [
result%%\ b
[%%b c
$num%%c d
]%%d e
+%%f g
$str%%h s
;%%s t$
PanelForgotPasswordStep2&& $
.&&$ %
Visible&&% ,
=&&- .
true&&/ 3
;&&3 4$
PanelForgotPasswordStep3'' $
.''$ %
Visible''% ,
=''- .
false''/ 4
;''4 5

HttpCookie** 
cookie** 
=** 
new**  #

HttpCookie**$ .
(**. /
$str**/ @
)**@ A
;**A B
cookie.. 
... 
Value.. 
=.. 
Encoder.. "
..." #
Encode..# )
(..) *
Encoder..* 1
...1 2
Encode..2 8
(..8 9
result..9 ?
[..? @
$num..@ A
]..A B
)..B C
)..C D
;..D E
Response00 
.00 
Cookies00 
.00 
Add00  
(00  !
cookie00! '
)00' (
;00( )
}11 	
	protected33 
void33 '
ButtonRecoverPassword_Click33 2
(332 3
object333 9
sender33: @
,33@ A
	EventArgs33B K
e33L M
)33M N
{44 	
try55 
{66 
string88 
encrypted_password88 )
=88* +
Request88, 3
.883 4
Cookies884 ;
[88; <
$str88< M
]88M N
.88N O
Value88O T
.88T U
ToString88U ]
(88] ^
)88^ _
;88_ `
string;; 
security_answer;; &
=;;' (
Encoder;;) 0
.;;0 1
Decode;;1 7
(;;7 8
Encoder;;8 ?
.;;? @
Decode;;@ F
(;;F G
encrypted_password;;G Y
);;Y Z
);;Z [
;;;[ \
if== 
(== 
security_answer== #
.==# $
Trim==$ (
(==( )
)==) *
.==* +
ToLower==+ 2
(==2 3
)==3 4
.==4 5
Equals==5 ;
(==; <
	txtAnswer==< E
.==E F
Text==F J
.==J K
Trim==K O
(==O P
)==P Q
.==Q R
ToLower==R Y
(==Y Z
)==Z [
)==[ \
)==\ ]
{>> $
PanelForgotPasswordStep1?? ,
.??, -
Visible??- 4
=??5 6
false??7 <
;??< =$
PanelForgotPasswordStep2@@ ,
.@@, -
Visible@@- 4
=@@5 6
false@@7 <
;@@< =$
PanelForgotPasswordStep3AA ,
.AA, -
VisibleAA- 4
=AA5 6
trueAA7 ;
;AA; <
labelPasswordBB !
.BB! "
TextBB" &
=BB' (
$strBB) v
+BBw x
getPassword	BBy „
(
BB„ …
txtEmail
BB… 
.
BB Ž
Text
BBŽ ’
)
BB’ “
;
BB“ ”
}CC 
}DD 
catchEE 
(EE 
	ExceptionEE 
exEE 
)EE  
{FF 
labelMessageGG 
.GG 
TextGG !
=GG" #
$strGG$ r
+GGs t
exGGu w
.GGw x
MessageGGx 
;	GG €
}HH 
}II 	
stringKK 
getPasswordKK 
(KK 
stringKK !
emailKK" '
)KK' (
{LL 	
stringMM 
passwordMM 
=MM 
duMM  
.MM  !
GetPasswordByEmailMM! 3
(MM3 4
emailMM4 9
)MM9 :
;MM: ;
returnNN 
passwordNN 
;NN 
}OO 	
}QQ 
}RR Õ
IC:\work\code\OWASP-WebGoat\WebGoat\Content\UploadPathManipulation.aspx.cs
	namespace		 	
OWASP		
 
.		 
WebGoat		 
.		 
NET		 
{

 
public 

partial 
class "
UploadPathManipulation /
:0 1
System2 8
.8 9
Web9 <
.< =
UI= ?
.? @
Page@ D
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
	protected 
void 
btnUpload_Click &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
if 
( 
FileUpload1 
. 
HasFile #
)# $
{ 
try 
{ 
string 
filename #
=$ %
Path& *
.* +
GetFileName+ 6
(6 7
FileUpload17 B
.B C
FileNameC K
)K L
;L M
FileUpload1 
.  
SaveAs  &
(& '
Server' -
.- .
MapPath. 5
(5 6
$str6 O
)O P
+Q R
filenameS [
)[ \
;\ ]
labelUpload 
.  
Text  $
=% &
$str' a
+b c
FileUpload1d o
.o p
FileNamep x
+y z
$str	{ »
;
» ¼
} 
catch 
( 
	Exception  
ex! #
)# $
{ 
labelUpload 
.  
Text  $
=% &
$str' e
+f g
exh j
.j k
Messagek r
+s t
$stru }
;} ~
}   
finally!! 
{"" 
labelUpload## 
.##  
Visible##  '
=##( )
true##* .
;##. /
}$$ 
}%% 
}&& 	
}'' 
}(( ¢ 
1C:\work\code\OWASP-WebGoat\WebGoat\Global.asax.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 

class 
Global 
: 
System  
.  !
Web! $
.$ %
HttpApplication% 4
{ 
	protected 
void 
Application_Start (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{ 	
if 
( 
Debugger 
. 

IsAttached #
)# $
BasicConfigurator !
.! "
	Configure" +
(+ ,
), -
;- .
else 
XmlConfigurator 
.  
	Configure  )
() *
)* +
;+ ,
Settings 
. 
Init 
( 
Server  
)  !
;! "
} 	
	protected 
void 
Session_Start $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
} 	
	protected 
void $
Application_BeginRequest /
(/ 0
object0 6
sender7 =
,= >
	EventArgs? H
eI J
)J K
{ 	
}!! 	
	protected## 
void## +
Application_AuthenticateRequest## 6
(##6 7
object##7 =
sender##> D
,##D E
	EventArgs##F O
e##P Q
)##Q R
{$$ 	
if(( 
((( 
HttpContext(( 
.(( 
Current(( #
.((# $
User(($ (
!=(() +
null((, 0
)((0 1
{)) 
if** 
(** 
HttpContext** 
.**  
Current**  '
.**' (
User**( ,
.**, -
Identity**- 5
.**5 6
IsAuthenticated**6 E
)**E F
{++ 
if,, 
(,, 
HttpContext,, #
.,,# $
Current,,$ +
.,,+ ,
User,,, 0
.,,0 1
Identity,,1 9
is,,: <
FormsIdentity,,= J
),,J K
{-- 
FormsIdentity.. %
id..& (
=..) *
(// 
FormsIdentity// *
)//* +
HttpContext//+ 6
.//6 7
Current//7 >
.//> ?
User//? C
.//C D
Identity//D L
;//L M%
FormsAuthenticationTicket00 1
ticket002 8
=009 :
id00; =
.00= >
Ticket00> D
;00D E
string33 
userData33 '
=33( )
ticket33* 0
.330 1
UserData331 9
;339 :
string44 
[44 
]44  
roles44! &
=44' (
userData44) 1
.441 2
Split442 7
(447 8
$char448 ;
)44; <
;44< =
HttpContext55 #
.55# $
Current55$ +
.55+ ,
User55, 0
=551 2
new553 6
GenericPrincipal557 G
(55G H
id55H J
,55J K
roles55L Q
)55Q R
;55R S
}66 
}77 
}88 
}99 	
	protected;; 
void;; 
Application_Error;; (
(;;( )
object;;) /
sender;;0 6
,;;6 7
	EventArgs;;8 A
e;;B C
);;C D
{<< 	
}>> 	
	protected@@ 
void@@ 
Session_End@@ "
(@@" #
object@@# )
sender@@* 0
,@@0 1
	EventArgs@@2 ;
e@@< =
)@@= >
{AA 	
}CC 	
	protectedEE 
voidEE 
Application_EndEE &
(EE& '
objectEE' -
senderEE. 4
,EE4 5
	EventArgsEE6 ?
eEE@ A
)EEA B
{FF 	
}HH 	
}II 
}JJ ‰
8C:\work\code\OWASP-WebGoat\WebGoat\Content\About.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
About

 
:

  
System

! '
.

' (
Web

( +
.

+ ,
UI

, .
.

. /
Page

/ 3
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ‘
<C:\work\code\OWASP-WebGoat\WebGoat\Content\BasicAuth.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
	BasicAuth

 "
:

# $
System

% +
.

+ ,
Web

, /
.

/ 0
UI

0 2
.

2 3
Page

3 7
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} “
=C:\work\code\OWASP-WebGoat\WebGoat\Content\Challenge1.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 

Challenge1

 #
:

$ %
System

& ,
.

, -
Web

- 0
.

0 1
UI

1 3
.

3 4
Page

4 8
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} “
=C:\work\code\OWASP-WebGoat\WebGoat\Content\Challenge2.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 

Challenge2

 #
:

$ %
System

& ,
.

, -
Web

- 0
.

0 1
UI

1 3
.

3 4
Page

4 8
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} “
=C:\work\code\OWASP-WebGoat\WebGoat\Content\Challenge3.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 

Challenge3

 #
:

$ %
System

& ,
.

, -
Web

- 0
.

0 1
UI

1 3
.

3 4
Page

4 8
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ‘
<C:\work\code\OWASP-WebGoat\WebGoat\Content\ChangePwd.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
	ChangePwd

 "
:

# $
System

% +
.

+ ,
Web

, /
.

/ 0
UI

0 2
.

2 3
Page

3 7
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ¡
DC:\work\code\OWASP-WebGoat\WebGoat\Content\ClientSideStorage.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
ClientSideStorage

 *
:

+ ,
System

- 3
.

3 4
Web

4 7
.

7 8
UI

8 :
.

: ;
Page

; ?
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} Ÿ
CC:\work\code\OWASP-WebGoat\WebGoat\Content\CommandInjection.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
CommandInjection

 )
:

* +
System

, 2
.

2 3
Web

3 6
.

6 7
UI

7 9
.

9 :
Page

: >
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} Ëb
1C:\work\code\OWASP-WebGoat\WebGoat\dbtest.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 
partial 
class 
RebuildDatabase %
:& '
System( .
.. /
Web/ 2
.2 3
UI3 5
.5 6
Page6 :
{ 
	protected 
void 
	Page_Load 
( 
object "
sender# )
,) *
	EventArgs+ 4
e5 6
)6 7
{ 

ConfigFile 

configFile !
=" #
Settings$ ,
., -
CurrentConfigFile- >
;> ?
if 
( 
! 
Page 
. 

IsPostBack 
)  
{  
dropDownDataProvider $
.$ %
Text% )
=* +

configFile, 6
.6 7
Get7 :
(: ;
DbConstants; F
.F G
KEY_DB_TYPEG R
)R S
;S T
txtClientExecutable #
.# $
Text$ (
=) *

configFile+ 5
.5 6
Get6 9
(9 :
DbConstants: E
.E F
KEY_CLIENT_EXECF U
)U V
;V W
txtFilePath 
. 
Text  
=! "

configFile# -
.- .
Get. 1
(1 2
DbConstants2 =
.= >
KEY_FILE_NAME> K
)K L
;L M
	txtServer 
. 
Text 
=  

configFile! +
.+ ,
Get, /
(/ 0
DbConstants0 ;
.; <
KEY_HOST< D
)D E
;E F
txtPort 
. 
Text 
= 

configFile )
.) *
Get* -
(- .
DbConstants. 9
.9 :
KEY_PORT: B
)B C
;C D
txtDatabase 
. 
Text  
=! "

configFile# -
.- .
Get. 1
(1 2
DbConstants2 =
.= >
KEY_DATABASE> J
)J K
;K L
txtUserName 
. 
Text  
=! "

configFile# -
.- .
Get. 1
(1 2
DbConstants2 =
.= >
KEY_UID> E
)E F
;F G
txtPassword 
. 
Text  
=! "

configFile# -
.- .
Get. 1
(1 2
DbConstants2 =
.= >
KEY_PWD> E
)E F
;F G
} 
PanelSuccess!! 
.!! 
Visible!!  
=!!! "
false!!# (
;!!( )

PanelError"" 
."" 
Visible"" 
=""  
false""! &
;""& '
PanelRebuildSuccess$$ 
.$$  
Visible$$  '
=$$( )
false$$* /
;$$/ 0
PanelRebuildFailure%% 
.%%  
Visible%%  '
=%%( )
false%%* /
;%%/ 0
}'' 
	protected)) 
void)) 
btnTest_Click)) 
())  
object))  &
sender))' -
,))- .
	EventArgs))/ 8
e))9 :
))): ;
{** 
	lblOutput++ 
.++ 
Text++ 
=++ 
Settings++ %
.++% &
CurrentDbProvider++& 7
.++7 8
TestConnection++8 F
(++F G
)++G H
?++I J
$str++K S
:++T U
$str++V _
;++_ `
},, 
	protected.. 
void.. &
btnTestConfiguration_Click.. 1
(..1 2
object..2 8
sender..9 ?
,..? @
	EventArgs..A J
e..K L
)..L M
{// 	

ConfigFile00 

configFile00 !
=00" #
Settings00$ ,
.00, -
CurrentConfigFile00- >
;00> ?
UpdateConfigFile33 
(33 

configFile33 '
)33' (
;33( )
Settings55 
.55 
CurrentDbProvider55 &
=55' (
DbProviderFactory55) :
.55: ;
Create55; A
(55A B

configFile55B L
)55L M
;55M N
if77 
(77 
Settings77 
.77 
CurrentDbProvider77 *
.77* +
TestConnection77+ 9
(779 :
)77: ;
)77; <
{88 
labelSuccess99 
.99 
Text99 !
=99" #
$str99$ H
;99H I
PanelSuccess:: 
.:: 
Visible:: $
=::% &
true::' +
;::+ ,
Session;; 
[;; 
$str;; &
];;& '
=;;( )
true;;* .
;;;. /
}<< 
else== 
{>> 

labelError?? 
.?? 
Text?? 
=??  !
$str??" L
;??L M

PanelError@@ 
.@@ 
Visible@@ "
=@@# $
true@@% )
;@@) *
SessionAA 
[AA 
$strAA &
]AA& '
=AA( )
nullAA* .
;AA. /
}BB 
}CC 	
	protectedEE 
voidEE $
btnRebuildDatabase_ClickEE /
(EE/ 0
objectEE0 6
senderEE7 =
,EE= >
	EventArgsEE? H
eEEI J
)EEJ K
{FF 	

ConfigFileGG 

configFileGG !
=GG" #
SettingsGG$ ,
.GG, -
CurrentConfigFileGG- >
;GG> ?
UpdateConfigFileII 
(II 

configFileII '
)II' (
;II( )
SettingsKK 
.KK 
CurrentDbProviderKK &
=KK' (
DbProviderFactoryKK) :
.KK: ;
CreateKK; A
(KKA B

configFileKKB L
)KKL M
;KKM N
SettingsLL 
.LL 
CurrentDbProviderLL &
.LL& '
RecreateGoatDbLL' 5
(LL5 6
)LL6 7
;LL7 8
ifNN 
(NN 
SettingsNN 
.NN 
CurrentDbProviderNN *
.NN* +
TestConnectionNN+ 9
(NN9 :
)NN: ;
)NN; <
{OO 
labelRebuildSuccessPP #
.PP# $
TextPP$ (
=PP) *
$strPP+ I
;PPI J
PanelRebuildSuccessQQ #
.QQ# $
VisibleQQ$ +
=QQ, -
trueQQ. 2
;QQ2 3
SessionRR 
[RR 
$strRR &
]RR& '
=RR( )
trueRR* .
;RR. /
}SS 
elseTT 
{UU 
labelRebuildFailureVV #
.VV# $
TextVV$ (
=VV) *
$strVV+ X
;VVX Y
PanelRebuildFailureWW #
.WW# $
VisibleWW$ +
=WW, -
trueWW. 2
;WW2 3
SessionXX 
[XX 
$strXX &
]XX& '
=XX( )
nullXX* .
;XX. /
}YY 
}ZZ 	
private\\ 
void\\ 
UpdateConfigFile\\ %
(\\% &

ConfigFile\\& 0

configFile\\1 ;
)\\; <
{]] 	
if^^ 
(^^ 
string^^ 
.^^ 
IsNullOrEmpty^^ #
(^^# $
	txtServer^^$ -
.^^- .
Text^^. 2
)^^2 3
)^^3 4

configFile__ 
.__ 
Remove__ !
(__! "
DbConstants__" -
.__- .
KEY_HOST__. 6
)__6 7
;__7 8
else`` 

configFileaa 
.aa 
Setaa 
(aa 
DbConstantsaa *
.aa* +
KEY_HOSTaa+ 3
,aa3 4
	txtServeraa5 >
.aa> ?
Textaa? C
)aaC D
;aaD E
ifcc 
(cc 
stringcc 
.cc 
IsNullOrEmptycc $
(cc$ %
txtFilePathcc% 0
.cc0 1
Textcc1 5
)cc5 6
)cc6 7

configFiledd 
.dd 
Removedd !
(dd! "
DbConstantsdd" -
.dd- .
KEY_FILE_NAMEdd. ;
)dd; <
;dd< =
elseee 

configFileff 
.ff 
Setff 
(ff 
DbConstantsff *
.ff* +
KEY_FILE_NAMEff+ 8
,ff8 9
txtFilePathff: E
.ffE F
TextffF J
)ffJ K
;ffK L
ifhh 
(hh 
stringhh 
.hh 
IsNullOrEmptyhh $
(hh$ % 
dropDownDataProviderhh% 9
.hh9 :
Texthh: >
)hh> ?
)hh? @

configFileii 
.ii 
Removeii !
(ii! "
DbConstantsii" -
.ii- .
KEY_DB_TYPEii. 9
)ii9 :
;ii: ;
elsejj 

configFilekk 
.kk 
Setkk 
(kk 
DbConstantskk *
.kk* +
KEY_DB_TYPEkk+ 6
,kk6 7 
dropDownDataProviderkk8 L
.kkL M
TextkkM Q
)kkQ R
;kkR S
ifmm 
(mm 
stringmm 
.mm 
IsNullOrEmptymm $
(mm$ %
txtPortmm% ,
.mm, -
Textmm- 1
)mm1 2
)mm2 3

configFilenn 
.nn 
Removenn !
(nn! "
DbConstantsnn" -
.nn- .
KEY_PORTnn. 6
)nn6 7
;nn7 8
elseoo 

configFilepp 
.pp 
Setpp 
(pp 
DbConstantspp *
.pp* +
KEY_PORTpp+ 3
,pp3 4
txtPortpp5 <
.pp< =
Textpp= A
)ppA B
;ppB C
ifrr 
(rr 
stringrr 
.rr 
IsNullOrEmptyrr $
(rr$ %
txtClientExecutablerr% 8
.rr8 9
Textrr9 =
)rr= >
)rr> ?

configFiless 
.ss 
Removess !
(ss! "
DbConstantsss" -
.ss- .
KEY_CLIENT_EXECss. =
)ss= >
;ss> ?
elsett 

configFileuu 
.uu 
Setuu 
(uu 
DbConstantsuu *
.uu* +
KEY_CLIENT_EXECuu+ :
,uu: ;
txtClientExecutableuu< O
.uuO P
TextuuP T
)uuT U
;uuU V
ifww 
(ww 
stringww 
.ww 
IsNullOrEmptyww $
(ww$ %
txtDatabaseww% 0
.ww0 1
Textww1 5
)ww5 6
)ww6 7

configFilexx 
.xx 
Removexx !
(xx! "
DbConstantsxx" -
.xx- .
KEY_DATABASExx. :
)xx: ;
;xx; <
elseyy 

configFilezz 
.zz 
Setzz 
(zz 
DbConstantszz *
.zz* +
KEY_DATABASEzz+ 7
,zz7 8
txtDatabasezz9 D
.zzD E
TextzzE I
)zzI J
;zzJ K
if|| 
(|| 
string|| 
.|| 
IsNullOrEmpty|| $
(||$ %
txtUserName||% 0
.||0 1
Text||1 5
)||5 6
)||6 7

configFile}} 
.}} 
Remove}} !
(}}! "
DbConstants}}" -
.}}- .
KEY_UID}}. 5
)}}5 6
;}}6 7
else~~ 

configFile 
. 
Set 
( 
DbConstants *
.* +
KEY_UID+ 2
,2 3
txtUserName4 ?
.? @
Text@ D
)D E
;E F
if
 
(
 
string
 
.
 
IsNullOrEmpty
 $
(
$ %
txtPassword
% 0
.
0 1
Text
1 5
)
5 6
)
6 7

configFile
‚‚ 
.
‚‚ 
Remove
‚‚ !
(
‚‚! "
DbConstants
‚‚" -
.
‚‚- .
KEY_PWD
‚‚. 5
)
‚‚5 6
;
‚‚6 7
else
ƒƒ 

configFile
„„ 
.
„„ 
Set
„„ 
(
„„ 
DbConstants
„„ *
.
„„* +
KEY_PWD
„„+ 2
,
„„2 3
txtPassword
„„4 ?
.
„„? @
Text
„„@ D
)
„„D E
;
„„E F

configFile
†† 
.
†† 
Save
†† 
(
†† 
)
†† 
;
†† 
}
‡‡ 	
}
ˆˆ 
}‰‰ 
;C:\work\code\OWASP-WebGoat\WebGoat\Content\CSRFDemo.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
CSRFDemo

 !
:

" #
System

$ *
.

* +
Web

+ .
.

. /
UI

/ 1
.

1 2
Page

2 6
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ‹
9C:\work\code\OWASP-WebGoat\WebGoat\Content\DomXSS.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
DomXSS

 
:

  !
System

" (
.

( )
Web

) ,
.

, -
UI

- /
.

/ 0
Page

0 4
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ™
@C:\work\code\OWASP-WebGoat\WebGoat\Content\EmbeddedError.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
EmbeddedError

 &
:

' (
System

) /
.

/ 0
Web

0 3
.

3 4
UI

4 6
.

6 7
Page

7 ;
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} Á[
BC:\work\code\OWASP-WebGoat\WebGoat\Content\EncryptVSEncode.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 

partial 
class 
EncryptVSEncode (
:) *
System+ 1
.1 2
Web2 5
.5 6
UI6 8
.8 9
Page9 =
{ 
enum 
WG_Hash 
{ 
Sha1 
= 
$num 
, 
Sha256 
} 
;  
private 
string 
password 
=  !
$str" *
;* +
private 
string 
hardCodedKey #
=$ %
$str& +
;+ ,
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
	protected 
void 
btnGO_Click "
(" #
object# )
sender* 0
,0 1
	EventArgs2 ;
e< =
)= >
{ 	
string   	
secret  
 
=   
	txtString   
.   
Text   !
;  ! "
string!! 	
key!!
 
=!! 
String!! 
.!! 
IsNullOrEmpty!! $
(!!$ %
txtPassword!!% 0
.!!0 1
Text!!1 5
)!!5 6
?!!7 8
hardCodedKey!!9 E
:!!F G
txtPassword!!H S
.!!S T
Text!!T X
;!!X Y
Table##	 
t## 
=## 
new## 
Table## 
(## 
)## 
;## 
t$$	 

.$$
 
Width$$ 
=$$ 
new$$ 
Unit$$ 
($$ 
$str$$ "
)$$" #
;$$# $
t&& 
.&& 
Rows&& 
.&& 
Add&& 
(&& 
MakeRow&& 
(&& 
$str&& .
,&&. /
CustomCryptoEncrypt&&0 C
(&&C D
secret&&D J
)&&J K
)&&K L
)&&L M
;&&M N
t'' 
.'' 
Rows'' 	
.''	 

Add''
 
('' 
MakeRow'' 
('' 
$str'' $
,''$ %
Server''& ,
.'', -
	UrlEncode''- 6
(''6 7
secret''7 =
)''= >
)''> ?
)''? @
;''@ A
t(( 
.(( 
Rows(( 	
.((	 

Add((
 
((( 
MakeRow(( 
((( 
$str(( '
,((' (
Base64(() /
(((/ 0
secret((0 6
)((6 7
)((7 8
)((8 9
;((9 :
t)) 
.)) 
Rows)) 	
.))	 

Add))
 
()) 
MakeRow)) 
()) 
$str)) $
,))$ %
SHA))& )
())) *
secret))* 0
,))0 1
WG_Hash))2 9
.))9 :
Sha1)): >
)))> ?
)))? @
)))@ A
;))A B
t** 
.** 
Rows** 	
.**	 

Add**
 
(** 
MakeRow** 
(** 
$str** &
,**& '
SHA**( +
(**+ ,
secret**, 2
,**2 3
WG_Hash**4 ;
.**; <
Sha256**< B
)**B C
)**C D
)**D E
;**E F
t++ 
.++ 
Rows++ 	
.++	 

Add++
 
(++ 
MakeRow++ 
(++ 
$str++ ,
,++, -
Encypt++. 4
(++4 5
secret++5 ;
,++; <
key++= @
)++@ A
,++A B
Color++C H
.++H I

LightGreen++I S
)++S T
)++T U
;++U V
ContentPlaceHolder--	 
cph-- 
=--  !
(--" #
ContentPlaceHolder--# 5
)--5 6
this--6 :
.--: ;
Master--; A
.--A B
FindControl--B M
(--M N
$str--N f
)--f g
;--g h
cph.. 
... 
Controls.. 
... 
Add.. 
(.. 
new.. 
LiteralControl.. &
(..& '
$str..' -
)..- .
)... /
;../ 0
cph//	 
.// 
Controls// 
.// 
Add// 
(// 
t// 
)// 
;// 
}22 	
private33 
TableRow33 
MakeRow33  
(33  !
string33! '
label33( -
,33- .
string33/ 5
val336 9
)339 :
{44 	
TableRow55	 
row55 
=55 
new55 
TableRow55 $
(55$ %
)55% &
;55& '
	TableCell77 
t177 
=77 
new77 
	TableCell77 
(77  
)77  !
;77! "
t188 
.88 
Text88 

=88 
label88 
;88 
row99 
.99 
Cells99 
.99 
Add99 
(99 
t199 
)99 
;99 
	TableCell;; 
t2;; 
=;; 
new;; 
	TableCell;; 
(;;  
);;  !
;;;! "
t2<< 
.<< 
Text<< 

=<< 
val<< 
;<< 
row== 
.== 
Cells== 
.== 
Add== 
(== 
t2== 
)== 
;== 
return>> 	
row>>
 
;>> 
}?? 	
private@@ 
TableRow@@ 
MakeRow@@  
(@@  !
string@@! '
label@@( -
,@@- .
string@@/ 5
val@@6 9
,@@9 :
Color@@; @
color@@A F
)@@F G
{AA 	
TableRowBB 
rowBB 
=BB 
newBB 
TableRowBB '
(BB' (
)BB( )
;BB) *
rowCC 
.CC 
	BackColorCC 
=CC 
colorCC !
;CC! "
	TableCellEE 
t1EE 
=EE 
newEE 
	TableCellEE (
(EE( )
)EE) *
;EE* +
t1FF 
.FF 
TextFF 
=FF 
labelFF 
;FF 
rowGG 
.GG 
CellsGG 
.GG 
AddGG 
(GG 
t1GG 
)GG 
;GG 
	TableCellII 
t2II 
=II 
newII 
	TableCellII (
(II( )
)II) *
;II* +
t2JJ 
.JJ 
TextJJ 
=JJ 
valJJ 
;JJ 
rowKK 
.KK 
CellsKK 
.KK 
AddKK 
(KK 
t2KK 
)KK 
;KK 
returnLL 
rowLL 
;LL 
}MM 	
privatePP 
stringPP 
Base64PP 
(PP 
stringPP $
sPP% &
)PP& '
{QQ 
byteRR 
[RR 
]RR 
bytesRR 
=RR 
SystemRR 
.RR 
TextRR "
.RR" #
ASCIIEncodingRR# 0
.RR0 1
ASCIIRR1 6
.RR6 7
GetBytesRR7 ?
(RR? @
sRR@ A
)RRA B
;RRB C
returnSS 
SystemSS 
.SS 
ConvertSS 
.SS 
ToBase64StringSS ,
(SS, -
bytesSS- 2
)SS2 3
;SS3 4
}TT 
privateVV 
stringVV 
SHAVV 
(VV 
stringVV 
sVV  
,VV  !
WG_HashVV" )
hashVV* .
)VV. /
{WW 
byteXX 

[XX
 
]XX 
bytesXX 
=XX 
SystemXX 
.XX 
TextXX  
.XX  !
ASCIIEncodingXX! .
.XX. /
ASCIIXX/ 4
.XX4 5
GetBytesXX5 =
(XX= >
sXX> ?
)XX? @
;XX@ A
byteYY 
[YY 
]YY 	
resultYY
 
;YY 
HashAlgorithmZZ 
shaZZ 
;ZZ 
sha[[ 
=[[ 
new[[ 
SHA1Managed[[ !
([[! "
)[[" #
;[[# $
switch\\ 
(\\ 
hash\\ 
)\\ 
{\\ 
case]] 
WG_Hash]]	 
.]] 
Sha1]] 
:]] 
sha^^ 
=^^	 

new^^ 
SHA1Managed^^ 
(^^ 
)^^ 
;^^ 
break__ 
;__ 
case`` 
WG_Hash``	 
.`` 
Sha256`` 
:`` 
shaaa 
=aa	 

newaa 
SHA256Managedaa 
(aa 
)aa 
;aa 
breakbb 

;bb
 
}cc 
resultdd 	
=dd
 
shadd 
.dd 
ComputeHashdd 
(dd 
bytesdd !
)dd! "
;dd" #
returnee 	
Systemee
 
.ee 
Convertee 
.ee 
ToBase64Stringee '
(ee' (
resultee( .
)ee. /
;ee/ 0
}ff 
privatehh 
stringhh 
Encypthh 
(hh 
stringhh $
shh% &
,hh& '
stringhh( .
keyhh/ 2
)hh2 3
{ii 	
stringjj 
resultjj 
=jj 
OWASPjj !
.jj! "
WebGoatjj" )
.jj) *
NETjj* -
.jj- .
App_Codejj. 6
.jj6 7
Encoderjj7 >
.jj> ?
EncryptStringAESjj? O
(jjO P
sjjP Q
,jjQ R
keyjjS V
)jjV W
;jjW X
returnkk 
resultkk 
;kk 
}ll 	
privatenn 
stringnn 
CustomCryptoEncryptnn *
(nn* +
Stringnn+ 1
snn2 3
)nn3 4
{oo 	
bytepp 
[pp 
]pp 
bytespp 
=pp 
Encodingpp #
.pp# $
UTF8pp$ (
.pp( )
GetBytespp) 1
(pp1 2
spp2 3
)pp3 4
;pp4 5
forrr 
(rr 
intrr 
irr 
=rr 
$numrr 
;rr 
irr 
<rr 
bytesrr  %
.rr% &
Lengthrr& ,
;rr, -
irr. /
++rr/ 1
)rr1 2
{ss 
iftt 
(tt 
itt 
%tt 
$numtt 
==tt 
$numtt 
)tt 
{uu 
bytesvv 
[vv 
ivv 
]vv 
=vv 
(vv  
bytevv  $
)vv$ %
(vv& '
bytesvv' ,
[vv, -
ivv- .
]vv. /
|vv0 1
$numvv2 3
)vv3 4
;vv4 5
}ww 
elsexx 
{yy 
byteszz 
[zz 
izz 
]zz 
=zz 
(zz  
bytezz  $
)zz$ %
(zz& '
byteszz' ,
[zz, -
izz- .
]zz. /
&zz0 1
$numzz2 3
)zz3 4
;zz4 5
}{{ 
}}} 
return 
Encoding 
. 
UTF8  
.  !
	GetString! *
(* +
bytes+ 0
)0 1
;1 2
}
€€ 	
}
 
}‚‚ ‰
8C:\work\code\OWASP-WebGoat\WebGoat\Content\Error.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
Error

 
:

  
System

! '
.

' (
Web

( +
.

+ ,
UI

, .
.

. /
Page

/ 3
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} À
?C:\work\code\OWASP-WebGoat\WebGoat\Content\ExploitDebug.aspx.cs
	namespace		 	
OWASP		
 
.		 
WebGoat		 
.		 
NET		 
{

 
public 

partial 
class 
ExploitDebug %
:& '
System( .
.. /
Web/ 2
.2 3
UI3 5
.5 6
Page6 :
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
	protected 
void 
btnGo_Click "
(" #
object# )
sender* 0
,0 1
	EventArgs2 ;
e< =
)= >
{ 	
StringBuilder 

strBuilder $
=% &
new' *
StringBuilder+ 8
(8 9
)9 :
;: ;

strBuilder 
. 
AppendFormat #
(# $
$str$ 6
,6 7
Environment8 C
.C D
CurrentDirectoryD T
)T U
;U V

strBuilder 
. 

AppendLine !
(! "
)" #
;# $

strBuilder 
. 
AppendFormat #
(# $
$str$ 3
,3 4
Environment5 @
.@ A
UserNameA I
)I J
;J K

strBuilder 
. 

AppendLine !
(! "
)" #
;# $

strBuilder 
. 
AppendFormat #
(# $
$str$ 7
,7 8
Environment9 D
.D E
MachineNameE P
)P Q
;Q R

strBuilder 
. 

AppendLine !
(! "
)" #
;# $

strBuilder 
. 
AppendFormat #
(# $
$str$ 5
,5 6
Environment7 B
.B C
	OSVersionC L
)L M
;M N

strBuilder 
. 

AppendLine !
(! "
)" #
;# $
throw!! 
new!! 
	Exception!! 
(!!  

strBuilder!!  *
.!!* +
ToString!!+ 3
(!!3 4
)!!4 5
)!!5 6
;!!6 7
}"" 	
}## 
}$$ ›
AC:\work\code\OWASP-WebGoat\WebGoat\Content\FlashScripting.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
FlashScripting

 '
:

( )
System

* 0
.

0 1
Web

1 4
.

4 5
UI

5 7
.

7 8
Page

8 <
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ›
AC:\work\code\OWASP-WebGoat\WebGoat\Content\ForcedBrowsing.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
ForcedBrowsing

 '
:

( )
System

* 0
.

0 1
Web

1 4
.

4 5
UI

5 7
.

7 8
Page

8 <
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ™
@C:\work\code\OWASP-WebGoat\WebGoat\Content\FormBasedAuth.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
FormBasedAuth

 &
:

' (
System

) /
.

/ 0
Web

0 3
.

3 4
UI

4 6
.

6 7
Page

7 ;
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ˆ
9C:\work\code\OWASP-WebGoat\WebGoat\Content\Global.asax.cs
	namespace 	

DotNetGoat
 
{ 
public		 
class		 
Global		 
:		 
System		 
.		 
Web		 !
.		! "
HttpApplication		" 1
{

 
	protected 
virtual 
void 
Application_Start *
(+ ,
Object, 2
sender3 9
,9 :
	EventArgs; D
eE F
)F G
{ 
} 
	protected 
virtual 
void 
Session_Start &
(' (
Object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 
} 
	protected 
virtual 
void $
Application_BeginRequest 1
(2 3
Object3 9
sender: @
,@ A
	EventArgsB K
eL M
)M N
{ 
} 
	protected 
virtual 
void "
Application_EndRequest /
(0 1
Object1 7
sender8 >
,> ?
	EventArgs@ I
eJ K
)K L
{ 
} 
	protected 
virtual 
void +
Application_AuthenticateRequest 8
(9 :
Object: @
senderA G
,G H
	EventArgsI R
eS T
)T U
{ 
} 
	protected   
virtual   
void   
Application_Error   *
(  + ,
Object  , 2
sender  3 9
,  9 :
	EventArgs  ; D
e  E F
)  F G
{!! 
}"" 
	protected$$ 
virtual$$ 
void$$ 
Session_End$$ $
($$% &
Object$$& ,
sender$$- 3
,$$3 4
	EventArgs$$5 >
e$$? @
)$$@ A
{%% 
}&& 
	protected(( 
virtual(( 
void(( 
Application_End(( (
((() *
Object((* 0
sender((1 7
,((7 8
	EventArgs((9 B
e((C D
)((D E
{)) 
}** 
}++ 
},, •
>C:\work\code\OWASP-WebGoat\WebGoat\Content\HiddenField.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
HiddenField

 $
:

% &
System

' -
.

- .
Web

. 1
.

1 2
UI

2 4
.

4 5
Page

5 9
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ¡
DC:\work\code\OWASP-WebGoat\WebGoat\Content\InjectionExercise.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
InjectionExercise

 *
:

+ ,
System

- 3
.

3 4
Web

4 7
.

7 8
UI

8 :
.

: ;
Page

; ?
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} 
BC:\work\code\OWASP-WebGoat\WebGoat\Content\jQueryInjection.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
jQueryInjection

 (
:

) *
System

+ 1
.

1 2
Web

2 5
.

5 6
UI

6 8
.

8 9
Page

9 =
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} •
>C:\work\code\OWASP-WebGoat\WebGoat\Content\XSSExercise.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
XSSExercise

 $
:

% &
System

' -
.

- .
Web

. 1
.

1 2
UI

2 4
.

4 5
Page

5 9
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ‡
7C:\work\code\OWASP-WebGoat\WebGoat\Content\WSDL.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
WSDL

 
:

 
System

  &
.

& '
Web

' *
.

* +
UI

+ -
.

- .
Page

. 2
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ‘
<C:\work\code\OWASP-WebGoat\WebGoat\Content\WSAttacks.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
	WSAttacks

 "
:

# $
System

% +
.

+ ,
Web

, /
.

/ 0
UI

0 2
.

2 3
Page

3 7
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ™
@C:\work\code\OWASP-WebGoat\WebGoat\Content\JSONInjection.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
JSONInjection

 &
:

' (
System

) /
.

/ 0
Web

0 3
.

3 4
UI

4 6
.

6 7
Page

7 ;
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} —
?C:\work\code\OWASP-WebGoat\WebGoat\Content\LogInjection.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
LogInjection

 %
:

& '
System

( .
.

. /
Web

/ 2
.

2 3
UI

3 5
.

5 6
Page

6 :
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} —
?C:\work\code\OWASP-WebGoat\WebGoat\Content\LogoutIssues.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
LogoutIssues

 %
:

& '
System

( .
.

. /
Web

/ 2
.

2 3
UI

3 5
.

5 6
Page

6 :
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ‡
7C:\work\code\OWASP-WebGoat\WebGoat\Content\Worm.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
Worm

 
:

 
System

  &
.

& '
Web

' *
.

* +
UI

+ -
.

- .
Page

. 2
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ‘
<C:\work\code\OWASP-WebGoat\WebGoat\Content\Viewstate.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
	Viewstate

 "
:

# $
System

% +
.

+ ,
Web

, /
.

/ 0
UI

0 2
.

2 3
Page

3 7
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} Ü'
<C:\work\code\OWASP-WebGoat\WebGoat\Content\StoredXSS.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 
partial 
class 
	StoredXSS 
:  !
System" (
.( )
Web) ,
., -
UI- /
./ 0
Page0 4
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load 
( 
object "
sender# )
,) *
	EventArgs+ 4
e5 6
)6 7
{ 	

lblMessage 
. 
Visible 
=  
false! &
;& '
txtEmail 
. 
Enabled 
= 
true #
;# $
if 
( 
! 
Page 
. 

IsPostBack  
)  !
LoadComments 
( 
) 
; 
} 	
	protected 
void 
btnSave_Click $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 
try 
{ 
string 
error_message $
=% &
du' )
.) *

AddComment* 4
(4 5
$str5 ?
,? @
txtEmailA I
.I J
TextJ N
,N O

txtCommentP Z
.Z [
Text[ _
)_ `
;` a

txtComment 
. 
Text 
=  !
error_message" /
;/ 0

lblMessage   
.   
Visible   "
=  # $
true  % )
;  ) *
LoadComments!! 
(!! 
)!! 
;!! 
}"" 
catch## 
(## 
	Exception## 
ex## 
)##  
{$$ 

lblMessage%% 
.%% 
Text%% 
=%%  !
ex%%" $
.%%$ %
Message%%% ,
;%%, -

lblMessage&& 
.&& 
Visible&& "
=&&# $
true&&% )
;&&) *
}'' 
}(( 
void** 
LoadComments** 
(** 
)** 
{++ 	
DataSet,, 
ds,, 
=,, 
du,, 
.,, 
GetComments,, '
(,,' (
$str,,( 2
),,2 3
;,,3 4
string-- 
comments-- 
=-- 
string-- $
.--$ %
Empty--% *
;--* +
foreach.. 
(.. 
DataRow.. 
row..  
in..! #
ds..$ &
...& '
Tables..' -
[..- .
$num... /
]../ 0
...0 1
Rows..1 5
)..5 6
{// 
comments00 
+=00 
$str00 5
+006 7
row008 ;
[00; <
$str00< C
]00C D
+00E F
$str	00G ¡
;
00¡ ¢
comments11 
+=11 
$str11 <
+11= >
row11? B
[11B C
$str11C L
]11L M
+11N O
$str11P \
;11\ ]
}33 
lblComments44 
.44 
Text44 
=44 
comments44 '
;44' (
}55 	
void77 
FixedLoadComments77 
(77 
)77  
{88 	
DataSet99 
ds99 
=99 
du99 
.99 
GetComments99 '
(99' (
$str99( 2
)992 3
;993 4
string:: 
comments:: 
=:: 
string:: $
.::$ %
Empty::% *
;::* +
foreach;; 
(;; 
DataRow;; 
row;;  
in;;! #
ds;;$ &
.;;& '
Tables;;' -
[;;- .
$num;;. /
];;/ 0
.;;0 1
Rows;;1 5
);;5 6
{<< 
comments== 
+=== 
$str== 5
+==6 7
Server==8 >
.==> ?

HtmlEncode==? I
(==I J
row==J M
[==M N
$str==N U
]==U V
.==V W
ToString==W _
(==_ `
)==` a
)==a b
+==c d
$str	==e ¿
;
==¿ À
comments>> 
+=>> 
$str>> <
+>>= >
Server>>? E
.>>E F

HtmlEncode>>F P
(>>P Q
row>>Q T
[>>T U
$str>>U ^
]>>^ _
.>>_ `
ToString>>` h
(>>h i
)>>i j
)>>j k
+>>l m
$str>>n z
;>>z {
}@@ 
lblCommentsAA 
.AA 
TextAA 
=AA 
commentsAA '
;AA' (
}BB 	
}CC 
}DD ‰
HC:\work\code\OWASP-WebGoat\WebGoat\Content\SQLInjectionDiscovery.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 
partial 
class !
SQLInjectionDiscovery +
:, -
System. 4
.4 5
Web5 8
.8 9
UI9 ;
.; <
Page< @
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load 
( 
object "
sender# )
,) *
	EventArgs+ 4
e5 6
)6 7
{ 
} 
	protected 
void 
btnFind_Click 
(  
object  &
sender' -
,- .
	EventArgs/ 8
e9 :
): ;
{ 
try 
{ 
string 
name 
= 
txtID #
.# $
Text$ (
.( )
	Substring) 2
(2 3
$num3 4
,4 5
$num6 7
)7 8
;8 9
string 
output 
= 
du  "
." #$
GetEmailByCustomerNumber# ;
(; <
name< @
)@ A
;A B
	lblOutput 
. 
Text 
=  
String! '
.' (
IsNullOrEmpty( 5
(5 6
output6 <
)< =
?> ?
$str@ `
:a b
outputc i
;i j
} 
catch   
(   
	Exception   
ex   
)    
{!! 
	lblOutput"" 
."" 
Text"" 
=""  
ex""! #
.""# $
Message""$ +
;""+ ,
}## 
}$$ 
}%% 
}&& à
?C:\work\code\OWASP-WebGoat\WebGoat\Content\SQLInjection.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 
partial 
class 
SQLInjection "
:# $
System% +
.+ ,
Web, /
./ 0
UI0 2
.2 3
Page3 7
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load 
( 
object "
sender# )
,) *
	EventArgs+ 4
e5 6
)6 7
{ 
} 
	protected 
void 
btnFind_Click 
( 
object %
sender& ,
,, -
	EventArgs. 7
e8 9
)9 :
{ 	
string 
name 
= 
txtName !
.! "
Text" &
;& '
DataSet 
ds 
= 
du 
. 
GetEmailByName *
(* +
name+ /
)/ 0
;0 1
if 
( 
ds 
!= 
null 
) 
{ 
grdEmail 
. 

DataSource #
=$ %
ds& (
.( )
Tables) /
[/ 0
$num0 1
]1 2
;2 3
grdEmail 
. 
DataBind !
(! "
)" #
;# $
}   
}!! 
}"" 
}## 
BC:\work\code\OWASP-WebGoat\WebGoat\Content\SessionExercise.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
SessionExercise

 (
:

) *
System

+ 1
.

1 2
Web

2 5
.

5 6
UI

6 8
.

8 9
Page

9 =
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} 
BC:\work\code\OWASP-WebGoat\WebGoat\Content\SessionFixation.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
SessionFixation

 (
:

) *
System

+ 1
.

1 2
Web

2 5
.

5 6
UI

6 8
.

8 9
Page

9 =
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} “
=C:\work\code\OWASP-WebGoat\WebGoat\Content\SamplePage.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 

SamplePage

 #
:

$ %
System

& ,
.

, -
Web

- 0
.

0 1
UI

1 3
.

3 4
Page

4 8
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ´
?C:\work\code\OWASP-WebGoat\WebGoat\Content\ReflectedXSS.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 
partial 
class 
ReflectedXSS "
:# $
System% +
.+ ,
Web, /
./ 0
UI0 2
.2 3
Page3 7
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
if 
( 
Request 
[ 
$str 
] 
!=  "
null# '
)' (
LoadCity 
( 
Request  
[  !
$str! '
]' (
)( )
;) *
} 	
void 
LoadCity 
( 
String 
city 
) 
{ 
DataSet 
ds 
= 
du 
. 
	GetOffice %
(% &
city& *
)* +
;+ ,
	lblOutput 
. 
Text 
= 
$str <
+= >
city? C
+D E
$strF O
;O P
dtlView 
. 

DataSource 
=  
ds! #
.# $
Tables$ *
[* +
$num+ ,
], -
;- .
dtlView 
. 
DataBind 
( 
) 
; 
} 
void 
FixedLoadCity 
( 
String "
city# '
)' (
{   	
DataSet!! 
ds!! 
=!! 
du!! 
.!! 
	GetOffice!! %
(!!% &
city!!& *
)!!* +
;!!+ ,
	lblOutput"" 
."" 
Text"" 
="" 
$str"" <
+""= >
Server""? E
.""E F

HtmlEncode""F P
(""P Q
city""Q U
)""U V
+""W X
$str""Y b
;""b c
dtlView## 
.## 

DataSource## 
=##  
ds##! #
.### $
Tables##$ *
[##* +
$num##+ ,
]##, -
;##- .
dtlView$$ 
.$$ 
DataBind$$ 
($$ 
)$$ 
;$$ 
}%% 	
}&& 
}'' ›
AC:\work\code\OWASP-WebGoat\WebGoat\Content\ParamTampering.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
ParamTampering

 '
:

( )
System

* 0
.

0 1
Web

1 4
.

4 5
UI

5 7
.

7 8
Page

8 <
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ¡
DC:\work\code\OWASP-WebGoat\WebGoat\Content\ResponseSplitting.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
ResponseSplitting

 *
:

+ ,
System

- 3
.

3 4
Web

4 7
.

7 8
UI

8 :
.

: ;
Page

; ?
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} Ü
2C:\work\code\OWASP-WebGoat\WebGoat\Default.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public		 
partial		 
class		 
Default		 
:		 
System		  &
.		& '
Web		' *
.		* +
UI		+ -
.		- .
Page		. 2
{

 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
ButtonProceed_Click *
(* +
object+ 1
sender2 8
,8 9
	EventArgs: C
eD E
)E F
{ 	
Response 
. 
Redirect 
( 
$str 4
)4 5
;5 6
} 	
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
if 
( 
du 
. 
TestConnection !
(! "
)" #
)# $
{ 
	lblOutput 
. 
Text 
=  
string! '
.' (
Format( .
(. /
$str/ e
+f g
$str/ 
,	 €
du
 ƒ
.
ƒ „
Name
„ ˆ
)
ˆ ‰
;
‰ Š
Session 
[ 
$str &
]& '
=( )
true* .
;. /

HttpCookie 
cookie !
=" #
new$ '

HttpCookie( 2
(2 3
$str3 ;
,; <
Encoder= D
.D E
EncodeE K
(K L
ServerL R
.R S
MachineNameS ^
)^ _
)_ `
;` a
Response 
. 
Cookies  
.  !
Add! $
($ %
cookie% +
)+ ,
;, -
} 
else 
{   
	lblOutput!! 
.!! 
Text!! 
=!!  
$str!!! }
;!!} ~
}"" 
	ViewState%% 
[%% 
$str%% 
]%%  
=%%! "
Session%%# *
.%%* +
	SessionID%%+ 4
;%%4 5
}&& 	
}'' 
}(( Ê	
4C:\work\code\OWASP-WebGoat\WebGoat\LoginPage.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 

partial 
class 
	LoginPage "
:# $
System% +
.+ ,
Web, /
./ 0
UI0 2
.2 3
Page3 7
{ 
	protected 
void 
	Page_Load 
( 
object !
sender" (
,( )
	EventArgs* 3
e4 5
)5 6
{ 
} 
	protected 
void 
ButtonLogOn_Click %
(% &
object& ,
sender- 3
,3 4
	EventArgs5 >
e? @
)@ A
{ 
Response 
. 
Redirect 
( 
$str @
)@ A
;A B
} 
	protected   
void   "
ButtonAdminLogOn_Click   *
(  * +
object  + 1
sender  2 8
,  8 9
	EventArgs  : C
e  D E
)  E F
{!! 
}## 
}$$ 
}%% º
9C:\work\code\OWASP-WebGoat\WebGoat\ForgotPassword.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 
partial 
class 
ForgotPassword $
:% &
System' -
.- .
Web. 1
.1 2
UI2 4
.4 5
Page5 9
{ 
}

 
} º
9C:\work\code\OWASP-WebGoat\WebGoat\ChangePassword.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 
partial 
class 
ChangePassword $
:% &
System' -
.- .
Web. 1
.1 2
UI2 4
.4 5
Page5 9
{ 
}		 
}

 ëN
CC:\work\code\OWASP-WebGoat\WebGoat\Content\PathManipulation.aspx.cs
	namespace		 	
OWASP		
 
.		 
WebGoat		 
.		 
NET		 
{

 
public 

partial 
class 
PathManipulation )
:* +
System, 2
.2 3
Web3 6
.6 7
UI7 9
.9 :
Page: >
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
DirectoryInfo 
di 
= 
new 
DirectoryInfo (
(( )
Server) /
./ 0
MapPath0 7
(7 8
$str8 E
)E F
)F G
;G H
int
 
i 
= 
$num 
; 
foreach
 
( 
FileInfo 
fi 
in  
di! #
.# $
GetFiles$ ,
(, -
)- .
). /
{
 
	HyperLink 
HL 
= 
new  
	HyperLink! *
(* +
)+ ,
;, -
HL 
. 
ID 
= 
$str !
+" #
i$ %
++% '
;' (
HL 
. 
Text 
= 
fi 
. 
Name 
;  
HL 
. 
NavigateUrl 
= 
Request &
.& '
FilePath' /
+0 1
$str2 >
+> ?
fi? A
.A B
NameB F
;F G
ContentPlaceHolder  
cph! $
=% &
(' (
ContentPlaceHolder( :
): ;
this; ?
.? @
Master@ F
.F G
FindControlG R
(R S
$strS k
)k l
;l m
cph 
. 
Controls 
. 
Add 
( 
HL !
)! "
;" #
cph 
. 
Controls 
. 
Add 
( 
new "
LiteralControl# 1
(1 2
$str2 9
)9 :
): ;
;; <
}
 
string!!
 
filename!! 
=!! 
Request!! #
.!!# $
QueryString!!$ /
[!!/ 0
$str!!0 :
]!!: ;
;!!; <
if""
 
("" 
filename"" 
!="" 
null"" 
)"" 
{##
 
try$$ 
{%% 
ResponseFile&& $
(&&$ %
Request&&% ,
,&&, -
Response&&. 6
,&&6 7
filename&&8 @
,&&@ A
MapPath&&B I
(&&I J
$str&&J X
+&&Y Z
filename&&[ c
)&&c d
,&&d e
$num&&f i
)&&i j
;&&j k
}'' 
catch(( 
((( 
	Exception(( $
ex((% '
)((' (
{)) 
Console** 
.**  
	WriteLine**  )
(**) *
ex*** ,
.**, -
Message**- 4
)**4 5
;**5 6
	lblStatus++ !
.++! "
Text++" &
=++' (
$str++) ;
+++< =
filename++> F
;++F G
},, 
}-- 
}// 	
public11 
static11 
bool11 
ResponseFile11 '
(11' (
HttpRequest11( 3
_Request114 <
,11< =
HttpResponse11> J
	_Response11K T
,11T U
string11V \
	_fileName11] f
,11f g
string11h n
	_fullPath11o x
,11x y
long11z ~
_speed	11 …
)
11… †
{22 
try33	 
{44	 


FileStream55 
myFile55 
=55  
new55! $

FileStream55% /
(55/ 0
	_fullPath550 9
,559 :
FileMode55; C
.55C D
Open55D H
,55H I

FileAccess55J T
.55T U
Read55U Y
,55Y Z
	FileShare55[ d
.55d e
	ReadWrite55e n
)55n o
;55o p
BinaryReader66 
br66 
=66 
new66 "
BinaryReader66# /
(66/ 0
myFile660 6
)666 7
;667 8
try77 
{88 
	_Response:: 
.:: 
	AddHeader:: $
(::$ %
$str::% 4
,::4 5
$str::6 =
)::= >
;::> ?
	_Response;; 
.;; 
Buffer;; !
=;;" #
false;;$ )
;;;) *
long<< 

fileLength<<  
=<<! "
myFile<<# )
.<<) *
Length<<* 0
;<<0 1
long== 

startBytes==  
===! "
$num==# $
;==$ %
int?? 
pack?? 
=?? 
$num?? !
;??! "
if@@ 
(@@ 
_Request@@ 
.@@ 
Headers@@ %
[@@% &
$str@@& -
]@@- .
!=@@/ 1
null@@2 6
)@@6 7
{AA 
	_ResponseBB 
.BB 

StatusCodeBB )
=BB* +
$numBB, /
;BB/ 0
stringCC 
[CC 
]CC 
rangeCC #
=CC$ %
_RequestCC& .
.CC. /
HeadersCC/ 6
[CC6 7
$strCC7 >
]CC> ?
.CC? @
SplitCC@ E
(CCE F
newCCF I
charCCJ N
[CCN O
]CCO P
{CCQ R
$charCCS V
,CCV W
$charCCX [
}CC\ ]
)CC] ^
;CC^ _

startBytesDD 
=DD  !
ConvertDD" )
.DD) *
ToInt64DD* 1
(DD1 2
rangeDD2 7
[DD7 8
$numDD8 9
]DD9 :
)DD: ;
;DD; <
}EE 
	_ResponseFF 
.FF 
	AddHeaderFF $
(FF$ %
$strFF% 5
,FF5 6
(FF7 8

fileLengthFF8 B
-FFC D

startBytesFFE O
)FFO P
.FFP Q
ToStringFFQ Y
(FFY Z
)FFZ [
)FF[ \
;FF\ ]
ifHH 
(HH 

startBytesHH 
!=HH  "
$numHH# $
)HH$ %
{II 
	_ResponseJJ 
.JJ 
	AddHeaderJJ (
(JJ( )
$strJJ) 8
,JJ8 9
stringJJ: @
.JJ@ A
FormatJJA G
(JJG H
$strJJH \
,JJ\ ]

startBytesJJ^ h
,JJh i

fileLengthJJj t
-JJu v
$numJJw x
,JJx y

fileLength	JJz „
)
JJ„ …
)
JJ… †
;
JJ† ‡
}KK 
	_ResponseMM 
.MM 
	AddHeaderMM $
(MM$ %
$strMM% 1
,MM1 2
$strMM3 ?
)MM? @
;MM@ A
	_ResponseNN 
.NN 
ContentTypeNN &
=NN' (
$strNN) C
;NNC D
	_ResponseOO 
.OO 
	AddHeaderOO $
(OO$ %
$strOO% :
,OO: ;
$strOO< R
+OOS T
HttpUtilityOOU `
.OO` a
	UrlEncodeOOa j
(OOj k
	_fileNameOOk t
,OOt u
SystemOOv |
.OO| }
Text	OO} 
.
OO ‚
Encoding
OO‚ Š
.
OOŠ ‹
UTF8
OO‹ 
)
OO 
)
OO ‘
;
OO‘ ’
brQQ 
.QQ 

BaseStreamQQ 
.QQ 
SeekQQ #
(QQ# $

startBytesQQ$ .
,QQ. /

SeekOriginQQ0 :
.QQ: ;
BeginQQ; @
)QQ@ A
;QQA B
intRR 
maxCountRR 
=RR 
(RR  !
intRR! $
)RR$ %
MathRR% )
.RR) *
FloorRR* /
(RR/ 0
(RR0 1
doubleRR1 7
)RR7 8
(RR8 9
(RR9 :

fileLengthRR: D
-RRE F

startBytesRRG Q
)RRQ R
/RRS T
packRRU Y
)RRY Z
)RRZ [
+RR\ ]
$numRR^ _
;RR_ `
forTT 
(TT 
intTT 
iTT 
=TT 
$numTT 
;TT  
iTT! "
<TT# $
maxCountTT% -
;TT- .
iTT/ 0
++TT0 2
)TT2 3
{UU 
ifVV 
(VV 
	_ResponseVV "
.VV" #
IsClientConnectedVV# 4
)VV4 5
{WW 
	_ResponseXX "
.XX" #
BinaryWriteXX# .
(XX. /
brXX/ 1
.XX1 2
	ReadBytesXX2 ;
(XX; <
packXX< @
)XX@ A
)XXA B
;XXB C
}YY 
elseZZ 
{[[ 
i\\ 
=\\ 
maxCount\\ %
;\\% &
}]] 
}^^ 
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 
Consolebb 
.bb 
	WriteLinebb 
(bb  
exbb  "
.bb" #
Messagebb# *
)bb* +
;bb+ ,
returncc 
falsecc 
;cc 
}dd 
finallyee 
{ff 
brgg 
.gg 
Closegg 
(gg 
)gg 
;gg 
myFilehh 
.hh 
Closehh 
(hh 
)hh 
;hh  
}ii 
}jj	 

catchkk	 
(kk 
	Exceptionkk 
exkk 
)kk 
{ll	 

Consolemm
 
.mm 
	WriteLinemm 
(mm 
exmm 
.mm 
Messagemm &
)mm& '
;mm' (
returnnn 
falsenn 
;nn 
}oo	 

returnpp	 
truepp 
;pp 
}qq 
}ss 
}tt ™
@C:\work\code\OWASP-WebGoat\WebGoat\Content\PwdComplexity.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
PwdComplexity

 &
:

' (
System

) /
.

/ 0
Web

0 3
.

3 4
UI

4 6
.

6 7
Page

7 ;
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ø 
5C:\work\code\OWASP-WebGoat\WebGoat\AddNewUser.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 
partial 
class 

AddNewUser  
:! "
System# )
.) *
Web* -
.- .
UI. 0
.0 1
Page1 5
{ 
const 
string 
passwordQuestion 
=  !
$str" ?
;? @
	protected 
void 
	Page_Load 
( 
object $
sender% +
,+ ,
	EventArgs- 6
e7 8
)8 9
{ 
if	 
( 
! 
Page 
. 

IsPostBack 
) 
SecurityQuestion 
. 
Text "
=# $
passwordQuestion% 5
;5 6
} 
	protected 
void %
CreateAccountButton_Click -
(- .
object. 4
sender5 ;
,; <
	EventArgs= F
eG H
)H I
{ "
MembershipCreateStatus	 
createStatus  ,
;, -
MembershipUser	 
newUser 
=  !

Membership 
. 

CreateUser #
(# $
Username$ ,
., -
Text- 1
,1 2
Password3 ;
.; <
Text< @
,@ A
Email$ )
.) *
Text* .
,. /
passwordQuestion0 @
,@ A
SecurityAnswer  $ 2
.  2 3
Text  3 7
,  7 8
true  9 =
,  = >
out!!$ '
createStatus!!( 4
)!!4 5
;!!5 6
if## 
(## 
newUser## 
==## 
null## 
)## 
Console$$ 
.$$ 
	WriteLine$$ 
($$ 
$str$$ )
)$$) *
;$$* +
switch&&	 
(&& 
createStatus&& 
)&& 
{''	 

case(( "
MembershipCreateStatus(( (
.((( )
Success(() 0
:((0 1 
CreateAccountResults)) %
.))% &
Text))& *
=))+ ,
$str))- Y
;))Y Z
break** 
;** 
case,, "
MembershipCreateStatus,, (
.,,( )
DuplicateUserName,,) :
:,,: ; 
CreateAccountResults-- %
.--% &
Text--& *
=--+ ,
$str--- ^
;--^ _
break.. 
;.. 
case00 "
MembershipCreateStatus00 (
.00( )
DuplicateEmail00) 7
:007 8 
CreateAccountResults11 %
.11% &
Text11& *
=11+ ,
$str11- c
;11c d
break22 
;22 
case44 "
MembershipCreateStatus44 (
.44( )
InvalidEmail44) 5
:445 6 
CreateAccountResults55 %
.55% &
Text55& *
=55+ ,
$str55- [
;55[ \
break66 
;66 
case88 "
MembershipCreateStatus88 (
.88( )
InvalidAnswer88) 6
:886 7 
CreateAccountResults99 %
.99% &
Text99& *
=99+ ,
$str99- Q
;99Q R
break:: 
;:: 
case<< "
MembershipCreateStatus<< (
.<<( )
InvalidPassword<<) 8
:<<8 9 
CreateAccountResults== %
.==% &
Text==& *
===+ ,
$str	==- §
;
==§ ¨
break>> 
;>> 
default@@ 
:@@  
CreateAccountResultsAA %
.AA% &
TextAA& *
=AA+ ,
$strAA- l
;AAl m
breakBB 
;BB 
}CC	 

}DD 
	protectedFF 
voidFF %
RegisterUser_CreatingUserFF -
(FF- .
objectFF. 4
senderFF5 ;
,FF; < 
LoginCancelEventArgsFF= Q
eFFR S
)FFS T
{GG 
}aa 
}bb 
}cc Œ
DC:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\Autocomplete.ashx.cs
	namespace		 	
OWASP		
 
.		 
WebGoat		 
.		 
NET		 
.		 
WebGoatCoins		 (
{

 
public 

class 
Autocomplete 
: 
IHttpHandler  ,
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
public 
void 
ProcessRequest "
(" #
HttpContext# .
context/ 6
)6 7
{ 	
string 
query 
= 
context "
." #
Request# *
[* +
$str+ 2
]2 3
;3 4
DataSet 
ds 
= 
du 
. 
GetCustomerEmails -
(- .
query. 3
)3 4
;4 5
string 
json 
= 
Encoder !
.! "%
ToJSONSAutocompleteString" ;
(; <
query< A
,A B
dsC E
.E F
TablesF L
[L M
$numM N
]N O
)O P
;P Q
if 
( 
json 
!= 
null 
&& 
json  $
.$ %
Length% +
>, -
$num. /
)/ 0
{ 
context   
.   
Response    
.    !
ContentType  ! ,
=  - .
$str  / ;
;  ; <
context!! 
.!! 
Response!!  
.!!  !
Write!!! &
(!!& '
json!!' +
)!!+ ,
;!!, -
}"" 
else## 
{$$ 
context%% 
.%% 
Response%%  
.%%  !
ContentType%%! ,
=%%- .
$str%%/ ;
;%%; <
context&& 
.&& 
Response&&  
.&&  !
Write&&! &
(&&& '
$str&&' )
)&&) *
;&&* +
}(( 
})) 	
public++ 
bool++ 

IsReusable++ 
{,, 	
get-- 
{.. 
return// 
false// 
;// 
}00 
}11 	
}22 
}33 ®
?C:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\Catalog.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
WebGoatCoins (
{ 
public 

partial 
class 
Catalog  
:! "
System# )
.) *
Web* -
.- .
UI. 0
.0 1
Page1 5
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
DataSet 
ds 
= 
du 
. $
GetProductsAndCategories 4
(4 5
)5 6
;6 7
foreach 
( 
DataRow 
catRow #
in$ &
ds' )
.) *
Tables* 0
[0 1
$str1 =
]= >
.> ?
Rows? C
)C D
{ 
	lblOutput 
. 
Text 
+= !
$str" W
+X Y
catRowZ `
[` a
$stra j
]j k
.k l
ToStringl t
(t u
)u v
+w x
$str	y ‹
;
‹ Œ
foreach 
( 
DataRow  
prodRow! (
in) +
catRow, 2
.2 3
GetChildRows3 ?
(? @
$str@ K
)K L
)L M
{ 
	lblOutput 
. 
Text "
+=# %
$str& N
;N O
	lblOutput 
. 
Text "
+=# %
$str& D
+E F
prodRowG N
[N O
$numO P
]P Q
+R S
$strT `
;` a
	lblOutput 
. 
Text "
+=# %
$str& (
+) *
prodRow+ 2
[2 3
$num3 4
]4 5
+6 7
$str8 A
;A B
	lblOutput 
. 
Text "
+=# %
$str& T
+U V
prodRowW ^
[^ _
$num_ `
]` a
.a b
ToStringb j
(j k
)k l
+m n
$stro {
;{ |
	lblOutput 
. 
Text "
+=# %
$str	& Ö
;
Ö ×
	lblOutput 
. 
Text "
+=# %
$str& .
;. /
	lblOutput   
.   
Text   "
+=  # %
$str  & 0
;  0 1
}!! 
}"" 
}77 	
}88 
}99 á
FC:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\ChangePassword.aspx.cs
	namespace

 	
OWASP


 
.

 
WebGoat

 
.

 
NET

 
.

 
WebGoatCoins

 (
{ 
public 

partial 
class 
ChangePassword '
:( )
System* 0
.0 1
Web1 4
.4 5
UI5 7
.7 8
Page8 <
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
	protected 
void &
ButtonChangePassword_Click 1
(1 2
object2 8
sender9 ?
,? @
	EventArgsA J
eK L
)L M
{ 	
if 
( 
txtPassword1 
. 
Text  
!=! #
null$ (
&&) +
txtPassword2, 8
.8 9
Text9 =
!=> @
nullA E
&&F H
txtPassword1I U
.U V
TextV Z
==[ ]
txtPassword2^ j
.j k
Textk o
)o p
{ 
string 
customerNumber %
=& '
$str( *
;* +
if 
( 
Request 
. 
Cookies #
[# $
$str$ 4
]4 5
!=6 8
null9 =
)= >
{ 
customerNumber "
=# $
Request% ,
., -
Cookies- 4
[4 5
$str5 E
]E F
.F G
ValueG L
;L M
} 
string   
output   
=   
du    "
.  " #"
UpdateCustomerPassword  # 9
(  9 :
int  : =
.  = >
Parse  > C
(  C D
customerNumber  D R
)  R S
,  S T
txtPassword1  U a
.  a b
Text  b f
)  f g
;  g h
labelMessage!! 
.!! 
Text!! !
=!!" #
output!!$ *
;!!* +
}"" 
else## 
{$$ 
labelMessage%% 
.%% 
Text%% !
=%%" #
$str%%$ P
;%%P Q
}&& 
}(( 	
})) 
}** æ%
EC:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\CustomerLogin.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
WebGoatCoins (
{ 
public 

partial 
class 
CustomerLogin &
:' (
System) /
./ 0
Web0 3
.3 4
UI4 6
.6 7
Page7 ;
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
ILog 
log 
= 

LogManager 
. 
	GetLogger '
(' (

MethodBase( 2
.2 3
GetCurrentMethod3 C
(C D
)D E
.E F
DeclaringTypeF S
)S T
;T U
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	

PanelError 
. 
Visible 
=  
false! &
;& '
string 
	returnUrl 
= 
Request &
.& '
QueryString' 2
[2 3
$str3 >
]> ?
;? @
if 
( 
	returnUrl 
!= 
null !
)! "
{ 

PanelError 
. 
Visible "
=# $
true% )
;) *
} 
} 	
	protected 
void 
ButtonLogOn_Click (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{   	
string!! 
email!! 
=!! 
txtUserName!! &
.!!& '
Text!!' +
;!!+ ,
string"" 
pwd"" 
="" 
txtPassword"" $
.""$ %
Text""% )
;"") *
log$$ 
.$$ 
Info$$ 
($$ 
$str$$ 
+$$ 
email$$ $
+$$% &
$str$$' L
+$$M N
pwd$$O R
)$$R S
;$$S T
if&& 
(&& 
!&& 
du&& 
.&&  
IsValidCustomerLogin&& (
(&&( )
email&&) .
,&&. /
pwd&&0 3
)&&3 4
)&&4 5
{'' 

labelError(( 
.(( 
Text(( 
=((  !
$str((" ?
;((? @

PanelError)) 
.)) 
Visible)) "
=))# $
true))% )
;))) *
return** 
;** 
}++ %
FormsAuthenticationTicket-- %
ticket--& ,
=--- .
new.. %
FormsAuthenticationTicket.. 5
(..5 6
$num// 
,// 
email00 !
,00! "
DateTime11 $
.11$ %
Now11% (
,11( )
DateTime22 $
.22$ %
Now22% (
.22( )
AddDays22) 0
(220 1
$num221 3
)223 4
,224 5
true33  
,33  !
$str44 &
,44& '
FormsAuthentication55 /
.55/ 0
FormsCookiePath550 ?
)66 
;66 
string88 
encrypted_ticket88 #
=88$ %
FormsAuthentication88& 9
.889 :
Encrypt88: A
(88A B
ticket88B H
)88H I
;88I J

HttpCookie;; 
cookie;; 
=;; 
new;;  #

HttpCookie;;$ .
(;;. /
FormsAuthentication;;/ B
.;;B C
FormsCookieName;;C R
,;;R S
encrypted_ticket;;T d
);;d e
;;;e f
if>> 
(>> 
ticket>> 
.>> 
IsPersistent>> #
)>># $
cookie?? 
.?? 
Expires?? 
=??  
ticket??! '
.??' (

Expiration??( 2
;??2 3
ResponseAA 
.AA 
CookiesAA 
.AA 
AddAA  
(AA  !
cookieAA! '
)AA' (
;AA( )
stringCC 
	returnUrlCC 
=CC 
RequestCC &
.CC& '
QueryStringCC' 2
[CC2 3
$strCC3 >
]CC> ?
;CC? @
ifEE 
(EE 
	returnUrlEE 
==EE 
nullEE !
)EE! "
	returnUrlFF 
=FF 
$strFF 9
;FF9 :
ResponseHH 
.HH 
RedirectHH 
(HH 
	returnUrlHH '
)HH' (
;HH( )
}II 	
}JJ 
}KK Í
HC:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\CustomerSettings.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
WebGoatCoins (
{		 
public

 

partial

 
class

 
CustomerSettings

 )
:

* +
System

, 2
.

2 3
Web

3 6
.

6 7
UI

7 9
.

9 :
Page

: >
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ·
=C:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\Debug.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
WebGoatCoins (
{		 
public

 

partial

 
class

 
Debug

 
:

  
System

! '
.

' (
Web

( +
.

+ ,
UI

, .
.

. /
Page

/ 3
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} Ï2
FC:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\ForgotPassword.aspx.cs
	namespace

 	
OWASP


 
.

 
WebGoat

 
.

 
NET

 
.

 
WebGoatCoins

 (
{ 
public 

partial 
class 
ForgotPassword '
:( )
System* 0
.0 1
Web1 4
.4 5
UI5 7
.7 8
Page8 <
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
if 
( 
! 
Page 
. 

IsPostBack  
)  !
{ $
PanelForgotPasswordStep2 (
.( )
Visible) 0
=1 2
false3 8
;8 9$
PanelForgotPasswordStep3 (
.( )
Visible) 0
=1 2
false3 8
;8 9
} 
} 	
	protected 
void "
ButtonCheckEmail_Click -
(- .
object. 4
sender5 ;
,; <
	EventArgs= F
eG H
)H I
{ 	
string 
[ 
] 
result 
= 
du  
.  !(
GetSecurityQuestionAndAnswer! =
(= >
txtEmail> F
.F G
TextG K
)K L
;L M
if 
( 
string 
. 
IsNullOrEmpty $
($ %
result% +
[+ ,
$num, -
]- .
). /
)/ 0
{ 
labelQuestion   
.   
Text   "
=  # $
$str  % X
;  X Y$
PanelForgotPasswordStep2!! (
.!!( )
Visible!!) 0
=!!1 2
false!!3 8
;!!8 9$
PanelForgotPasswordStep3"" (
.""( )
Visible"") 0
=""1 2
false""3 8
;""8 9
return$$ 
;$$ 
}%% 
labelQuestion&& 
.&& 
Text&& 
=&&  
$str&&! Y
+&&Z [
result&&\ b
[&&b c
$num&&c d
]&&d e
+&&f g
$str&&h s
;&&s t$
PanelForgotPasswordStep2'' $
.''$ %
Visible''% ,
=''- .
true''/ 3
;''3 4$
PanelForgotPasswordStep3(( $
.(($ %
Visible((% ,
=((- .
false((/ 4
;((4 5

HttpCookie++ 
cookie++ 
=++ 
new++  #

HttpCookie++$ .
(++. /
$str++/ @
)++@ A
;++A B
cookie// 
.// 
Value// 
=// 
Encoder// "
.//" #
Encode//# )
(//) *
Encoder//* 1
.//1 2
Encode//2 8
(//8 9
result//9 ?
[//? @
$num//@ A
]//A B
)//B C
)//C D
;//D E
Response11 
.11 
Cookies11 
.11 
Add11  
(11  !
cookie11! '
)11' (
;11( )
}22 	
	protected44 
void44 '
ButtonRecoverPassword_Click44 2
(442 3
object443 9
sender44: @
,44@ A
	EventArgs44B K
e44L M
)44M N
{55 	
try66 
{77 
string99 
encrypted_password99 )
=99* +
Request99, 3
.993 4
Cookies994 ;
[99; <
$str99< M
]99M N
.99N O
Value99O T
.99T U
ToString99U ]
(99] ^
)99^ _
;99_ `
string<< 
security_answer<< &
=<<' (
Encoder<<) 0
.<<0 1
Decode<<1 7
(<<7 8
Encoder<<8 ?
.<<? @
Decode<<@ F
(<<F G
encrypted_password<<G Y
)<<Y Z
)<<Z [
;<<[ \
if>> 
(>> 
security_answer>> #
.>># $
Trim>>$ (
(>>( )
)>>) *
.>>* +
ToLower>>+ 2
(>>2 3
)>>3 4
.>>4 5
Equals>>5 ;
(>>; <
	txtAnswer>>< E
.>>E F
Text>>F J
.>>J K
Trim>>K O
(>>O P
)>>P Q
.>>Q R
ToLower>>R Y
(>>Y Z
)>>Z [
)>>[ \
)>>\ ]
{?? $
PanelForgotPasswordStep1@@ ,
.@@, -
Visible@@- 4
=@@5 6
false@@7 <
;@@< =$
PanelForgotPasswordStep2AA ,
.AA, -
VisibleAA- 4
=AA5 6
falseAA7 <
;AA< =$
PanelForgotPasswordStep3BB ,
.BB, -
VisibleBB- 4
=BB5 6
trueBB7 ;
;BB; <
labelPasswordCC !
.CC! "
TextCC" &
=CC' (
$strCC) v
+CCw x
getPassword	CCy „
(
CC„ …
txtEmail
CC… 
.
CC Ž
Text
CCŽ ’
)
CC’ “
;
CC“ ”
}DD 
}EE 
catchFF 
(FF 
	ExceptionFF 
exFF 
)FF  
{GG 
labelMessageHH 
.HH 
TextHH !
=HH" #
$strHH$ r
+HHs t
exHHu w
.HHw x
MessageHHx 
;	HH €
}II 
}JJ 	
	protectedLL 
voidLL )
ButtonGoToCustomerLogin_ClickLL 4
(LL4 5
objectLL5 ;
senderLL< B
,LLB C
	EventArgsLLD M
eLLN O
)LLO P
{MM 	
ResponseNN 
.NN 
RedirectNN 
(NN 
$strNN 2
)NN2 3
;NN3 4
}OO 	
stringQQ 
getPasswordQQ 
(QQ 
stringQQ !
emailQQ" '
)QQ' (
{RR 	
stringSS 
passwordSS 
=SS 
duSS  
.SS  !
GetPasswordByEmailSS! 3
(SS3 4
emailSS4 9
)SS9 :
;SS: ;
returnTT 
passwordTT 
;TT 
}UU 	
}WW 
}XX „	
>C:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\Logout.aspx.cs
	namespace		 	
OWASP		
 
.		 
WebGoat		 
.		 
NET		 
.		 
WebGoatCoins		 (
{

 
public 

partial 
class 
Logout 
:  !
System" (
.( )
Web) ,
., -
UI- /
./ 0
Page0 4
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
	protected 
void 
btnLogout_Click &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
FormsAuthentication 
.  
SignOut  '
(' (
)( )
;) *
Response 
. 
Redirect 
( 
$str -
)- .
;. /
} 	
} 
} è'
@C:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\MainPage.aspx.cs
	namespace

 	
OWASP


 
.

 
WebGoat

 
.

 
NET

 
{ 
public 

partial 
class 
MainPage !
:" #
System$ *
.* +
Web+ .
.. /
UI/ 1
.1 2
Page2 6
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
labelUpload 
. 
Visible 
=  !
false" '
;' (
if 
( 
Request 
. 
Cookies 
[  
$str  0
]0 1
!=2 4
null5 9
)9 :
{ 
string 
customerNumber %
=& '
Request( /
./ 0
Cookies0 7
[7 8
$str8 H
]H I
.I J
ValueJ O
;O P
DataSet 
ds 
= 
du 
.  
GetCustomerDetails  2
(2 3
customerNumber3 A
)A B
;B C
DataRow 
row 
= 
ds  
.  !
Tables! '
[' (
$num( )
]) *
.* +
Rows+ /
[/ 0
$num0 1
]1 2
;2 3
Image1   
.   
ImageUrl   
=    !
$str  " 1
+  2 3
row  4 7
[  7 8
$str  8 F
]  F G
;  G H
foreach"" 
("" 

DataColumn"" #
col""$ '
in""( *
ds""+ -
.""- .
Tables"". 4
[""4 5
$num""5 6
]""6 7
.""7 8
Columns""8 ?
)""? @
{## 
TableRow$$ 
tablerow$$ %
=$$& '
new$$( +
TableRow$$, 4
($$4 5
)$$5 6
;$$6 7
tablerow%% 
.%% 
ID%% 
=%%  !
col%%" %
.%%% &

ColumnName%%& 0
.%%0 1
ToString%%1 9
(%%9 :
)%%: ;
;%%; <
	TableCell'' 
cell1'' #
=''$ %
new''& )
	TableCell''* 3
(''3 4
)''4 5
;''5 6
	TableCell(( 
cell2(( #
=(($ %
new((& )
	TableCell((* 3
(((3 4
)((4 5
;((5 6
cell1)) 
.)) 
Text)) 
=))  
col))! $
.))$ %

ColumnName))% /
.))/ 0
ToString))0 8
())8 9
)))9 :
;)): ;
cell2** 
.** 
Text** 
=**  
row**! $
[**$ %
col**% (
]**( )
.**) *
ToString*** 2
(**2 3
)**3 4
;**4 5
tablerow,, 
.,, 
Cells,, "
.,," #
Add,,# &
(,,& '
cell1,,' ,
),,, -
;,,- .
tablerow-- 
.-- 
Cells-- "
.--" #
Add--# &
(--& '
cell2--' ,
)--, -
;--- .
CustomerTable// !
.//! "
Rows//" &
.//& '
Add//' *
(//* +
tablerow//+ 3
)//3 4
;//4 5
}00 
}11 
}22 	
	protected44 
void44 
btnUpload_Click44 &
(44& '
object44' -
sender44. 4
,444 5
	EventArgs446 ?
e44@ A
)44A B
{55 	
if66 
(66 
FileUpload166 
.66 
HasFile66 #
)66# $
{77 
try88 
{99 
string:: 
filename:: #
=::$ %
Path::& *
.::* +
GetFileName::+ 6
(::6 7
FileUpload1::7 B
.::B C
FileName::C K
)::K L
;::L M
FileUpload1;; 
.;;  
SaveAs;;  &
(;;& '
Server;;' -
.;;- .
MapPath;;. 5
(;;5 6
$str;;6 O
);;O P
+;;Q R
filename;;S [
);;[ \
;;;\ ]
}== 
catch>> 
(>> 
	Exception>>  
ex>>! #
)>># $
{?? 
labelUpload@@ 
.@@  
Text@@  $
=@@% &
$str@@' 8
+@@9 :
ex@@; =
.@@= >
Message@@> E
;@@E F
}AA 
finallyBB 
{CC 
labelUploadDD 
.DD  
VisibleDD  '
=DD( )
trueDD* .
;DD. /
}EE 
}FF 
}GG 	
}HH 
}II ðQ
>C:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\Orders.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
WebGoatCoins (
{ 
public 

partial 
class 
Orders 
:  !
System" (
.( )
Web) ,
., -
UI- /
./ 0
Page0 4
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
int 
id 
; 
DataSet 
ds 
; 
if 
( 
Request 
. 
Cookies 
[  
$str  0
]0 1
==2 4
null5 9
||: <
!= >
int> A
.A B
TryParseB J
(J K
RequestK R
.R S
CookiesS Z
[Z [
$str[ k
]k l
.l m
Valuem r
.r s
ToStrings {
({ |
)| }
,} ~
out	 ‚
id
ƒ …
)
… †
)
† ‡
	lblOutput 
. 
Text 
=  
$str	! „
;
„ …
else 
{ 
ds 
= 
du 
. 
	GetOrders !
(! "
id" $
)$ %
;% &
if 
( 
! 
Page 
. 

IsPostBack $
)$ %
{ 
	GridView1   
.   

DataSource   (
=  ) *
ds  + -
.  - .
Tables  . 4
[  4 5
$num  5 6
]  6 7
;  7 8
	GridView1"" 
."" 
AutoGenerateColumns"" 1
=""2 3
false""4 9
;""9 :

BoundField$$ !
BoundFieldOrderNumber$$ 4
=$$5 6
new$$7 :

BoundField$$; E
($$E F
)$$F G
;$$G H

BoundField%% 
BoundFieldStatus%% /
=%%0 1
new%%2 5

BoundField%%6 @
(%%@ A
)%%A B
;%%B C

BoundField&& "
BoundFieldRequiredDate&& 5
=&&6 7
new&&8 ;

BoundField&&< F
(&&F G
)&&G H
;&&H I

BoundField'' !
BoundFieldShippedDate'' 4
=''5 6
new''7 :

BoundField''; E
(''E F
)''F G
;''G H!
BoundFieldOrderNumber)) )
.))) *
	DataField))* 3
=))4 5
$str))6 C
;))C D
BoundFieldStatus** $
.**$ %
	DataField**% .
=**/ 0
$str**1 9
;**9 :"
BoundFieldRequiredDate++ *
.++* +
	DataField+++ 4
=++5 6
$str++7 E
;++E F!
BoundFieldShippedDate,, )
.,,) *
	DataField,,* 3
=,,4 5
$str,,6 C
;,,C D!
BoundFieldOrderNumber.. )
...) *

HeaderText..* 4
=..5 6
$str..7 E
;..E F
BoundFieldStatus// $
.//$ %

HeaderText//% /
=//0 1
$str//2 :
;//: ;"
BoundFieldRequiredDate00 *
.00* +

HeaderText00+ 5
=006 7
$str008 G
;00G H!
BoundFieldShippedDate11 )
.11) *

HeaderText11* 4
=115 6
$str117 E
;11E F"
BoundFieldRequiredDate33 *
.33* +
DataFormatString33+ ;
=33< =
$str33> N
;33N O!
BoundFieldShippedDate44 )
.44) *
DataFormatString44* :
=44; <
$str44= M
;44M N
	GridView166 
.66 
Columns66 %
.66% &
Add66& )
(66) *!
BoundFieldOrderNumber66* ?
)66? @
;66@ A
	GridView177 
.77 
Columns77 %
.77% &
Add77& )
(77) *
BoundFieldStatus77* :
)77: ;
;77; <
	GridView188 
.88 
Columns88 %
.88% &
Add88& )
(88) *"
BoundFieldRequiredDate88* @
)88@ A
;88A B
	GridView199 
.99 
Columns99 %
.99% &
Add99& )
(99) *!
BoundFieldShippedDate99* ?
)99? @
;99@ A
	GridView1;; 
.;; 
DataBind;; &
(;;& '
);;' (
;;;( )
}<< 
string>> 
orderNumber>> "
=>># $
Request>>% ,
[>>, -
$str>>- :
]>>: ;
;>>; <
if?? 
(?? 
orderNumber?? 
!=??  "
null??# '
)??' (
{@@ 
tryAA 
{BB 
DataSetDD 
dsOrderDetailsDD  .
=DD/ 0
duDD1 3
.DD3 4
GetOrderDetailsDD4 C
(DDC D
intDDD G
.DDG H
ParseDDH M
(DDM N
orderNumberDDN Y
)DDY Z
)DDZ [
;DD[ \
DetailsView1EE $
.EE$ %

DataSourceEE% /
=EE0 1
dsOrderDetailsEE2 @
.EE@ A
TablesEEA G
[EEG H
$numEEH I
]EEI J
;EEJ K
DetailsView1FF $
.FF$ %
DataBindFF% -
(FF- .
)FF. /
;FF/ 0"
PanelShowDetailSuccessHH .
.HH. /
VisibleHH/ 6
=HH7 8
trueHH9 =
;HH= >
stringKK 
imageKK $
=KK% &
dsOrderDetailsKK' 5
.KK5 6
TablesKK6 <
[KK< =
$numKK= >
]KK> ?
.KK? @
RowsKK@ D
[KKD E
$numKKE F
]KKF G
[KKG H
$strKKH V
]KKV W
.KKW X
ToStringKKX `
(KK` a
)KKa b
;KKb c

HyperLink1LL "
.LL" #
TextLL# '
=LL( )
$strLL* B
;LLB C

HyperLink1MM "
.MM" #
NavigateUrlMM# .
=MM/ 0
RequestMM1 8
.MM8 9
RawUrlMM9 ?
+MM@ A
$strMMB [
+MM\ ]
imageMM^ c
;MMc d
}NN 
catchOO 
(OO 
	ExceptionOO $
exOO% '
)OO' (
{PP "
PanelShowDetailFailureRR .
.RR. /
VisibleRR/ 6
=RR7 8
trueRR9 =
;RR= >!
litErrorDetailMessageSS -
.SS- .
TextSS. 2
=SS3 4
$strSS5 R
+SSS T
orderNumberSSU `
+SSa b
$strSSc p
+SSq r
exSSs u
.SSu v
MessageSSv }
;SS} ~
}TT 
}UU 
stringXX 
target_imageXX #
=XX$ %
RequestXX& -
[XX- .
$strXX. 5
]XX5 6
;XX6 7
ifYY 
(YY 
target_imageYY  
!=YY! #
nullYY$ (
)YY( )
{ZZ 
FileInfo[[ 
fi[[ 
=[[  !
new[[" %
FileInfo[[& .
([[. /
Server[[/ 5
.[[5 6
MapPath[[6 =
([[= >
target_image[[> J
)[[J K
)[[K L
;[[L M
	lblOutput\\ 
.\\ 
Text\\ "
=\\# $
fi\\% '
.\\' (
FullName\\( 0
;\\0 1
NameValueCollection^^ '
imageExtensions^^( 7
=^^8 9
new^^: =
NameValueCollection^^> Q
(^^Q R
)^^R S
;^^S T
imageExtensions__ #
.__# $
Add__$ '
(__' (
$str__( .
,__. /
$str__0 <
)__< =
;__= >
imageExtensions`` #
.``# $
Add``$ '
(``' (
$str``( .
,``. /
$str``0 ;
)``; <
;``< =
imageExtensionsaa #
.aa# $
Addaa$ '
(aa' (
$straa( .
,aa. /
$straa0 ;
)aa; <
;aa< =
Responsecc 
.cc 
ContentTypecc (
=cc) *
imageExtensionscc+ :
.cc: ;
Getcc; >
(cc> ?
ficc? A
.ccA B
	ExtensionccB K
)ccK L
;ccL M
Responsedd 
.dd 
AppendHeaderdd )
(dd) *
$strdd* ?
,dd? @
$strddA X
+ddY Z
fidd[ ]
.dd] ^
Namedd^ b
)ddb c
;ddc d
Responseee 
.ee 
TransmitFileee )
(ee) *
fiee* ,
.ee, -
FullNameee- 5
)ee5 6
;ee6 7
Responseff 
.ff 
Endff  
(ff  !
)ff! "
;ff" #
}gg 
}ii 
}jj 	
	protectedll 
voidll "
GridView1_RowDataBoundll -
(ll- .
objectll. 4
senderll5 ;
,ll; < 
GridViewRowEventArgsll= Q
ellR S
)llS T
{mm 	
ifoo 
(oo 
eoo 
.oo 
Rowoo 
.oo 
RowTypeoo 
==oo  
DataControlRowTypeoo! 3
.oo3 4
DataRowoo4 ;
)oo; <
{pp 
	HyperLinkqq 
linkqq 
=qq  
newqq! $
	HyperLinkqq% .
(qq. /
)qq/ 0
;qq0 1
linkrr 
.rr 
Textrr 
=rr 
err 
.rr 
Rowrr !
.rr! "
Cellsrr" '
[rr' (
$numrr( )
]rr) *
.rr* +
Textrr+ /
;rr/ 0
linkss 
.ss 
NavigateUrlss  
=ss! "
$strss# =
+ss> ?
linkss@ D
.ssD E
TextssE I
;ssI J
ett 
.tt 
Rowtt 
.tt 
Cellstt 
[tt 
$numtt 
]tt 
.tt 
Controlstt '
.tt' (
Addtt( +
(tt+ ,
linktt, 0
)tt0 1
;tt1 2
}uu 
}ww 	
}xx 
}yy ¶B
FC:\work\code\OWASP-WebGoat\WebGoat\WebGoatCoins\ProductDetails.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
WebGoatCoins (
{ 
public 

partial 
class 
ProductDetails '
:( )
System* 0
.0 1
Web1 4
.4 5
UI5 7
.7 8
Page8 <
{ 
private 
IDbProvider 
du 
=  
Settings! )
.) *
CurrentDbProvider* ;
;; <
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	

lblMessage 
. 
Visible 
=  
false! &
;& '
txtEmail 
. 
Enabled 
= 
true #
;# $
if 
( 
! 
Page 
. 

IsPostBack  
)  !
LoadComments 
( 
) 
; 
if 
( 
! 
Page 
. 

IsPostBack  
)  !
{ 
DataSet 
ds 
= 
du 
.  
GetCatalogData  .
(. /
)/ 0
;0 1
ddlItems 
. 

DataSource #
=$ %
ds& (
.( )
Tables) /
[/ 0
$num0 1
]1 2
;2 3
ddlItems 
. 
DataTextField &
=' (
$str) 6
;6 7
ddlItems   
.   
DataValueField   '
=  ( )
$str  * 7
;  7 8
ddlItems!! 
.!! 
DataBind!! !
(!!! "
)!!" #
;!!# $
}"" 
}## 	
	protected%% 
void%% 
btnSave_Click%% $
(%%$ %
object%%% +
sender%%, 2
,%%2 3
	EventArgs%%4 =
e%%> ?
)%%? @
{&& 	
try'' 
{(( 
string)) 
error_message)) $
=))% &
du))' )
.))) *

AddComment))* 4
())4 5 
hiddenFieldProductID))5 I
.))I J
Value))J O
,))O P
txtEmail))Q Y
.))Y Z
Text))Z ^
,))^ _

txtComment))` j
.))j k
Text))k o
)))o p
;))p q

txtComment** 
.** 
Text** 
=**  !
error_message**" /
;**/ 0

lblMessage++ 
.++ 
Visible++ "
=++# $
true++% )
;++) *
LoadComments,, 
(,, 
),, 
;,, 
}-- 
catch.. 
(.. 
	Exception.. 
ex.. 
).. 
{// 

lblMessage00 
.00 
Text00 
=00  !
ex00" $
.00$ %
Message00% ,
;00, -

lblMessage11 
.11 
Visible11 "
=11# $
true11% )
;11) *
}22 
}33 	
void55 
LoadComments55 
(55 
)55 
{66 	
string77 
id77 
=77 
Request77 
[77  
$str77  /
]77/ 0
;770 1
if88 
(88 
id88 
==88 
null88 
)88 
id88 
=88  
$str88! +
;88+ ,
DataSet99 
ds99 
=99 
du99 
.99 
GetProductDetails99 -
(99- .
id99. 0
)990 1
;991 2
string:: 
output:: 
=:: 
string:: "
.::" #
Empty::# (
;::( )
string;; 
comments;; 
=;; 
string;; $
.;;$ %
Empty;;% *
;;;* +
foreach<< 
(<< 
DataRow<< 
prodRow<< $
in<<% '
ds<<( *
.<<* +
Tables<<+ 1
[<<1 2
$str<<2 <
]<<< =
.<<= >
Rows<<> B
)<<B C
{== 
output>> 
+=>> 
$str>> A
;>>A B
output?? 
+=?? 
$str?? 8
+??9 :
prodRow??; B
[??B C
$str??C Q
]??Q R
+??S T
$str??U _
;??_ `
output@@ 
+=@@ 
$str@@ $
+@@% &
prodRow@@' .
[@@. /
$str@@/ <
]@@< =
.@@= >
ToString@@> F
(@@F G
)@@G H
+@@I J
$str@@K [
;@@[ \
outputAA 
+=AA 
$strAA !
+AA" #
prodRowAA$ +
[AA+ ,
$strAA, @
]AA@ A
.AAA B
ToStringAAB J
(AAJ K
)AAK L
+AAM N
$strAAO V
;AAV W
outputBB 
+=BB 
$strBB "
;BB" # 
hiddenFieldProductIDDD $
.DD$ %
ValueDD% *
=DD+ ,
prodRowDD- 4
[DD4 5
$strDD5 B
]DDB C
.DDC D
ToStringDDD L
(DDL M
)DDM N
;DDN O
DataRowFF 
[FF 
]FF 
	childrowsFF #
=FF$ %
prodRowFF& -
.FF- .
GetChildRowsFF. :
(FF: ;
$strFF; J
)FFJ K
;FFK L
ifGG 
(GG 
	childrowsGG 
.GG 
LengthGG $
>GG% &
$numGG' (
)GG( )
commentsHH 
+=HH 
$strHH  L
;HHL M
foreachJJ 
(JJ 
DataRowJJ  

commentRowJJ! +
inJJ, .
	childrowsJJ/ 8
)JJ8 9
{KK 
commentsLL 
+=LL 
$strLL  9
+LL: ;

commentRowLL< F
[LLF G
$strLLG N
]LLN O
+LLP Q
$str	LLR ¬
;
LL¬ ­
commentsMM 
+=MM 
$strMM  @
+MMA B

commentRowMMC M
[MMM N
$strMMN W
]MMW X
+MMY Z
$strMM[ g
;MMg h
}NN 
}PP 
	lblOutputRR 
.RR 
TextRR 
=RR 
outputRR #
;RR# $
lblCommentsSS 
.SS 
TextSS 
=SS 
commentsSS '
;SS' (
ifWW 
(WW 
RequestWW 
.WW 
CookiesWW 
[WW  
$strWW  0
]WW0 1
!=WW2 4
nullWW5 9
)WW9 :
{XX 
stringYY 
customerNumberYY %
=YY& '
RequestYY( /
.YY/ 0
CookiesYY0 7
[YY7 8
$strYY8 H
]YYH I
.YYI J
ValueYYJ O
;YYO P
string[[ 
email[[ 
=[[ 
du[[ !
.[[! "
GetCustomerEmail[[" 2
([[2 3
customerNumber[[3 A
)[[A B
;[[B C
txtEmail\\ 
.\\ 
Text\\ 
=\\ 
email\\  %
;\\% &
txtEmail]] 
.]] 
ReadOnly]] !
=]]" #
true]]$ (
;]]( )
}^^ 
}__ 	
	protectedaa 
voidaa )
ddlItems_SelectedIndexChangedaa 4
(aa4 5
objectaa5 ;
senderaa< B
,aaB C
	EventArgsaaD M
eaaN O
)aaO P
{bb 	
Responsecc 
.cc 
Redirectcc 
(cc 
$strcc B
+ccC D
ddlItemsccE M
.ccM N
SelectedItemccN Z
.ccZ [
Valuecc[ `
)cc` a
;cca b
}dd 	
	protectedff 
voidff 
Button1_Clickff $
(ff$ %
objectff% +
senderff, 2
,ff2 3
	EventArgsff4 =
eff> ?
)ff? @
{gg 	
Responsehh 
.hh 
Redirecthh 
(hh 
$strhh B
+hhC D
ddlItemshhE M
.hhM N
SelectedItemhhN Z
.hhZ [
Valuehh[ `
)hh` a
;hha b
}ii 	
}kk 
}ll Û
5C:\work\code\OWASP-WebGoat\WebGoat\ProxySetup.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 
partial

 
class

 

ProxySetup

  
:

! "
System

# )
.

) *
Web

* -
.

- .
UI

. 0
.

0 1
Page

1 5
{ 
	protected 
void 
btnReverse_Click !
(! "
object" (
sender) /
,/ 0
	EventArgs1 :
e; <
)< =
{ 	
var 
name 
= 
txtName 
. 
Text #
;# $
txtName 
. 
Text 
= 
$str 
; 
	lblOutput 
. 
Text 
= 
$str ?
+@ A
reverseB I
(I J
nameJ N
)N O
;O P
} 	
private 
string 
reverse 
( 
string %
s& '
)' (
{ 	
var 
	charArray 
= 
s 
. 
ToCharArray )
() *
)* +
;+ ,
Array 
. 
Reverse 
( 
	charArray #
)# $
;$ %
return 
new 
String 
( 
	charArray '
)' (
;( )
} 	
} 
} ³
HC:\work\code\OWASP-WebGoat\WebGoat\Resources\Master-Pages\Site.Master.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
	resources %
.% &
Master_Pages& 2
{		 
public

 

partial

 
class

 
Site

 
:

 
System

  &
.

& '
Web

' *
.

* +
UI

+ -
.

- .

MasterPage

. 8
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
if 
( 
Session 
[ 
$str $
]$ %
==& (
null) -
)- .
{ 
Session 
[ 
$str $
]$ %
=& '
false( -
;- .
Response 
. 
Redirect !
(! "
$str" 2
)2 3
;3 4
} 
} 	
	protected 
void %
lbtGenerateTestData_Click 0
(0 1
object1 7
sender8 >
,> ?
	EventArgs@ I
eJ K
)K L
{ 	
Response	 
. 
Redirect 
( 
$str 2
)2 3
;3 4
} 	
public 
void 
GreyOutMenu 
(  
)  !
{ 	
foreach 
( 
RepeaterItem !
item" &
in' )
rptrMenu* 2
.2 3
Items3 8
)8 9
{ 
} 
} 	
}   
}!! ¤Ø
BC:\work\code\OWASP-WebGoat\WebGoat\App_Code\DB\SqliteDbProvider.cs
	namespace

 	
OWASP


 
.

 
WebGoat

 
.

 
NET

 
.

 
App_Code

 $
.

$ %
DB

% '
{ 
public 

class 
SqliteDbProvider !
:" #
IDbProvider$ /
{ 
private 
string 
_connectionString (
=) *
string+ 1
.1 2
Empty2 7
;7 8
private 
string 
_clientExec "
;" #
private 
string 
_dbFileName "
;" #
ILog 
log 
= 

LogManager 
. 
	GetLogger '
(' (

MethodBase( 2
.2 3
GetCurrentMethod3 C
(C D
)D E
.E F
DeclaringTypeF S
)S T
;T U
public 
string 
Name 
{ 
get  
{! "
return# )
DbConstants* 5
.5 6
DB_TYPE_SQLITE6 D
;D E
}F G
}H I
public 
SqliteDbProvider 
(  

ConfigFile  *

configFile+ 5
)5 6
{ 	
_connectionString 
= 
string  &
.& '
Format' -
(- .
$str. I
,I J

configFileK U
.U V
GetV Y
(Y Z
DbConstantsZ e
.e f
KEY_FILE_NAMEf s
)s t
)t u
;u v
_clientExec 
= 

configFile $
.$ %
Get% (
(( )
DbConstants) 4
.4 5
KEY_CLIENT_EXEC5 D
)D E
;E F
_dbFileName 
= 

configFile $
.$ %
Get% (
(( )
DbConstants) 4
.4 5
KEY_FILE_NAME5 B
)B C
;C D
} 	
public 
bool 
TestConnection "
(" #
)# $
{ 	
try   
{!! 
using"" 
("" 
SQLiteConnection"" '
conn""( ,
=""- .
new""/ 2
SQLiteConnection""3 C
(""C D
_connectionString""D U
)""U V
)""V W
{## 
conn$$ 
.$$ 
Open$$ 
($$ 
)$$ 
;$$  
using&& 
(&& 
SQLiteCommand&& (
cmd&&) ,
=&&- .
conn&&/ 3
.&&3 4
CreateCommand&&4 A
(&&A B
)&&B C
)&&C D
{'' 
cmd)) 
.)) 
CommandText)) '
=))( )
$str))* >
;))> ?
cmd** 
.** 
CommandType** '
=**( )
CommandType*** 5
.**5 6
Text**6 :
;**: ;
cmd++ 
.++ 
ExecuteReader++ )
(++) *
)++* +
;+++ ,
},, 
}-- 
return.. 
true.. 
;.. 
}// 
catch00 
(00 
	Exception00 
ex00 
)00  
{11 
log22 
.22 
Error22 
(22 
$str22 ,
,22, -
ex22. 0
)220 1
;221 2
return33 
false33 
;33 
}44 
}55 	
public77 
DataSet77 
GetCatalogData77 %
(77% &
)77& '
{88 	
using99 
(99 
SQLiteConnection99 #

connection99$ .
=99/ 0
new991 4
SQLiteConnection995 E
(99E F
_connectionString99F W
)99W X
)99X Y
{:: 
SQLiteDataAdapter;; !
da;;" $
=;;% &
new;;' *
SQLiteDataAdapter;;+ <
(;;< =
$str;;= U
,;;U V

connection;;W a
);;a b
;;;b c
DataSet<< 
ds<< 
=<< 
new<<  
DataSet<<! (
(<<( )
)<<) *
;<<* +
da>> 
.>> 
Fill>> 
(>> 
ds>> 
)>> 
;>> 
return@@ 
ds@@ 
;@@ 
}AA 
}BB 	
publicDD 
boolDD  
IsValidCustomerLoginDD (
(DD( )
stringDD) /
emailDD0 5
,DD5 6
stringDD7 =
passwordDD> F
)DDF G
{EE 	
stringGG 
encoded_passwordGG #
=GG$ %
EncoderGG& -
.GG- .
EncodeGG. 4
(GG4 5
passwordGG5 =
)GG= >
;GG> ?
stringJJ 
sqlJJ 
=JJ 
$strJJ F
+JJG H
emailJJI N
+JJO P
$strJJQ e
+JJf g
encoded_passwordKK )
+KK* +
$strKK, 0
;KK0 1
usingMM 
(MM 
SQLiteConnectionMM #

connectionMM$ .
=MM/ 0
newMM1 4
SQLiteConnectionMM5 E
(MME F
_connectionStringMMF W
)MMW X
)MMX Y
{NN 
SQLiteDataAdapterOO !
daOO" $
=OO% &
newOO' *
SQLiteDataAdapterOO+ <
(OO< =
sqlOO= @
,OO@ A

connectionOOB L
)OOL M
;OOM N
DataSetRR 
dsRR 
=RR 
newRR  
DataSetRR! (
(RR( )
)RR) *
;RR* +
daTT 
.TT 
FillTT 
(TT 
dsTT 
)TT 
;TT 
tryVV 
{WW 
returnXX 
dsXX 
.XX 
TablesXX $
[XX$ %
$numXX% &
]XX& '
.XX' (
RowsXX( ,
.XX, -
CountXX- 2
==XX3 5
$numXX6 7
;XX7 8
}YY 
catchZZ 
(ZZ 
	ExceptionZZ  
exZZ! #
)ZZ# $
{[[ 
log]] 
.]] 
Error]] 
(]] 
$str]] 4
,]]4 5
ex]]6 8
)]]8 9
;]]9 :
throw__ 
new__ 
	Exception__ '
(__' (
$str__( >
,__> ?
ex__@ B
)__B C
;__C D
}`` 
}aa 
}bb 	
publicdd 
booldd 
RecreateGoatDbdd "
(dd" #
)dd# $
{ee 	
logff 
.ff 
Infoff 
(ff 
$strff '
)ff' (
;ff( )
inthh 
retVal1hh 
=hh 
Mathhh 
.hh 
Abshh "
(hh" #
Utilhh# '
.hh' (
RunProcessWithInputhh( ;
(hh; <
_clientExechh< G
,hhG H
_dbFileNamehhI T
,hhT U
DbConstantshhV a
.hha b
DB_CREATE_SCRIPThhb r
)hhr s
)hhs t
;hht u
intii 
retVal2ii 
=ii 
Mathii 
.ii 
Absii "
(ii" #
Utilii# '
.ii' (
RunProcessWithInputii( ;
(ii; <
_clientExecii< G
,iiG H
_dbFileNameiiI T
,iiT U
DbConstantsiiV a
.iia b!
DB_LOAD_SQLITE_SCRIPTiib w
)iiw x
)iix y
;iiy z
returnkk 
Mathkk 
.kk 
Abskk 
(kk 
retVal1kk #
)kk# $
+kk% &
Mathkk' +
.kk+ ,
Abskk, /
(kk/ 0
retVal2kk0 7
)kk7 8
==kk9 ;
$numkk< =
;kk= >
}ll 	
publicoo 
stringoo 
CustomCustomerLoginoo )
(oo) *
stringoo* 0
emailoo1 6
,oo6 7
stringoo8 >
passwordoo? G
)ooG H
{pp 	
stringqq 
error_messageqq  
=qq! "
nullqq# '
;qq' (
tryrr 
{ss 
stringuu 
sqluu 
=uu 
$struu J
+uuK L
emailuuM R
+uuS T
$struuU Y
;uuY Z
usingww 
(ww 
SQLiteConnectionww '

connectionww( 2
=ww3 4
newww5 8
SQLiteConnectionww9 I
(wwI J
_connectionStringwwJ [
)ww[ \
)ww\ ]
{xx 
SQLiteDataAdapteryy %
dayy& (
=yy) *
newyy+ .
SQLiteDataAdapteryy/ @
(yy@ A
sqlyyA D
,yyD E

connectionyyF P
)yyP Q
;yyQ R
DataSetzz 
dszz 
=zz  
newzz! $
DataSetzz% ,
(zz, -
)zz- .
;zz. /
da{{ 
.{{ 
Fill{{ 
({{ 
ds{{ 
){{ 
;{{  
if~~ 
(~~ 
ds~~ 
.~~ 
Tables~~ !
[~~! "
$num~~" #
]~~# $
.~~$ %
Rows~~% )
.~~) *
Count~~* /
==~~0 2
$num~~3 4
)~~4 5
{ 
error_message
€€ %
=
€€& '
$str
€€( B
;
€€B C
return
 
error_message
 ,
;
, -
}
‚‚ 
string
„„ 
encoded_password
„„ +
=
„„, -
ds
„„. 0
.
„„0 1
Tables
„„1 7
[
„„7 8
$num
„„8 9
]
„„9 :
.
„„: ;
Rows
„„; ?
[
„„? @
$num
„„@ A
]
„„A B
[
„„B C
$str
„„C M
]
„„M N
.
„„N O
ToString
„„O W
(
„„W X
)
„„X Y
;
„„Y Z
string
…… 
decoded_password
…… +
=
……, -
Encoder
……. 5
.
……5 6
Decode
……6 <
(
……< =
encoded_password
……= M
)
……M N
;
……N O
if
‡‡ 
(
‡‡ 
password
‡‡  
.
‡‡  !
Trim
‡‡! %
(
‡‡% &
)
‡‡& '
.
‡‡' (
ToLower
‡‡( /
(
‡‡/ 0
)
‡‡0 1
!=
‡‡2 4
decoded_password
‡‡5 E
.
‡‡E F
Trim
‡‡F J
(
‡‡J K
)
‡‡K L
.
‡‡L M
ToLower
‡‡M T
(
‡‡T U
)
‡‡U V
)
‡‡V W
{
ˆˆ 
error_message
‰‰ %
=
‰‰& '
$str
‰‰( T
;
‰‰T U
}
ŠŠ 
else
‹‹ 
{
ŒŒ 
error_message
ŽŽ %
=
ŽŽ& '
null
ŽŽ( ,
;
ŽŽ, -
}
 
}
 
}
’’ 
catch
““ 
(
““ 
SQLiteException
““ "
ex
““# %
)
““% &
{
”” 
log
•• 
.
•• 
Error
•• 
(
•• 
$str
•• <
,
••< =
ex
••> @
)
••@ A
;
••A B
error_message
–– 
=
–– 
ex
––  "
.
––" #
Message
––# *
;
––* +
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
log
šš 
.
šš 
Error
šš 
(
šš 
$str
šš <
,
šš< =
ex
šš> @
)
šš@ A
;
ššA B
}
›› 
return
 
error_message
  
;
  !
}
žž 	
public
   
string
   
GetCustomerEmail
   &
(
  & '
string
  ' -
customerNumber
  . <
)
  < =
{
¡¡ 	
string
¢¢ 
output
¢¢ 
=
¢¢ 
null
¢¢  
;
¢¢  !
try
££ 
{
¤¤ 
using
¦¦ 
(
¦¦ 
SQLiteConnection
¦¦ '

connection
¦¦( 2
=
¦¦3 4
new
¦¦5 8
SQLiteConnection
¦¦9 I
(
¦¦I J
_connectionString
¦¦J [
)
¦¦[ \
)
¦¦\ ]
{
§§ 
string
¨¨ 
sql
¨¨ 
=
¨¨  
$str
¨¨! Z
+
¨¨[ \
customerNumber
¨¨] k
;
¨¨k l
SQLiteCommand
©© !
command
©©" )
=
©©* +
new
©©, /
SQLiteCommand
©©0 =
(
©©= >
sql
©©> A
,
©©A B

connection
©©C M
)
©©M N
;
©©N O
output
ªª 
=
ªª 
command
ªª $
.
ªª$ %
ExecuteScalar
ªª% 2
(
ªª2 3
)
ªª3 4
.
ªª4 5
ToString
ªª5 =
(
ªª= >
)
ªª> ?
;
ªª? @
}
«« 
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
output
¯¯ 
=
¯¯ 
ex
¯¯ 
.
¯¯ 
Message
¯¯ #
;
¯¯# $
}
°° 
return
±± 
output
±± 
;
±± 
}
²² 	
public
´´ 
DataSet
´´  
GetCustomerDetails
´´ )
(
´´) *
string
´´* 0
customerNumber
´´1 ?
)
´´? @
{
µµ 	
string
¶¶ 
sql
¶¶ 
=
¶¶ 
$str¶¶ £
+¶¶¤ ¥
$str·· 
+··ž Ÿ
$str¸¸ ¨
+¸¸© ª
$str¹¹ 
+¹¹Ž 
customerNumber¹¹ ž
;¹¹ž Ÿ
DataSet
»» 
ds
»» 
=
»» 
new
»» 
DataSet
»» $
(
»»$ %
)
»»% &
;
»»& '
try
¼¼ 
{
½½ 
using
¿¿ 
(
¿¿ 
SQLiteConnection
¿¿ '

connection
¿¿( 2
=
¿¿3 4
new
¿¿5 8
SQLiteConnection
¿¿9 I
(
¿¿I J
_connectionString
¿¿J [
)
¿¿[ \
)
¿¿\ ]
{
ÀÀ 
SQLiteDataAdapter
ÁÁ %
da
ÁÁ& (
=
ÁÁ) *
new
ÁÁ+ .
SQLiteDataAdapter
ÁÁ/ @
(
ÁÁ@ A
sql
ÁÁA D
,
ÁÁD E

connection
ÁÁF P
)
ÁÁP Q
;
ÁÁQ R
da
ÂÂ 
.
ÂÂ 
Fill
ÂÂ 
(
ÂÂ 
ds
ÂÂ 
)
ÂÂ 
;
ÂÂ  
}
ÃÃ 
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
ex
ÆÆ 
)
ÆÆ  
{
ÇÇ 
log
ÈÈ 
.
ÈÈ 
Error
ÈÈ 
(
ÈÈ 
$str
ÈÈ :
,
ÈÈ: ;
ex
ÈÈ< >
)
ÈÈ> ?
;
ÈÈ? @
throw
ÊÊ 
new
ÊÊ "
ApplicationException
ÊÊ .
(
ÊÊ. /
$str
ÊÊ/ O
,
ÊÊO P
ex
ÊÊQ S
)
ÊÊS T
;
ÊÊT U
}
ËË 
return
ÌÌ 
ds
ÌÌ 
;
ÌÌ 
}
ÎÎ 	
public
ÐÐ 
DataSet
ÐÐ 
	GetOffice
ÐÐ  
(
ÐÐ  !
string
ÐÐ! '
city
ÐÐ( ,
)
ÐÐ, -
{
ÑÑ 	
using
ÓÓ 
(
ÓÓ 
SQLiteConnection
ÓÓ #

connection
ÓÓ$ .
=
ÓÓ/ 0
new
ÓÓ1 4
SQLiteConnection
ÓÓ5 E
(
ÓÓE F
_connectionString
ÓÓF W
)
ÓÓW X
)
ÓÓX Y
{
ÔÔ 
string
ÕÕ 
sql
ÕÕ 
=
ÕÕ 
$str
ÕÕ G
;
ÕÕG H
SQLiteDataAdapter
ÖÖ !
da
ÖÖ" $
=
ÖÖ% &
new
ÖÖ' *
SQLiteDataAdapter
ÖÖ+ <
(
ÖÖ< =
sql
ÖÖ= @
,
ÖÖ@ A

connection
ÖÖB L
)
ÖÖL M
;
ÖÖM N
da
×× 
.
×× 
SelectCommand
××  
.
××  !

Parameters
××! +
.
××+ ,
AddWithValue
××, 8
(
××8 9
$str
××9 @
,
××@ A
city
××B F
)
××F G
;
××G H
DataSet
ØØ 
ds
ØØ 
=
ØØ 
new
ØØ  
DataSet
ØØ! (
(
ØØ( )
)
ØØ) *
;
ØØ* +
da
ÙÙ 
.
ÙÙ 
Fill
ÙÙ 
(
ÙÙ 
ds
ÙÙ 
)
ÙÙ 
;
ÙÙ 
return
ÚÚ 
ds
ÚÚ 
;
ÚÚ 
}
ÛÛ 
}
ÜÜ 	
public
ÞÞ 
DataSet
ÞÞ 
GetComments
ÞÞ "
(
ÞÞ" #
string
ÞÞ# )
productCode
ÞÞ* 5
)
ÞÞ5 6
{
ßß 	
using
àà 
(
àà 
SQLiteConnection
àà #

connection
àà$ .
=
àà/ 0
new
àà1 4
SQLiteConnection
àà5 E
(
ààE F
_connectionString
ààF W
)
ààW X
)
ààX Y
{
áá 
string
ââ 
sql
ââ 
=
ââ 
$str
ââ V
;
ââV W
SQLiteDataAdapter
ãã !
da
ãã" $
=
ãã% &
new
ãã' *
SQLiteDataAdapter
ãã+ <
(
ãã< =
sql
ãã= @
,
ãã@ A

connection
ããB L
)
ããL M
;
ããM N
da
ää 
.
ää 
SelectCommand
ää  
.
ää  !

Parameters
ää! +
.
ää+ ,
AddWithValue
ää, 8
(
ää8 9
$str
ää9 G
,
ääG H
productCode
ääI T
)
ääT U
;
ääU V
DataSet
åå 
ds
åå 
=
åå 
new
åå  
DataSet
åå! (
(
åå( )
)
åå) *
;
åå* +
da
ææ 
.
ææ 
Fill
ææ 
(
ææ 
ds
ææ 
)
ææ 
;
ææ 
return
çç 
ds
çç 
;
çç 
}
èè 
}
éé 	
public
ëë 
string
ëë 

AddComment
ëë  
(
ëë  !
string
ëë! '
productCode
ëë( 3
,
ëë3 4
string
ëë5 ;
email
ëë< A
,
ëëA B
string
ëëC I
comment
ëëJ Q
)
ëëQ R
{
ìì 	
string
íí 
sql
íí 
=
íí 
$str
íí V
+
ííW X
productCode
ííY d
+
ííe f
$str
ííg l
+
íím n
email
íío t
+
ííu v
$str
ííw |
+
íí} ~
commentíí †
+íí‡ ˆ
$stríí‰ Ž
;ííŽ 
string
îî 
output
îî 
=
îî 
null
îî  
;
îî  !
try
ðð 
{
ññ 
using
óó 
(
óó 
SQLiteConnection
óó '

connection
óó( 2
=
óó3 4
new
óó5 8
SQLiteConnection
óó9 I
(
óóI J
_connectionString
óóJ [
)
óó[ \
)
óó\ ]
{
ôô 
SQLiteCommand
õõ !
command
õõ" )
=
õõ* +
new
õõ, /
SQLiteCommand
õõ0 =
(
õõ= >
sql
õõ> A
,
õõA B

connection
õõC M
)
õõM N
;
õõN O
command
öö 
.
öö 
ExecuteNonQuery
öö +
(
öö+ ,
)
öö, -
;
öö- .
}
÷÷ 
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
log
ûû 
.
ûû 
Error
ûû 
(
ûû 
$str
ûû 0
,
ûû0 1
ex
ûû2 4
)
ûû4 5
;
ûû5 6
output
üü 
=
üü 
ex
üü 
.
üü 
Message
üü #
;
üü# $
}
ýý 
return
ÿÿ 
output
ÿÿ 
;
ÿÿ 
}
€€ 	
public
‚‚ 
string
‚‚ $
UpdateCustomerPassword
‚‚ ,
(
‚‚, -
int
‚‚- 0
customerNumber
‚‚1 ?
,
‚‚? @
string
‚‚A G
password
‚‚H P
)
‚‚P Q
{
ƒƒ 	
string
„„ 
sql
„„ 
=
„„ 
$str
„„ @
+
„„A B
Encoder
„„C J
.
„„J K
Encode
„„K Q
(
„„Q R
password
„„R Z
)
„„Z [
+
„„\ ]
$str
„„^ y
+
„„z {
customerNumber„„| Š
;„„Š ‹
string
…… 
output
…… 
=
…… 
null
……  
;
……  !
try
†† 
{
‡‡ 
using
‰‰ 
(
‰‰ 
SQLiteConnection
‰‰ '

connection
‰‰( 2
=
‰‰3 4
new
‰‰5 8
SQLiteConnection
‰‰9 I
(
‰‰I J
_connectionString
‰‰J [
)
‰‰[ \
)
‰‰\ ]
{
ŠŠ 
SQLiteCommand
‹‹ !
command
‹‹" )
=
‹‹* +
new
‹‹, /
SQLiteCommand
‹‹0 =
(
‹‹= >
sql
‹‹> A
,
‹‹A B

connection
‹‹C M
)
‹‹M N
;
‹‹N O
int
 

rows_added
 "
=
# $
command
% ,
.
, -
ExecuteNonQuery
- <
(
< =
)
= >
;
> ?
log
 
.
 
Info
 
(
 
$str
 +
+
, -

rows_added
. 8
+
9 :
$str
; N
)
N O
;
O P
}
 
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
log
”” 
.
”” 
Error
”” 
(
”” 
$str
”” <
,
””< =
ex
””> @
)
””@ A
;
””A B
output
•• 
=
•• 
ex
•• 
.
•• 
Message
•• #
;
••# $
}
–– 
return
—— 
output
—— 
;
—— 
}
˜˜ 	
public
šš 
string
šš 
[
šš 
]
šš *
GetSecurityQuestionAndAnswer
šš 4
(
šš4 5
string
šš5 ;
email
šš< A
)
ššA B
{
›› 	
string
œœ 
sql
œœ 
=
œœ 
$str
œœ l
+
œœm n
$str
 A
+
B C
email
D I
+
J K
$str
L p
+
q r
$str
žž 0
;
žž0 1
string
   
[
   
]
   
qAndA
   
=
   
new
    
string
  ! '
[
  ' (
$num
  ( )
]
  ) *
;
  * +
using
¢¢ 
(
¢¢ 
SQLiteConnection
¢¢ #

connection
¢¢$ .
=
¢¢/ 0
new
¢¢1 4
SQLiteConnection
¢¢5 E
(
¢¢E F
_connectionString
¢¢F W
)
¢¢W X
)
¢¢X Y
{
££ 
SQLiteDataAdapter
¤¤ !
da
¤¤" $
=
¤¤% &
new
¤¤' *
SQLiteDataAdapter
¤¤+ <
(
¤¤< =
sql
¤¤= @
,
¤¤@ A

connection
¤¤B L
)
¤¤L M
;
¤¤M N
DataSet
¦¦ 
ds
¦¦ 
=
¦¦ 
new
¦¦  
DataSet
¦¦! (
(
¦¦( )
)
¦¦) *
;
¦¦* +
da
§§ 
.
§§ 
Fill
§§ 
(
§§ 
ds
§§ 
)
§§ 
;
§§ 
if
©© 
(
©© 
ds
©© 
.
©© 
Tables
©© 
[
©© 
$num
©© 
]
©©  
.
©©  !
Rows
©©! %
.
©©% &
Count
©©& +
>
©©, -
$num
©©. /
)
©©/ 0
{
ªª 
DataRow
«« 
row
«« 
=
««  !
ds
««" $
.
««$ %
Tables
««% +
[
««+ ,
$num
««, -
]
««- .
.
««. /
Rows
««/ 3
[
««3 4
$num
««4 5
]
««5 6
;
««6 7
qAndA
¬¬ 
[
¬¬ 
$num
¬¬ 
]
¬¬ 
=
¬¬ 
row
¬¬ "
[
¬¬" #
$num
¬¬# $
]
¬¬$ %
.
¬¬% &
ToString
¬¬& .
(
¬¬. /
)
¬¬/ 0
;
¬¬0 1
qAndA
­­ 
[
­­ 
$num
­­ 
]
­­ 
=
­­ 
row
­­ "
[
­­" #
$num
­­# $
]
­­$ %
.
­­% &
ToString
­­& .
(
­­. /
)
­­/ 0
;
­­0 1
}
®® 
}
¯¯ 
return
±± 
qAndA
±± 
;
±± 
}
²² 	
public
´´ 
string
´´  
GetPasswordByEmail
´´ (
(
´´( )
string
´´) /
email
´´0 5
)
´´5 6
{
µµ 	
string
¶¶ 
result
¶¶ 
=
¶¶ 
string
¶¶ "
.
¶¶" #
Empty
¶¶# (
;
¶¶( )
try
·· 
{
¸¸ 
using
ºº 
(
ºº 
SQLiteConnection
ºº '

connection
ºº( 2
=
ºº3 4
new
ºº5 8
SQLiteConnection
ºº9 I
(
ººI J
_connectionString
ººJ [
)
ºº[ \
)
ºº\ ]
{
»» 
string
½½ 
sql
½½ 
=
½½  
$str
½½! N
+
½½O P
email
½½Q V
+
½½W X
$str
½½Y ]
;
½½] ^
SQLiteDataAdapter
¾¾ %
da
¾¾& (
=
¾¾) *
new
¾¾+ .
SQLiteDataAdapter
¾¾/ @
(
¾¾@ A
sql
¾¾A D
,
¾¾D E

connection
¾¾F P
)
¾¾P Q
;
¾¾Q R
DataSet
¿¿ 
ds
¿¿ 
=
¿¿  
new
¿¿! $
DataSet
¿¿% ,
(
¿¿, -
)
¿¿- .
;
¿¿. /
da
ÀÀ 
.
ÀÀ 
Fill
ÀÀ 
(
ÀÀ 
ds
ÀÀ 
)
ÀÀ 
;
ÀÀ  
if
ÃÃ 
(
ÃÃ 
ds
ÃÃ 
.
ÃÃ 
Tables
ÃÃ !
[
ÃÃ! "
$num
ÃÃ" #
]
ÃÃ# $
.
ÃÃ$ %
Rows
ÃÃ% )
.
ÃÃ) *
Count
ÃÃ* /
==
ÃÃ0 2
$num
ÃÃ3 4
)
ÃÃ4 5
{
ÄÄ 
result
ÅÅ 
=
ÅÅ  
$str
ÅÅ! ;
;
ÅÅ; <
}
ÆÆ 
string
ÈÈ 
encoded_password
ÈÈ +
=
ÈÈ, -
ds
ÈÈ. 0
.
ÈÈ0 1
Tables
ÈÈ1 7
[
ÈÈ7 8
$num
ÈÈ8 9
]
ÈÈ9 :
.
ÈÈ: ;
Rows
ÈÈ; ?
[
ÈÈ? @
$num
ÈÈ@ A
]
ÈÈA B
[
ÈÈB C
$str
ÈÈC M
]
ÈÈM N
.
ÈÈN O
ToString
ÈÈO W
(
ÈÈW X
)
ÈÈX Y
;
ÈÈY Z
string
ÉÉ 
decoded_password
ÉÉ +
=
ÉÉ, -
Encoder
ÉÉ. 5
.
ÉÉ5 6
Decode
ÉÉ6 <
(
ÉÉ< =
encoded_password
ÉÉ= M
)
ÉÉM N
;
ÉÉN O
result
ÊÊ 
=
ÊÊ 
decoded_password
ÊÊ -
;
ÊÊ- .
}
ËË 
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 
result
ÏÏ 
=
ÏÏ 
ex
ÏÏ 
.
ÏÏ 
Message
ÏÏ #
;
ÏÏ# $
}
ÐÐ 
return
ÑÑ 
result
ÑÑ 
;
ÑÑ 
}
ÒÒ 	
public
ÔÔ 
DataSet
ÔÔ 
GetUsers
ÔÔ 
(
ÔÔ  
)
ÔÔ  !
{
ÕÕ 	
using
ÖÖ 
(
ÖÖ 
SQLiteConnection
ÖÖ #

connection
ÖÖ$ .
=
ÖÖ/ 0
new
ÖÖ1 4
SQLiteConnection
ÖÖ5 E
(
ÖÖE F
_connectionString
ÖÖF W
)
ÖÖW X
)
ÖÖX Y
{
×× 
string
ØØ 
sql
ØØ 
=
ØØ 
$str
ØØ ;
;
ØØ; <
SQLiteDataAdapter
ÙÙ !
da
ÙÙ" $
=
ÙÙ% &
new
ÙÙ' *
SQLiteDataAdapter
ÙÙ+ <
(
ÙÙ< =
sql
ÙÙ= @
,
ÙÙ@ A

connection
ÙÙB L
)
ÙÙL M
;
ÙÙM N
DataSet
ÚÚ 
ds
ÚÚ 
=
ÚÚ 
new
ÚÚ  
DataSet
ÚÚ! (
(
ÚÚ( )
)
ÚÚ) *
;
ÚÚ* +
da
ÛÛ 
.
ÛÛ 
Fill
ÛÛ 
(
ÛÛ 
ds
ÛÛ 
)
ÛÛ 
;
ÛÛ 
return
ÜÜ 
ds
ÜÜ 
;
ÜÜ 
}
ÝÝ 
}
ÞÞ 	
public
àà 
DataSet
àà 
	GetOrders
àà  
(
àà  !
int
àà! $

customerID
àà% /
)
àà/ 0
{
áá 	
using
ãã 
(
ãã 
SQLiteConnection
ãã #

connection
ãã$ .
=
ãã/ 0
new
ãã1 4
SQLiteConnection
ãã5 E
(
ããE F
_connectionString
ããF W
)
ããW X
)
ããX Y
{
ää 
string
åå 
sql
åå 
=
åå 
$str
åå K
+
ååL M

customerID
ååN X
;
ååX Y
SQLiteDataAdapter
ææ !
da
ææ" $
=
ææ% &
new
ææ' *
SQLiteDataAdapter
ææ+ <
(
ææ< =
sql
ææ= @
,
ææ@ A

connection
ææB L
)
ææL M
;
ææM N
DataSet
çç 
ds
çç 
=
çç 
new
çç  
DataSet
çç! (
(
çç( )
)
çç) *
;
çç* +
da
èè 
.
èè 
Fill
èè 
(
èè 
ds
èè 
)
èè 
;
èè 
if
êê 
(
êê 
ds
êê 
.
êê 
Tables
êê 
[
êê 
$num
êê 
]
êê  
.
êê  !
Rows
êê! %
.
êê% &
Count
êê& +
==
êê, .
$num
êê/ 0
)
êê0 1
return
ëë 
null
ëë 
;
ëë  
else
ìì 
return
íí 
ds
íí 
;
íí 
}
îî 
}
ïï 	
public
ññ 
DataSet
ññ 
GetProductDetails
ññ (
(
ññ( )
string
ññ) /
productCode
ññ0 ;
)
ññ; <
{
òò 	
string
óó 
sql
óó 
=
óó 
string
óó 
.
óó  
Empty
óó  %
;
óó% &
SQLiteDataAdapter
ôô 
da
ôô  
;
ôô  !
DataSet
õõ 
ds
õõ 
=
õõ 
new
õõ 
DataSet
õõ $
(
õõ$ %
)
õõ% &
;
õõ& '
using
øø 
(
øø 
SQLiteConnection
øø #

connection
øø$ .
=
øø/ 0
new
øø1 4
SQLiteConnection
øø5 E
(
øøE F
_connectionString
øøF W
)
øøW X
)
øøX Y
{
ùù 
sql
úú 
=
úú 
$str
úú D
+
úúE F
productCode
úúG R
+
úúS T
$str
úúU X
;
úúX Y
da
ûû 
=
ûû 
new
ûû 
SQLiteDataAdapter
ûû *
(
ûû* +
sql
ûû+ .
,
ûû. /

connection
ûû0 :
)
ûû: ;
;
ûû; <
da
üü 
.
üü 
Fill
üü 
(
üü 
ds
üü 
,
üü 
$str
üü &
)
üü& '
;
üü' (
sql
þþ 
=
þþ 
$str
þþ D
+
þþE F
productCode
þþG R
+
þþS T
$str
þþU X
;
þþX Y
da
ÿÿ 
=
ÿÿ 
new
ÿÿ 
SQLiteDataAdapter
ÿÿ *
(
ÿÿ* +
sql
ÿÿ+ .
,
ÿÿ. /

connection
ÿÿ0 :
)
ÿÿ: ;
;
ÿÿ; <
da
€€ 
.
€€ 
Fill
€€ 
(
€€ 
ds
€€ 
,
€€ 
$str
€€ &
)
€€& '
;
€€' (
DataRelation
‚‚ 
dr
‚‚ 
=
‚‚  !
new
‚‚" %
DataRelation
‚‚& 2
(
‚‚2 3
$str
‚‚3 B
,
‚‚B C
ds
ƒƒ 
.
ƒƒ 
Tables
ƒƒ 
[
ƒƒ 
$str
ƒƒ $
]
ƒƒ$ %
.
ƒƒ% &
Columns
ƒƒ& -
[
ƒƒ- .
$str
ƒƒ. ;
]
ƒƒ; <
,
ƒƒ< =
ds
„„ 
.
„„ 
Tables
„„ 
[
„„ 
$str
„„ $
]
„„$ %
.
„„% &
Columns
„„& -
[
„„- .
$str
„„. ;
]
„„; <
,
„„< =
false
…… 
)
…… 
;
…… 
ds
‡‡ 
.
‡‡ 
	Relations
‡‡ 
.
‡‡ 
Add
‡‡  
(
‡‡  !
dr
‡‡! #
)
‡‡# $
;
‡‡$ %
return
ˆˆ 
ds
ˆˆ 
;
ˆˆ 
}
‰‰ 
}
ŠŠ 	
public
ŒŒ 
DataSet
ŒŒ 
GetOrderDetails
ŒŒ &
(
ŒŒ& '
int
ŒŒ' *
orderNumber
ŒŒ+ 6
)
ŒŒ6 7
{
 	
string
 
sql
 
=
 
$str
 {
+
| }
$str
 ^
+
_ `
$str
‘‘ G
+
‘‘H I
$str
’’ C
+
’’D E
$str
““ F
+
““G H
$str
”” D
+
””E F
$str
•• 1
+
••2 3
orderNumber
••4 ?
;
••? @
using
˜˜ 
(
˜˜ 
SQLiteConnection
˜˜ #

connection
˜˜$ .
=
˜˜/ 0
new
˜˜1 4
SQLiteConnection
˜˜5 E
(
˜˜E F
_connectionString
˜˜F W
)
˜˜W X
)
˜˜X Y
{
™™ 
SQLiteDataAdapter
šš !
da
šš" $
=
šš% &
new
šš' *
SQLiteDataAdapter
šš+ <
(
šš< =
sql
šš= @
,
šš@ A

connection
ššB L
)
ššL M
;
ššM N
DataSet
›› 
ds
›› 
=
›› 
new
››  
DataSet
››! (
(
››( )
)
››) *
;
››* +
da
œœ 
.
œœ 
Fill
œœ 
(
œœ 
ds
œœ 
)
œœ 
;
œœ 
if
žž 
(
žž 
ds
žž 
.
žž 
Tables
žž 
[
žž 
$num
žž 
]
žž  
.
žž  !
Rows
žž! %
.
žž% &
Count
žž& +
==
žž, .
$num
žž/ 0
)
žž0 1
return
ŸŸ 
null
ŸŸ 
;
ŸŸ  
else
   
return
¡¡ 
ds
¡¡ 
;
¡¡ 
}
¢¢ 
}
££ 	
public
¥¥ 
DataSet
¥¥ 
GetPayments
¥¥ "
(
¥¥" #
int
¥¥# &
customerNumber
¥¥' 5
)
¥¥5 6
{
¦¦ 	
using
§§ 
(
§§ 
SQLiteConnection
§§ #

connection
§§$ .
=
§§/ 0
new
§§1 4
SQLiteConnection
§§5 E
(
§§E F
_connectionString
§§F W
)
§§W X
)
§§X Y
{
¨¨ 
string
©© 
sql
©© 
=
©© 
$str
©© M
+
©©N O
customerNumber
©©P ^
;
©©^ _
SQLiteDataAdapter
ªª !
da
ªª" $
=
ªª% &
new
ªª' *
SQLiteDataAdapter
ªª+ <
(
ªª< =
sql
ªª= @
,
ªª@ A

connection
ªªB L
)
ªªL M
;
ªªM N
DataSet
«« 
ds
«« 
=
«« 
new
««  
DataSet
««! (
(
««( )
)
««) *
;
««* +
da
¬¬ 
.
¬¬ 
Fill
¬¬ 
(
¬¬ 
ds
¬¬ 
)
¬¬ 
;
¬¬ 
if
®® 
(
®® 
ds
®® 
.
®® 
Tables
®® 
[
®® 
$num
®® 
]
®®  
.
®®  !
Rows
®®! %
.
®®% &
Count
®®& +
==
®®, .
$num
®®/ 0
)
®®0 1
return
¯¯ 
null
¯¯ 
;
¯¯  
else
°° 
return
±± 
ds
±± 
;
±± 
}
²² 
}
³³ 	
public
µµ 
DataSet
µµ &
GetProductsAndCategories
µµ /
(
µµ/ 0
)
µµ0 1
{
¶¶ 	
return
·· &
GetProductsAndCategories
·· +
(
··+ ,
$num
··, -
)
··- .
;
··. /
}
¸¸ 	
public
ºº 
DataSet
ºº &
GetProductsAndCategories
ºº /
(
ºº/ 0
int
ºº0 3
	catNumber
ºº4 =
)
ºº= >
{
»» 	
string
½½ 
sql
½½ 
=
½½ 
string
½½ 
.
½½  
Empty
½½  %
;
½½% &
SQLiteDataAdapter
¾¾ 
da
¾¾  
;
¾¾  !
DataSet
¿¿ 
ds
¿¿ 
=
¿¿ 
new
¿¿ 
DataSet
¿¿ $
(
¿¿$ %
)
¿¿% &
;
¿¿& '
string
ÂÂ 
	catClause
ÂÂ 
=
ÂÂ 
string
ÂÂ %
.
ÂÂ% &
Empty
ÂÂ& +
;
ÂÂ+ ,
if
ÃÃ 
(
ÃÃ 
	catNumber
ÃÃ 
>=
ÃÃ 
$num
ÃÃ 
)
ÃÃ 
	catClause
ÄÄ 
+=
ÄÄ 
$str
ÄÄ 2
+
ÄÄ3 4
	catNumber
ÄÄ5 >
;
ÄÄ> ?
using
ÇÇ 
(
ÇÇ 
SQLiteConnection
ÇÇ #

connection
ÇÇ$ .
=
ÇÇ/ 0
new
ÇÇ1 4
SQLiteConnection
ÇÇ5 E
(
ÇÇE F
_connectionString
ÇÇF W
)
ÇÇW X
)
ÇÇX Y
{
ÈÈ 
sql
ÊÊ 
=
ÊÊ 
$str
ÊÊ 0
+
ÊÊ1 2
	catClause
ÊÊ3 <
;
ÊÊ< =
da
ËË 
=
ËË 
new
ËË 
SQLiteDataAdapter
ËË *
(
ËË* +
sql
ËË+ .
,
ËË. /

connection
ËË0 :
)
ËË: ;
;
ËË; <
da
ÌÌ 
.
ÌÌ 
Fill
ÌÌ 
(
ÌÌ 
ds
ÌÌ 
,
ÌÌ 
$str
ÌÌ (
)
ÌÌ( )
;
ÌÌ) *
sql
ÎÎ 
=
ÎÎ 
$str
ÎÎ .
+
ÎÎ/ 0
	catClause
ÎÎ1 :
;
ÎÎ: ;
da
ÏÏ 
=
ÏÏ 
new
ÏÏ 
SQLiteDataAdapter
ÏÏ *
(
ÏÏ* +
sql
ÏÏ+ .
,
ÏÏ. /

connection
ÏÏ0 :
)
ÏÏ: ;
;
ÏÏ; <
da
ÐÐ 
.
ÐÐ 
Fill
ÐÐ 
(
ÐÐ 
ds
ÐÐ 
,
ÐÐ 
$str
ÐÐ &
)
ÐÐ& '
;
ÐÐ' (
DataRelation
ÔÔ 
dr
ÔÔ 
=
ÔÔ  !
new
ÔÔ" %
DataRelation
ÔÔ& 2
(
ÔÔ2 3
$str
ÔÔ3 >
,
ÔÔ> ?
ds
ÕÕ 
.
ÕÕ 
Tables
ÕÕ 
[
ÕÕ 
$str
ÕÕ &
]
ÕÕ& '
.
ÕÕ' (
Columns
ÕÕ( /
[
ÕÕ/ 0
$str
ÕÕ0 ;
]
ÕÕ; <
,
ÕÕ< =
ds
ÖÖ 
.
ÖÖ 
Tables
ÖÖ 
[
ÖÖ 
$str
ÖÖ $
]
ÖÖ$ %
.
ÖÖ% &
Columns
ÖÖ& -
[
ÖÖ- .
$str
ÖÖ. 9
]
ÖÖ9 :
,
ÖÖ: ;
false
×× 
)
×× 
;
×× 
ds
ÙÙ 
.
ÙÙ 
	Relations
ÙÙ 
.
ÙÙ 
Add
ÙÙ  
(
ÙÙ  !
dr
ÙÙ! #
)
ÙÙ# $
;
ÙÙ$ %
return
ÚÚ 
ds
ÚÚ 
;
ÚÚ 
}
ÛÛ 
}
ÜÜ 	
public
ÞÞ 
DataSet
ÞÞ 
GetEmailByName
ÞÞ %
(
ÞÞ% &
string
ÞÞ& ,
name
ÞÞ- 1
)
ÞÞ1 2
{
ßß 	
string
àà 
sql
àà 
=
àà 
$str
àà b
+
ààc d
name
ààe i
+
ààj k
$strààl ƒ
+àà„ …
nameàà† Š
+àà‹ Œ
$stràà ‘
;àà‘ ’
using
ãã 
(
ãã 
SQLiteConnection
ãã #

connection
ãã$ .
=
ãã/ 0
new
ãã1 4
SQLiteConnection
ãã5 E
(
ããE F
_connectionString
ããF W
)
ããW X
)
ããX Y
{
ää 
SQLiteDataAdapter
åå !
da
åå" $
=
åå% &
new
åå' *
SQLiteDataAdapter
åå+ <
(
åå< =
sql
åå= @
,
åå@ A

connection
ååB L
)
ååL M
;
ååM N
DataSet
ææ 
ds
ææ 
=
ææ 
new
ææ  
DataSet
ææ! (
(
ææ( )
)
ææ) *
;
ææ* +
da
çç 
.
çç 
Fill
çç 
(
çç 
ds
çç 
)
çç 
;
çç 
if
éé 
(
éé 
ds
éé 
.
éé 
Tables
éé 
[
éé 
$num
éé 
]
éé  
.
éé  !
Rows
éé! %
.
éé% &
Count
éé& +
==
éé, .
$num
éé/ 0
)
éé0 1
return
êê 
null
êê 
;
êê  
else
ëë 
return
ìì 
ds
ìì 
;
ìì 
}
íí 
}
îî 	
public
ðð 
string
ðð &
GetEmailByCustomerNumber
ðð .
(
ðð. /
string
ðð/ 5
num
ðð6 9
)
ðð9 :
{
ññ 	
string
òò 
output
òò 
=
òò 
$str
òò 
;
òò 
try
óó 
{
ôô 
using
öö 
(
öö 
SQLiteConnection
öö '

connection
öö( 2
=
öö3 4
new
öö5 8
SQLiteConnection
öö9 I
(
ööI J
_connectionString
ööJ [
)
öö[ \
)
öö\ ]
{
÷÷ 
string
øø 
sql
øø 
=
øø  
$str
øø! Z
+
øø[ \
num
øø] `
;
øø` a
SQLiteCommand
ùù !
cmd
ùù" %
=
ùù& '
new
ùù( +
SQLiteCommand
ùù, 9
(
ùù9 :
sql
ùù: =
,
ùù= >

connection
ùù? I
)
ùùI J
;
ùùJ K
output
úú 
=
úú 
(
úú 
string
úú $
)
úú$ %
cmd
úú% (
.
úú( )
ExecuteScalar
úú) 6
(
úú6 7
)
úú7 8
;
úú8 9
}
ûû 
}
ýý 
catch
þþ 
(
þþ 
	Exception
þþ 
ex
þþ 
)
þþ  
{
ÿÿ 
log
€€ 
.
€€ 
Error
€€ 
(
€€ 
$str
€€ B
,
€€B C
ex
€€D F
)
€€F G
;
€€G H
output
 
=
 
ex
 
.
 
Message
 #
;
# $
}
‚‚ 
return
„„ 
output
„„ 
;
„„ 
}
…… 	
public
‡‡ 
DataSet
‡‡ 
GetCustomerEmails
‡‡ (
(
‡‡( )
string
‡‡) /
email
‡‡0 5
)
‡‡5 6
{
ˆˆ 	
string
‰‰ 
sql
‰‰ 
=
‰‰ 
$str
‰‰ M
+
‰‰N O
email
‰‰P U
+
‰‰V W
$str
‰‰X \
;
‰‰\ ]
using
ŒŒ 
(
ŒŒ 
SQLiteConnection
ŒŒ #

connection
ŒŒ$ .
=
ŒŒ/ 0
new
ŒŒ1 4
SQLiteConnection
ŒŒ5 E
(
ŒŒE F
_connectionString
ŒŒF W
)
ŒŒW X
)
ŒŒX Y
{
 
SQLiteDataAdapter
ŽŽ !
da
ŽŽ" $
=
ŽŽ% &
new
ŽŽ' *
SQLiteDataAdapter
ŽŽ+ <
(
ŽŽ< =
sql
ŽŽ= @
,
ŽŽ@ A

connection
ŽŽB L
)
ŽŽL M
;
ŽŽM N
DataSet
 
ds
 
=
 
new
  
DataSet
! (
(
( )
)
) *
;
* +
da
 
.
 
Fill
 
(
 
ds
 
)
 
;
 
if
’’ 
(
’’ 
ds
’’ 
.
’’ 
Tables
’’ 
[
’’ 
$num
’’ 
]
’’  
.
’’  !
Rows
’’! %
.
’’% &
Count
’’& +
==
’’, .
$num
’’/ 0
)
’’0 1
return
““ 
null
““ 
;
““  
else
”” 
return
•• 
ds
•• 
;
•• 
}
–– 
}
—— 	
}
™™ 
}šš Øð
AC:\work\code\OWASP-WebGoat\WebGoat\App_Code\DB\MySqlDbProvider.cs
	namespace

 	
OWASP


 
.

 
WebGoat

 
.

 
NET

 
.

 
App_Code

 $
.

$ %
DB

% '
{ 
public 

class 
MySqlDbProvider  
:! "
IDbProvider# .
{ 
private 
readonly 
string 
_connectionString  1
;1 2
private 
readonly 
string 
_host  %
;% &
private 
readonly 
string 
_port  %
;% &
private 
readonly 
string 
_pwd  $
;$ %
private 
readonly 
string 
_uid  $
;$ %
private 
readonly 
string 
	_database  )
;) *
private 
readonly 
string 
_clientExec  +
;+ ,
private 
readonly 
ILog 
log !
=" #

LogManager$ .
.. /
	GetLogger/ 8
(8 9

MethodBase9 C
.C D
GetCurrentMethodD T
(T U
)U V
.V W
DeclaringTypeW d
)d e
;e f
public 
MySqlDbProvider 
( 

ConfigFile )

configFile* 4
)4 5
{ 	
if 
( 

configFile 
== 
null "
)" #
_connectionString !
=" #
string$ *
.* +
Empty+ 0
;0 1
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &

configFile& 0
.0 1
Get1 4
(4 5
DbConstants5 @
.@ A
KEY_PWDA H
)H I
)I J
)J K
{ 
_connectionString !
=" #
string$ *
.* +
Format+ 1
(1 2
$str2 d
,d e

configFile  2 <
.  < =
Get  = @
(  @ A
DbConstants  A L
.  L M
KEY_HOST  M U
)  U V
,  V W

configFile!!2 <
.!!< =
Get!!= @
(!!@ A
DbConstants!!A L
.!!L M
KEY_PORT!!M U
)!!U V
,!!V W

configFile""2 <
.""< =
Get""= @
(""@ A
DbConstants""A L
.""L M
KEY_DATABASE""M Y
)""Y Z
,""Z [

configFile##2 <
.##< =
Get##= @
(##@ A
DbConstants##A L
.##L M
KEY_UID##M T
)##T U
,##U V

configFile$$2 <
.$$< =
Get$$= @
($$@ A
DbConstants$$A L
.$$L M
KEY_PWD$$M T
)$$T U
)$$U V
;$$V W
}%% 
else&& 
{'' 
_connectionString(( "
=((# $
string((% +
.((+ ,
Format((, 2
(((2 3
$str((3 ]
,((] ^

configFile))2 <
.))< =
Get))= @
())@ A
DbConstants))A L
.))L M
KEY_HOST))M U
)))U V
,))V W

configFile**2 <
.**< =
Get**= @
(**@ A
DbConstants**A L
.**L M
KEY_PORT**M U
)**U V
,**V W

configFile++2 <
.++< =
Get++= @
(++@ A
DbConstants++A L
.++L M
KEY_DATABASE++M Y
)++Y Z
,++Z [

configFile,,2 <
.,,< =
Get,,= @
(,,@ A
DbConstants,,A L
.,,L M
KEY_UID,,M T
),,T U
),,U V
;,,V W
}-- 
_uid// 
=// 

configFile// 
.// 
Get// !
(//! "
DbConstants//" -
.//- .
KEY_UID//. 5
)//5 6
;//6 7
_pwd00 
=00 

configFile00 
.00 
Get00 !
(00! "
DbConstants00" -
.00- .
KEY_PWD00. 5
)005 6
;006 7
	_database11 
=11 

configFile11 "
.11" #
Get11# &
(11& '
DbConstants11' 2
.112 3
KEY_DATABASE113 ?
)11? @
;11@ A
_host22 
=22 

configFile22 
.22 
Get22 "
(22" #
DbConstants22# .
.22. /
KEY_HOST22/ 7
)227 8
;228 9
_clientExec33 
=33 

configFile33 $
.33$ %
Get33% (
(33( )
DbConstants33) 4
.334 5
KEY_CLIENT_EXEC335 D
)33D E
;33E F
_port44 
=44 

configFile44 
.44 
Get44 "
(44" #
DbConstants44# .
.44. /
KEY_PORT44/ 7
)447 8
;448 9
}55 	
public77 
string77 
Name77 
{77 
get77  
{77! "
return77# )
DbConstants77* 5
.775 6
DB_TYPE_MYSQL776 C
;77C D
}77E F
}77G H
public:: 
bool:: 
TestConnection:: "
(::" #
)::# $
{;; 	
try<< 
{== 
MySqlHelperEE 
.EE 
ExecuteNonQueryEE +
(EE+ ,
_connectionStringEE, =
,EE= >
$strEE? h
)EEh i
;EEi j
returnGG 
trueGG 
;GG 
}HH 
catchII 
(II 
	ExceptionII 
exII 
)II  
{JJ 
logKK 
.KK 
ErrorKK 
(KK 
$strKK ,
,KK, -
exKK. 0
)KK0 1
;KK1 2
returnLL 
falseLL 
;LL 
}MM 
}NN 	
publicPP 
DataSetPP 
GetCatalogDataPP %
(PP% &
)PP& '
{QQ 	
usingRR 
(RR 
MySqlConnectionRR "

connectionRR# -
=RR. /
newRR0 3
MySqlConnectionRR4 C
(RRC D
_connectionStringRRD U
)RRU V
)RRV W
{SS 
MySqlDataAdapterTT  
daTT! #
=TT$ %
newTT& )
MySqlDataAdapterTT* :
(TT: ;
$strTT; S
,TTS T

connectionTTU _
)TT_ `
;TT` a
DataSetUU 
dsUU 
=UU 
newUU  
DataSetUU! (
(UU( )
)UU) *
;UU* +
daWW 
.WW 
FillWW 
(WW 
dsWW 
)WW 
;WW 
returnYY 
dsYY 
;YY 
}ZZ 
}[[ 	
public]] 
bool]] 
RecreateGoatDb]] "
(]]" #
)]]# $
{^^ 	
string__ 
args__ 
;__ 
ifaa 
(aa 
stringaa 
.aa 
IsNullOrEmptyaa $
(aa$ %
_pwdaa% )
)aa) *
)aa* +
argsbb 
=bb 
stringbb 
.bb 
Formatbb $
(bb$ %
$strbb% Y
,bbY Z
_uidcc 
,cc 
	_databasecc '
,cc' (
_hostcc) .
,cc. /
_portcc0 5
)cc5 6
;cc6 7
elsedd 
argsee 
=ee 
stringee 
.ee 
Formatee $
(ee$ %
$stree% h
,eeh i
_uidff 
,ff 
_pwdff "
,ff" #
	_databaseff$ -
,ff- .
_hostff/ 4
,ff4 5
_portff6 ;
)ff; <
;ff< =
loghh 
.hh 
Infohh 
(hh 
$strhh '
)hh' (
;hh( )
intjj 
retVal1jj 
=jj 
Mathjj 
.jj 
Absjj "
(jj" #
Utiljj# '
.jj' (
RunProcessWithInputjj( ;
(jj; <
_clientExecjj< G
,jjG H
argsjjI M
,jjM N
DbConstantsjjO Z
.jjZ [
DB_CREATE_SCRIPTjj[ k
)jjk l
)jjl m
;jjm n
intkk 
retVal2kk 
=kk 
Mathkk 
.kk 
Abskk "
(kk" #
Utilkk# '
.kk' (
RunProcessWithInputkk( ;
(kk; <
_clientExeckk< G
,kkG H
argskkI M
,kkM N
DbConstantskkO Z
.kkZ [ 
DB_LOAD_MYSQL_SCRIPTkk[ o
)kko p
)kkp q
;kkq r
returnmm 
Mathmm 
.mm 
Absmm 
(mm 
retVal1mm #
)mm# $
+mm% &
Mathmm' +
.mm+ ,
Absmm, /
(mm/ 0
retVal2mm0 7
)mm7 8
==mm9 ;
$nummm< =
;mm= >
}nn 	
publicpp 
boolpp  
IsValidCustomerLoginpp (
(pp( )
stringpp) /
emailpp0 5
,pp5 6
stringpp7 =
passwordpp> F
)ppF G
{qq 	
stringss 
encoded_passwordss #
=ss$ %
Encoderss& -
.ss- .
Encodess. 4
(ss4 5
passwordss5 =
)ss= >
;ss> ?
stringvv 
sqlvv 
=vv 
$strvv F
+vvG H
emailvvI N
+vvO P
$strww $
+ww% &
encoded_passwordww' 7
+ww8 9
$strww: >
;ww> ?
usingyy 
(yy 
MySqlConnectionyy "

connectionyy# -
=yy. /
newyy0 3
MySqlConnectionyy4 C
(yyC D
_connectionStringyyD U
)yyU V
)yyV W
{zz 
MySqlDataAdapter{{  
da{{! #
={{$ %
new{{& )
MySqlDataAdapter{{* :
({{: ;
sql{{; >
,{{> ?

connection{{@ J
){{J K
;{{K L
DataSet~~ 
ds~~ 
=~~ 
new~~  
DataSet~~! (
(~~( )
)~~) *
;~~* +
da
€€ 
.
€€ 
Fill
€€ 
(
€€ 
ds
€€ 
)
€€ 
;
€€ 
try
‚‚ 
{
ƒƒ 
return
„„ 
ds
„„ 
.
„„ 
Tables
„„ $
[
„„$ %
$num
„„% &
]
„„& '
.
„„' (
Rows
„„( ,
.
„„, -
Count
„„- 2
!=
„„3 5
$num
„„6 7
;
„„7 8
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡  
ex
‡‡! #
)
‡‡# $
{
ˆˆ 
log
ŠŠ 
.
ŠŠ 
Error
ŠŠ 
(
ŠŠ 
$str
ŠŠ 4
,
ŠŠ4 5
ex
ŠŠ6 8
)
ŠŠ8 9
;
ŠŠ9 :
throw
ŒŒ 
new
ŒŒ 
	Exception
ŒŒ '
(
ŒŒ' (
$str
ŒŒ( >
,
ŒŒ> ?
ex
ŒŒ@ B
)
ŒŒB C
;
ŒŒC D
}
 
}
ŽŽ 
}
 	
public
’’ 
string
’’ !
CustomCustomerLogin
’’ )
(
’’) *
string
’’* 0
email
’’1 6
,
’’6 7
string
’’8 >
password
’’? G
)
’’G H
{
““ 	
string
”” 
error_message
””  
=
””! "
null
””# '
;
””' (
try
•• 
{
–– 
string
˜˜ 
sql
˜˜ 
=
˜˜ 
$str
˜˜ J
+
˜˜K L
email
˜˜M R
+
˜˜S T
$str
˜˜U Y
;
˜˜Y Z
using
šš 
(
šš 
MySqlConnection
šš &

connection
šš' 1
=
šš2 3
new
šš4 7
MySqlConnection
šš8 G
(
ššG H
_connectionString
ššH Y
)
ššY Z
)
ššZ [
{
›› 
MySqlDataAdapter
œœ $
da
œœ% '
=
œœ( )
new
œœ* -
MySqlDataAdapter
œœ. >
(
œœ> ?
sql
œœ? B
,
œœB C

connection
œœD N
)
œœN O
;
œœO P
DataSet
 
ds
 
=
  
new
! $
DataSet
% ,
(
, -
)
- .
;
. /
da
žž 
.
žž 
Fill
žž 
(
žž 
ds
žž 
)
žž 
;
žž  
if
¡¡ 
(
¡¡ 
ds
¡¡ 
.
¡¡ 
Tables
¡¡ !
[
¡¡! "
$num
¡¡" #
]
¡¡# $
.
¡¡$ %
Rows
¡¡% )
.
¡¡) *
Count
¡¡* /
==
¡¡0 2
$num
¡¡3 4
)
¡¡4 5
{
¢¢ 
error_message
££ %
=
££& '
$str
££( B
;
££B C
return
¤¤ 
error_message
¤¤ ,
;
¤¤, -
}
¥¥ 
string
§§ 
encoded_password
§§ +
=
§§, -
ds
§§. 0
.
§§0 1
Tables
§§1 7
[
§§7 8
$num
§§8 9
]
§§9 :
.
§§: ;
Rows
§§; ?
[
§§? @
$num
§§@ A
]
§§A B
[
§§B C
$str
§§C M
]
§§M N
.
§§N O
ToString
§§O W
(
§§W X
)
§§X Y
;
§§Y Z
string
¨¨ 
decoded_password
¨¨ +
=
¨¨, -
Encoder
¨¨. 5
.
¨¨5 6
Decode
¨¨6 <
(
¨¨< =
encoded_password
¨¨= M
)
¨¨M N
;
¨¨N O
if
ªª 
(
ªª 
password
ªª  
.
ªª  !
Trim
ªª! %
(
ªª% &
)
ªª& '
.
ªª' (
ToLower
ªª( /
(
ªª/ 0
)
ªª0 1
!=
ªª2 4
decoded_password
ªª5 E
.
ªªE F
Trim
ªªF J
(
ªªJ K
)
ªªK L
.
ªªL M
ToLower
ªªM T
(
ªªT U
)
ªªU V
)
ªªV W
{
«« 
error_message
¬¬ %
=
¬¬& '
$str
¬¬( T
;
¬¬T U
}
­­ 
else
®® 
{
¯¯ 
error_message
±± %
=
±±& '
null
±±( ,
;
±±, -
}
²² 
}
³³ 
}
µµ 
catch
¶¶ 
(
¶¶ 
MySqlException
¶¶ !
ex
¶¶" $
)
¶¶$ %
{
·· 
log
¸¸ 
.
¸¸ 
Error
¸¸ 
(
¸¸ 
$str
¸¸ <
,
¸¸< =
ex
¸¸> @
)
¸¸@ A
;
¸¸A B
error_message
¹¹ 
=
¹¹ 
ex
¹¹  "
.
¹¹" #
Message
¹¹# *
;
¹¹* +
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
log
½½ 
.
½½ 
Error
½½ 
(
½½ 
$str
½½ <
,
½½< =
ex
½½> @
)
½½@ A
;
½½A B
}
¾¾ 
return
ÀÀ 
error_message
ÀÀ  
;
ÀÀ  !
}
ÁÁ 	
public
ÃÃ 
string
ÃÃ 
GetCustomerEmail
ÃÃ &
(
ÃÃ& '
string
ÃÃ' -
customerNumber
ÃÃ. <
)
ÃÃ< =
{
ÄÄ 	
string
ÅÅ 
output
ÅÅ 
=
ÅÅ 
null
ÅÅ  
;
ÅÅ  !
try
ÆÆ 
{
ÇÇ 
using
ÉÉ 
(
ÉÉ 
MySqlConnection
ÉÉ &

connection
ÉÉ' 1
=
ÉÉ2 3
new
ÉÉ4 7
MySqlConnection
ÉÉ8 G
(
ÉÉG H
_connectionString
ÉÉH Y
)
ÉÉY Z
)
ÉÉZ [
{
ÊÊ 
string
ËË 
sql
ËË 
=
ËË  
$str
ËË! Z
+
ËË[ \
customerNumber
ËË] k
;
ËËk l
MySqlCommand
ÌÌ  
command
ÌÌ! (
=
ÌÌ) *
new
ÌÌ+ .
MySqlCommand
ÌÌ/ ;
(
ÌÌ; <
sql
ÌÌ< ?
,
ÌÌ? @

connection
ÌÌA K
)
ÌÌK L
;
ÌÌL M
output
ÍÍ 
=
ÍÍ 
command
ÍÍ $
.
ÍÍ$ %
ExecuteScalar
ÍÍ% 2
(
ÍÍ2 3
)
ÍÍ3 4
.
ÍÍ4 5
ToString
ÍÍ5 =
(
ÍÍ= >
)
ÍÍ> ?
;
ÍÍ? @
}
ÎÎ 
}
ÏÏ 
catch
ÐÐ 
(
ÐÐ 
	Exception
ÐÐ 
ex
ÐÐ 
)
ÐÐ  
{
ÑÑ 
output
ÒÒ 
=
ÒÒ 
ex
ÒÒ 
.
ÒÒ 
Message
ÒÒ #
;
ÒÒ# $
}
ÓÓ 
return
ÔÔ 
output
ÔÔ 
;
ÔÔ 
}
ÕÕ 	
public
×× 
DataSet
××  
GetCustomerDetails
×× )
(
××) *
string
××* 0
customerNumber
××1 ?
)
××? @
{
ØØ 	
string
ÙÙ 
sql
ÙÙ 
=
ÙÙ 
$strÙÙ £
+ÙÙ¤ ¥
$strÚÚ 
+ÚÚž Ÿ
$strÛÛ ¨
+ÛÛ© ª
$strÜÜ 
+ÜÜŽ 
customerNumberÜÜ ž
;ÜÜž Ÿ
DataSet
ÞÞ 
ds
ÞÞ 
=
ÞÞ 
new
ÞÞ 
DataSet
ÞÞ $
(
ÞÞ$ %
)
ÞÞ% &
;
ÞÞ& '
try
ßß 
{
àà 
using
ââ 
(
ââ 
MySqlConnection
ââ &

connection
ââ' 1
=
ââ2 3
new
ââ4 7
MySqlConnection
ââ8 G
(
ââG H
_connectionString
ââH Y
)
ââY Z
)
ââZ [
{
ãã 
MySqlDataAdapter
ää $
da
ää% '
=
ää( )
new
ää* -
MySqlDataAdapter
ää. >
(
ää> ?
sql
ää? B
,
ääB C

connection
ääD N
)
ääN O
;
ääO P
da
åå 
.
åå 
Fill
åå 
(
åå 
ds
åå 
)
åå 
;
åå  
}
ææ 
}
èè 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
êê 
log
ëë 
.
ëë 
Error
ëë 
(
ëë 
$str
ëë :
,
ëë: ;
ex
ëë< >
)
ëë> ?
;
ëë? @
throw
íí 
new
íí "
ApplicationException
íí .
(
íí. /
$str
íí/ O
,
ííO P
ex
ííQ S
)
ííS T
;
ííT U
}
îî 
return
ïï 
ds
ïï 
;
ïï 
}
ññ 	
public
óó 
DataSet
óó 
	GetOffice
óó  
(
óó  !
string
óó! '
city
óó( ,
)
óó, -
{
ôô 	
using
öö 
(
öö 
MySqlConnection
öö "

connection
öö# -
=
öö. /
new
öö0 3
MySqlConnection
öö4 C
(
ööC D
_connectionString
ööD U
)
ööU V
)
ööV W
{
÷÷ 
string
øø 
sql
øø 
=
øø 
$str
øø G
;
øøG H
MySqlDataAdapter
ùù  
da
ùù! #
=
ùù$ %
new
ùù& )
MySqlDataAdapter
ùù* :
(
ùù: ;
sql
ùù; >
,
ùù> ?

connection
ùù@ J
)
ùùJ K
;
ùùK L
da
úú 
.
úú 
SelectCommand
úú  
.
úú  !

Parameters
úú! +
.
úú+ ,
AddWithValue
úú, 8
(
úú8 9
$str
úú9 @
,
úú@ A
city
úúB F
)
úúF G
;
úúG H
DataSet
ûû 
ds
ûû 
=
ûû 
new
ûû  
DataSet
ûû! (
(
ûû( )
)
ûû) *
;
ûû* +
da
üü 
.
üü 
Fill
üü 
(
üü 
ds
üü 
)
üü 
;
üü 
return
ýý 
ds
ýý 
;
ýý 
}
þþ 
}
ÿÿ 	
public
 
DataSet
 
GetComments
 "
(
" #
string
# )
productCode
* 5
)
5 6
{
‚‚ 	
using
„„ 
(
„„ 
MySqlConnection
„„ "

connection
„„# -
=
„„. /
new
„„0 3
MySqlConnection
„„4 C
(
„„C D
_connectionString
„„D U
)
„„U V
)
„„V W
{
…… 
string
†† 
sql
†† 
=
†† 
$str
†† V
;
††V W
MySqlDataAdapter
‡‡  
da
‡‡! #
=
‡‡$ %
new
‡‡& )
MySqlDataAdapter
‡‡* :
(
‡‡: ;
sql
‡‡; >
,
‡‡> ?

connection
‡‡@ J
)
‡‡J K
;
‡‡K L
da
ˆˆ 
.
ˆˆ 
SelectCommand
ˆˆ  
.
ˆˆ  !

Parameters
ˆˆ! +
.
ˆˆ+ ,
AddWithValue
ˆˆ, 8
(
ˆˆ8 9
$str
ˆˆ9 G
,
ˆˆG H
productCode
ˆˆI T
)
ˆˆT U
;
ˆˆU V
DataSet
‰‰ 
ds
‰‰ 
=
‰‰ 
new
‰‰  
DataSet
‰‰! (
(
‰‰( )
)
‰‰) *
;
‰‰* +
da
ŠŠ 
.
ŠŠ 
Fill
ŠŠ 
(
ŠŠ 
ds
ŠŠ 
)
ŠŠ 
;
ŠŠ 
return
‹‹ 
ds
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
public
 
string
 

AddComment
  
(
  !
string
! '
productCode
( 3
,
3 4
string
5 ;
email
< A
,
A B
string
C I
comment
J Q
)
Q R
{
 	
string
‘‘ 
sql
‘‘ 
=
‘‘ 
$str
‘‘ V
+
‘‘W X
productCode
‘‘Y d
+
‘‘e f
$str
‘‘g l
+
‘‘m n
email
‘‘o t
+
‘‘u v
$str
‘‘w |
+
‘‘} ~
comment‘‘ †
+‘‘‡ ˆ
$str‘‘‰ Ž
;‘‘Ž 
string
’’ 
output
’’ 
=
’’ 
null
’’  
;
’’  !
try
”” 
{
•• 
using
—— 
(
—— 
MySqlConnection
—— &

connection
——' 1
=
——2 3
new
——4 7
MySqlConnection
——8 G
(
——G H
_connectionString
——H Y
)
——Y Z
)
——Z [
{
˜˜ 

connection
™™ 
.
™™ 
Open
™™ #
(
™™# $
)
™™$ %
;
™™% &
MySqlCommand
šš  
command
šš! (
=
šš) *
new
šš+ .
MySqlCommand
šš/ ;
(
šš; <
sql
šš< ?
,
šš? @

connection
ššA K
)
ššK L
;
ššL M
command
›› 
.
›› 
ExecuteNonQuery
›› +
(
››+ ,
)
››, -
;
››- .
}
œœ 
}
 
catch
žž 
(
žž 
	Exception
žž 
ex
žž 
)
žž  
{
ŸŸ 
log
   
.
   
Error
   
(
   
$str
   0
,
  0 1
ex
  2 4
)
  4 5
;
  5 6
output
¡¡ 
=
¡¡ 
ex
¡¡ 
.
¡¡ 
Message
¡¡ #
;
¡¡# $
}
¢¢ 
return
¤¤ 
output
¤¤ 
;
¤¤ 
}
¥¥ 	
public
§§ 
string
§§ $
UpdateCustomerPassword
§§ ,
(
§§, -
int
§§- 0
customerNumber
§§1 ?
,
§§? @
string
§§A G
password
§§H P
)
§§P Q
{
¨¨ 	
string
©© 
sql
©© 
=
©© 
$str
©© @
+
©©A B
Encoder
©©C J
.
©©J K
Encode
©©K Q
(
©©Q R
password
©©R Z
)
©©Z [
+
©©\ ]
$str
©©^ y
+
©©z {
customerNumber©©| Š
;©©Š ‹
string
ªª 
output
ªª 
=
ªª 
null
ªª  
;
ªª  !
try
«« 
{
¬¬ 
using
®® 
(
®® 
MySqlConnection
®® &

connection
®®' 1
=
®®2 3
new
®®4 7
MySqlConnection
®®8 G
(
®®G H
_connectionString
®®H Y
)
®®Y Z
)
®®Z [
{
¯¯ 
MySqlCommand
°°  
command
°°! (
=
°°) *
new
°°+ .
MySqlCommand
°°/ ;
(
°°; <
sql
°°< ?
,
°°? @

connection
°°A K
)
°°K L
;
°°L M
int
²² 

rows_added
²² "
=
²²# $
command
²²% ,
.
²², -
ExecuteNonQuery
²²- <
(
²²< =
)
²²= >
;
²²> ?
log
´´ 
.
´´ 
Info
´´ 
(
´´ 
$str
´´ +
+
´´, -

rows_added
´´. 8
+
´´9 :
$str
´´; N
)
´´N O
;
´´O P
}
µµ 
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
··  
{
¸¸ 
log
¹¹ 
.
¹¹ 
Error
¹¹ 
(
¹¹ 
$str
¹¹ <
,
¹¹< =
ex
¹¹> @
)
¹¹@ A
;
¹¹A B
output
ºº 
=
ºº 
ex
ºº 
.
ºº 
Message
ºº #
;
ºº# $
}
»» 
return
¼¼ 
output
¼¼ 
;
¼¼ 
}
½½ 	
public
¿¿ 
string
¿¿ 
[
¿¿ 
]
¿¿ *
GetSecurityQuestionAndAnswer
¿¿ 4
(
¿¿4 5
string
¿¿5 ;
email
¿¿< A
)
¿¿A B
{
ÀÀ 	
string
ÁÁ 
sql
ÁÁ 
=
ÁÁ 
$str
ÁÁ l
+
ÁÁm n
$str
ÂÂ A
+
ÂÂB C
email
ÂÂD I
+
ÂÂJ K
$str
ÂÂL p
+
ÂÂq r
$str
ÃÃ 0
;
ÃÃ0 1
string
ÅÅ 
[
ÅÅ 
]
ÅÅ 
qAndA
ÅÅ 
=
ÅÅ 
new
ÅÅ  
string
ÅÅ! '
[
ÅÅ' (
$num
ÅÅ( )
]
ÅÅ) *
;
ÅÅ* +
using
ÇÇ 
(
ÇÇ 
MySqlConnection
ÇÇ "

connection
ÇÇ# -
=
ÇÇ. /
new
ÇÇ0 3
MySqlConnection
ÇÇ4 C
(
ÇÇC D
_connectionString
ÇÇD U
)
ÇÇU V
)
ÇÇV W
{
ÈÈ 
MySqlDataAdapter
ÉÉ  
da
ÉÉ! #
=
ÉÉ$ %
new
ÉÉ& )
MySqlDataAdapter
ÉÉ* :
(
ÉÉ: ;
sql
ÉÉ; >
,
ÉÉ> ?

connection
ÉÉ@ J
)
ÉÉJ K
;
ÉÉK L
DataSet
ËË 
ds
ËË 
=
ËË 
new
ËË  
DataSet
ËË! (
(
ËË( )
)
ËË) *
;
ËË* +
da
ÌÌ 
.
ÌÌ 
Fill
ÌÌ 
(
ÌÌ 
ds
ÌÌ 
)
ÌÌ 
;
ÌÌ 
if
ÎÎ 
(
ÎÎ 
ds
ÎÎ 
.
ÎÎ 
Tables
ÎÎ 
[
ÎÎ 
$num
ÎÎ 
]
ÎÎ  
.
ÎÎ  !
Rows
ÎÎ! %
.
ÎÎ% &
Count
ÎÎ& +
>
ÎÎ, -
$num
ÎÎ. /
)
ÎÎ/ 0
{
ÏÏ 
DataRow
ÐÐ 
row
ÐÐ 
=
ÐÐ  !
ds
ÐÐ" $
.
ÐÐ$ %
Tables
ÐÐ% +
[
ÐÐ+ ,
$num
ÐÐ, -
]
ÐÐ- .
.
ÐÐ. /
Rows
ÐÐ/ 3
[
ÐÐ3 4
$num
ÐÐ4 5
]
ÐÐ5 6
;
ÐÐ6 7
qAndA
ÑÑ 
[
ÑÑ 
$num
ÑÑ 
]
ÑÑ 
=
ÑÑ 
row
ÑÑ "
[
ÑÑ" #
$num
ÑÑ# $
]
ÑÑ$ %
.
ÑÑ% &
ToString
ÑÑ& .
(
ÑÑ. /
)
ÑÑ/ 0
;
ÑÑ0 1
qAndA
ÒÒ 
[
ÒÒ 
$num
ÒÒ 
]
ÒÒ 
=
ÒÒ 
row
ÒÒ "
[
ÒÒ" #
$num
ÒÒ# $
]
ÒÒ$ %
.
ÒÒ% &
ToString
ÒÒ& .
(
ÒÒ. /
)
ÒÒ/ 0
;
ÒÒ0 1
}
ÓÓ 
}
ÔÔ 
return
ÖÖ 
qAndA
ÖÖ 
;
ÖÖ 
}
×× 	
public
ÙÙ 
string
ÙÙ  
GetPasswordByEmail
ÙÙ (
(
ÙÙ( )
string
ÙÙ) /
email
ÙÙ0 5
)
ÙÙ5 6
{
ÚÚ 	
string
ÛÛ 
result
ÛÛ 
=
ÛÛ 
string
ÛÛ "
.
ÛÛ" #
Empty
ÛÛ# (
;
ÛÛ( )
try
ÜÜ 
{
ÝÝ 
using
ßß 
(
ßß 
MySqlConnection
ßß &

connection
ßß' 1
=
ßß2 3
new
ßß4 7
MySqlConnection
ßß8 G
(
ßßG H
_connectionString
ßßH Y
)
ßßY Z
)
ßßZ [
{
àà 
string
ââ 
sql
ââ 
=
ââ  
$str
ââ! N
+
ââO P
email
ââQ V
+
ââW X
$str
ââY ]
;
ââ] ^
MySqlDataAdapter
ãã $
da
ãã% '
=
ãã( )
new
ãã* -
MySqlDataAdapter
ãã. >
(
ãã> ?
sql
ãã? B
,
ããB C

connection
ããD N
)
ããN O
;
ããO P
DataSet
ää 
ds
ää 
=
ää  
new
ää! $
DataSet
ää% ,
(
ää, -
)
ää- .
;
ää. /
da
åå 
.
åå 
Fill
åå 
(
åå 
ds
åå 
)
åå 
;
åå  
if
èè 
(
èè 
ds
èè 
.
èè 
Tables
èè !
[
èè! "
$num
èè" #
]
èè# $
.
èè$ %
Rows
èè% )
.
èè) *
Count
èè* /
==
èè0 2
$num
èè3 4
)
èè4 5
{
éé 
result
êê 
=
êê  
$str
êê! ;
;
êê; <
}
ëë 
string
íí 
encoded_password
íí +
=
íí, -
ds
íí. 0
.
íí0 1
Tables
íí1 7
[
íí7 8
$num
íí8 9
]
íí9 :
.
íí: ;
Rows
íí; ?
[
íí? @
$num
íí@ A
]
ííA B
[
ííB C
$str
ííC M
]
ííM N
.
ííN O
ToString
ííO W
(
ííW X
)
ííX Y
;
ííY Z
string
îî 
decoded_password
îî +
=
îî, -
Encoder
îî. 5
.
îî5 6
Decode
îî6 <
(
îî< =
encoded_password
îî= M
)
îîM N
;
îîN O
result
ïï 
=
ïï 
decoded_password
ïï -
;
ïï- .
}
ðð 
}
ññ 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
óó 
result
ôô 
=
ôô 
ex
ôô 
.
ôô 
Message
ôô #
;
ôô# $
}
õõ 
return
öö 
result
öö 
;
öö 
}
÷÷ 	
public
ùù 
DataSet
ùù 
GetUsers
ùù 
(
ùù  
)
ùù  !
{
úú 	
using
ûû 
(
ûû 
MySqlConnection
ûû "

connection
ûû# -
=
ûû. /
new
ûû0 3
MySqlConnection
ûû4 C
(
ûûC D
_connectionString
ûûD U
)
ûûU V
)
ûûV W
{
üü 
string
ýý 
sql
ýý 
=
ýý 
$str
ýý ;
;
ýý; <
MySqlDataAdapter
þþ  
da
þþ! #
=
þþ$ %
new
þþ& )
MySqlDataAdapter
þþ* :
(
þþ: ;
sql
þþ; >
,
þþ> ?

connection
þþ@ J
)
þþJ K
;
þþK L
DataSet
ÿÿ 
ds
ÿÿ 
=
ÿÿ 
new
ÿÿ  
DataSet
ÿÿ! (
(
ÿÿ( )
)
ÿÿ) *
;
ÿÿ* +
da
€€ 
.
€€ 
Fill
€€ 
(
€€ 
ds
€€ 
)
€€ 
;
€€ 
return
 
ds
 
;
 
}
‚‚ 
}
ƒƒ 	
public
…… 
DataSet
…… 
	GetOrders
……  
(
……  !
int
……! $

customerID
……% /
)
……/ 0
{
†† 	
using
ˆˆ 
(
ˆˆ 
MySqlConnection
ˆˆ "

connection
ˆˆ# -
=
ˆˆ. /
new
ˆˆ0 3
MySqlConnection
ˆˆ4 C
(
ˆˆC D
_connectionString
ˆˆD U
)
ˆˆU V
)
ˆˆV W
{
‰‰ 
string
ŠŠ 
sql
ŠŠ 
=
ŠŠ 
$str
ŠŠ K
+
ŠŠL M

customerID
ŠŠN X
;
ŠŠX Y
MySqlDataAdapter
‹‹  
da
‹‹! #
=
‹‹$ %
new
‹‹& )
MySqlDataAdapter
‹‹* :
(
‹‹: ;
sql
‹‹; >
,
‹‹> ?

connection
‹‹@ J
)
‹‹J K
;
‹‹K L
DataSet
ŒŒ 
ds
ŒŒ 
=
ŒŒ 
new
ŒŒ  
DataSet
ŒŒ! (
(
ŒŒ( )
)
ŒŒ) *
;
ŒŒ* +
da
 
.
 
Fill
 
(
 
ds
 
)
 
;
 
if
 
(
 
ds
 
.
 
Tables
 
[
 
$num
 
]
  
.
  !
Rows
! %
.
% &
Count
& +
==
, .
$num
/ 0
)
0 1
return
 
null
 
;
  
else
‘‘ 
return
’’ 
ds
’’ 
;
’’ 
}
““ 
}
”” 	
public
–– 
DataSet
–– 
GetProductDetails
–– (
(
––( )
string
––) /
productCode
––0 ;
)
––; <
{
—— 	
string
˜˜ 
sql
˜˜ 
=
˜˜ 
string
˜˜ 
.
˜˜  
Empty
˜˜  %
;
˜˜% &
MySqlDataAdapter
™™ 
da
™™ 
;
™™  
DataSet
šš 
ds
šš 
=
šš 
new
šš 
DataSet
šš $
(
šš$ %
)
šš% &
;
šš& '
using
 
(
 
MySqlConnection
 "

connection
# -
=
. /
new
0 3
MySqlConnection
4 C
(
C D
_connectionString
D U
)
U V
)
V W
{
žž 
sql
ŸŸ 
=
ŸŸ 
$str
ŸŸ D
+
ŸŸE F
productCode
ŸŸG R
+
ŸŸS T
$str
ŸŸU X
;
ŸŸX Y
da
   
=
   
new
   
MySqlDataAdapter
   )
(
  ) *
sql
  * -
,
  - .

connection
  / 9
)
  9 :
;
  : ;
da
¡¡ 
.
¡¡ 
Fill
¡¡ 
(
¡¡ 
ds
¡¡ 
,
¡¡ 
$str
¡¡ &
)
¡¡& '
;
¡¡' (
sql
££ 
=
££ 
$str
££ D
+
££E F
productCode
££G R
+
££S T
$str
££U X
;
££X Y
da
¤¤ 
=
¤¤ 
new
¤¤ 
MySqlDataAdapter
¤¤ )
(
¤¤) *
sql
¤¤* -
,
¤¤- .

connection
¤¤/ 9
)
¤¤9 :
;
¤¤: ;
da
¥¥ 
.
¥¥ 
Fill
¥¥ 
(
¥¥ 
ds
¥¥ 
,
¥¥ 
$str
¥¥ &
)
¥¥& '
;
¥¥' (
DataRelation
§§ 
dr
§§ 
=
§§  !
new
§§" %
DataRelation
§§& 2
(
§§2 3
$str
§§3 B
,
§§B C
ds
¨¨ 
.
¨¨ 
Tables
¨¨ 
[
¨¨ 
$str
¨¨ $
]
¨¨$ %
.
¨¨% &
Columns
¨¨& -
[
¨¨- .
$str
¨¨. ;
]
¨¨; <
,
¨¨< =
ds
©© 
.
©© 
Tables
©© 
[
©© 
$str
©© $
]
©©$ %
.
©©% &
Columns
©©& -
[
©©- .
$str
©©. ;
]
©©; <
,
©©< =
false
ªª 
)
ªª 
;
ªª 
ds
¬¬ 
.
¬¬ 
	Relations
¬¬ 
.
¬¬ 
Add
¬¬  
(
¬¬  !
dr
¬¬! #
)
¬¬# $
;
¬¬$ %
return
­­ 
ds
­­ 
;
­­ 
}
®® 
}
¯¯ 	
public
±± 
DataSet
±± 
GetOrderDetails
±± &
(
±±& '
int
±±' *
orderNumber
±±+ 6
)
±±6 7
{
²² 	
string
´´ 
sql
´´ 
=
´´ 
$str
´´ {
+
´´| }
$str
µµ ^
+
µµ_ `
$str
¶¶ G
+
¶¶H I
$str
·· C
+
··D E
$str
¸¸ F
+
¸¸G H
$str
¹¹ D
+
¹¹E F
$str
ºº 1
+
ºº2 3
orderNumber
ºº4 ?
;
ºº? @
using
½½ 
(
½½ 
MySqlConnection
½½ "

connection
½½# -
=
½½. /
new
½½0 3
MySqlConnection
½½4 C
(
½½C D
_connectionString
½½D U
)
½½U V
)
½½V W
{
¾¾ 
MySqlDataAdapter
¿¿  
da
¿¿! #
=
¿¿$ %
new
¿¿& )
MySqlDataAdapter
¿¿* :
(
¿¿: ;
sql
¿¿; >
,
¿¿> ?

connection
¿¿@ J
)
¿¿J K
;
¿¿K L
DataSet
ÀÀ 
ds
ÀÀ 
=
ÀÀ 
new
ÀÀ  
DataSet
ÀÀ! (
(
ÀÀ( )
)
ÀÀ) *
;
ÀÀ* +
da
ÁÁ 
.
ÁÁ 
Fill
ÁÁ 
(
ÁÁ 
ds
ÁÁ 
)
ÁÁ 
;
ÁÁ 
if
ÃÃ 
(
ÃÃ 
ds
ÃÃ 
.
ÃÃ 
Tables
ÃÃ 
[
ÃÃ 
$num
ÃÃ 
]
ÃÃ  
.
ÃÃ  !
Rows
ÃÃ! %
.
ÃÃ% &
Count
ÃÃ& +
==
ÃÃ, .
$num
ÃÃ/ 0
)
ÃÃ0 1
return
ÄÄ 
null
ÄÄ 
;
ÄÄ  
else
ÅÅ 
return
ÆÆ 
ds
ÆÆ 
;
ÆÆ 
}
ÇÇ 
}
ÈÈ 	
public
ÊÊ 
DataSet
ÊÊ 
GetPayments
ÊÊ "
(
ÊÊ" #
int
ÊÊ# &
customerNumber
ÊÊ' 5
)
ÊÊ5 6
{
ËË 	
using
ÌÌ 
(
ÌÌ 
MySqlConnection
ÌÌ "

connection
ÌÌ# -
=
ÌÌ. /
new
ÌÌ0 3
MySqlConnection
ÌÌ4 C
(
ÌÌC D
_connectionString
ÌÌD U
)
ÌÌU V
)
ÌÌV W
{
ÍÍ 
string
ÎÎ 
sql
ÎÎ 
=
ÎÎ 
$str
ÎÎ M
+
ÎÎN O
customerNumber
ÎÎP ^
;
ÎÎ^ _
MySqlDataAdapter
ÏÏ  
da
ÏÏ! #
=
ÏÏ$ %
new
ÏÏ& )
MySqlDataAdapter
ÏÏ* :
(
ÏÏ: ;
sql
ÏÏ; >
,
ÏÏ> ?

connection
ÏÏ@ J
)
ÏÏJ K
;
ÏÏK L
DataSet
ÐÐ 
ds
ÐÐ 
=
ÐÐ 
new
ÐÐ  
DataSet
ÐÐ! (
(
ÐÐ( )
)
ÐÐ) *
;
ÐÐ* +
da
ÑÑ 
.
ÑÑ 
Fill
ÑÑ 
(
ÑÑ 
ds
ÑÑ 
)
ÑÑ 
;
ÑÑ 
if
ÓÓ 
(
ÓÓ 
ds
ÓÓ 
.
ÓÓ 
Tables
ÓÓ 
[
ÓÓ 
$num
ÓÓ 
]
ÓÓ  
.
ÓÓ  !
Rows
ÓÓ! %
.
ÓÓ% &
Count
ÓÓ& +
==
ÓÓ, .
$num
ÓÓ/ 0
)
ÓÓ0 1
return
ÔÔ 
null
ÔÔ 
;
ÔÔ  
else
ÕÕ 
return
ÖÖ 
ds
ÖÖ 
;
ÖÖ 
}
×× 
}
ØØ 	
public
ÚÚ 
DataSet
ÚÚ &
GetProductsAndCategories
ÚÚ /
(
ÚÚ/ 0
)
ÚÚ0 1
{
ÛÛ 	
return
ÜÜ &
GetProductsAndCategories
ÜÜ +
(
ÜÜ+ ,
$num
ÜÜ, -
)
ÜÜ- .
;
ÜÜ. /
}
ÝÝ 	
public
ßß 
DataSet
ßß &
GetProductsAndCategories
ßß /
(
ßß/ 0
int
ßß0 3
	catNumber
ßß4 =
)
ßß= >
{
àà 	
string
ââ 
sql
ââ 
=
ââ 
string
ââ 
.
ââ  
Empty
ââ  %
;
ââ% &
MySqlDataAdapter
ãã 
da
ãã 
;
ãã  
DataSet
ää 
ds
ää 
=
ää 
new
ää 
DataSet
ää $
(
ää$ %
)
ää% &
;
ää& '
string
çç 
	catClause
çç 
=
çç 
string
çç %
.
çç% &
Empty
çç& +
;
çç+ ,
if
èè 
(
èè 
	catNumber
èè 
>=
èè 
$num
èè 
)
èè 
	catClause
éé 
+=
éé 
$str
éé 2
+
éé3 4
	catNumber
éé5 >
;
éé> ?
using
ìì 
(
ìì 
MySqlConnection
ìì "

connection
ìì# -
=
ìì. /
new
ìì0 3
MySqlConnection
ìì4 C
(
ììC D
_connectionString
ììD U
)
ììU V
)
ììV W
{
íí 
sql
ïï 
=
ïï 
$str
ïï 0
+
ïï1 2
	catClause
ïï3 <
;
ïï< =
da
ðð 
=
ðð 
new
ðð 
MySqlDataAdapter
ðð )
(
ðð) *
sql
ðð* -
,
ðð- .

connection
ðð/ 9
)
ðð9 :
;
ðð: ;
da
ññ 
.
ññ 
Fill
ññ 
(
ññ 
ds
ññ 
,
ññ 
$str
ññ (
)
ññ( )
;
ññ) *
sql
óó 
=
óó 
$str
óó .
+
óó/ 0
	catClause
óó1 :
;
óó: ;
da
ôô 
=
ôô 
new
ôô 
MySqlDataAdapter
ôô )
(
ôô) *
sql
ôô* -
,
ôô- .

connection
ôô/ 9
)
ôô9 :
;
ôô: ;
da
õõ 
.
õõ 
Fill
õõ 
(
õõ 
ds
õõ 
,
õõ 
$str
õõ &
)
õõ& '
;
õõ' (
DataRelation
ùù 
dr
ùù 
=
ùù  !
new
ùù" %
DataRelation
ùù& 2
(
ùù2 3
$str
ùù3 >
,
ùù> ?
ds
úú 
.
úú 
Tables
úú 
[
úú 
$str
úú &
]
úú& '
.
úú' (
Columns
úú( /
[
úú/ 0
$str
úú0 ;
]
úú; <
,
úú< =
ds
ûû 
.
ûû 
Tables
ûû 
[
ûû 
$str
ûû $
]
ûû$ %
.
ûû% &
Columns
ûû& -
[
ûû- .
$str
ûû. 9
]
ûû9 :
,
ûû: ;
false
üü 
)
üü 
;
üü 
ds
þþ 
.
þþ 
	Relations
þþ 
.
þþ 
Add
þþ  
(
þþ  !
dr
þþ! #
)
þþ# $
;
þþ$ %
return
ÿÿ 
ds
ÿÿ 
;
ÿÿ 
}
€€ 
}
 	
public
ƒƒ 
DataSet
ƒƒ 
GetEmailByName
ƒƒ %
(
ƒƒ% &
string
ƒƒ& ,
name
ƒƒ- 1
)
ƒƒ1 2
{
„„ 	
string
…… 
sql
…… 
=
…… 
$str
…… b
+
……c d
name
……e i
+
……j k
$str……l ƒ
+……„ …
name……† Š
+……‹ Œ
$str…… ‘
;……‘ ’
using
ˆˆ 
(
ˆˆ 
MySqlConnection
ˆˆ "

connection
ˆˆ# -
=
ˆˆ. /
new
ˆˆ0 3
MySqlConnection
ˆˆ4 C
(
ˆˆC D
_connectionString
ˆˆD U
)
ˆˆU V
)
ˆˆV W
{
‰‰ 
MySqlDataAdapter
ŠŠ  
da
ŠŠ! #
=
ŠŠ$ %
new
ŠŠ& )
MySqlDataAdapter
ŠŠ* :
(
ŠŠ: ;
sql
ŠŠ; >
,
ŠŠ> ?

connection
ŠŠ@ J
)
ŠŠJ K
;
ŠŠK L
DataSet
‹‹ 
ds
‹‹ 
=
‹‹ 
new
‹‹  
DataSet
‹‹! (
(
‹‹( )
)
‹‹) *
;
‹‹* +
da
ŒŒ 
.
ŒŒ 
Fill
ŒŒ 
(
ŒŒ 
ds
ŒŒ 
)
ŒŒ 
;
ŒŒ 
if
ŽŽ 
(
ŽŽ 
ds
ŽŽ 
.
ŽŽ 
Tables
ŽŽ 
[
ŽŽ 
$num
ŽŽ 
]
ŽŽ  
.
ŽŽ  !
Rows
ŽŽ! %
.
ŽŽ% &
Count
ŽŽ& +
==
ŽŽ, .
$num
ŽŽ/ 0
)
ŽŽ0 1
return
 
null
 
;
  
else
 
return
‘‘ 
ds
‘‘ 
;
‘‘ 
}
’’ 
}
““ 	
public
•• 
string
•• &
GetEmailByCustomerNumber
•• .
(
••. /
string
••/ 5
num
••6 9
)
••9 :
{
–– 	
string
—— 
output
—— 
=
—— 
$str
—— 
;
—— 
try
˜˜ 
{
™™ 
output
›› 
=
›› 
(
›› 
String
››  
)
››  !
MySqlHelper
››! ,
.
››, -
ExecuteScalar
››- :
(
››: ;
_connectionString
››; L
,
››L M
$str››N ‡
+››ˆ ‰
num››Š 
)›› Ž
;››Ž 
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤ 
ex
¤¤ 
)
¤¤  
{
¥¥ 
log
¦¦ 
.
¦¦ 
Error
¦¦ 
(
¦¦ 
$str
¦¦ B
,
¦¦B C
ex
¦¦D F
)
¦¦F G
;
¦¦G H
output
§§ 
=
§§ 
ex
§§ 
.
§§ 
Message
§§ #
;
§§# $
}
¨¨ 
return
ªª 
output
ªª 
;
ªª 
}
«« 	
public
­­ 
DataSet
­­ 
GetCustomerEmails
­­ (
(
­­( )
string
­­) /
email
­­0 5
)
­­5 6
{
®® 	
string
¯¯ 
sql
¯¯ 
=
¯¯ 
$str
¯¯ M
+
¯¯N O
email
¯¯P U
+
¯¯V W
$str
¯¯X \
;
¯¯\ ]
using
²² 
(
²² 
MySqlConnection
²² "

connection
²²# -
=
²². /
new
²²0 3
MySqlConnection
²²4 C
(
²²C D
_connectionString
²²D U
)
²²U V
)
²²V W
{
³³ 
MySqlDataAdapter
´´  
da
´´! #
=
´´$ %
new
´´& )
MySqlDataAdapter
´´* :
(
´´: ;
sql
´´; >
,
´´> ?

connection
´´@ J
)
´´J K
;
´´K L
DataSet
µµ 
ds
µµ 
=
µµ 
new
µµ  
DataSet
µµ! (
(
µµ( )
)
µµ) *
;
µµ* +
da
¶¶ 
.
¶¶ 
Fill
¶¶ 
(
¶¶ 
ds
¶¶ 
)
¶¶ 
;
¶¶ 
if
¸¸ 
(
¸¸ 
ds
¸¸ 
.
¸¸ 
Tables
¸¸ 
[
¸¸ 
$num
¸¸ 
]
¸¸  
.
¸¸  !
Rows
¸¸! %
.
¸¸% &
Count
¸¸& +
==
¸¸, .
$num
¸¸/ 0
)
¸¸0 1
return
¹¹ 
null
¹¹ 
;
¹¹  
else
ºº 
return
»» 
ds
»» 
;
»» 
}
¼¼ 
}
½½ 	
}
¿¿ 
}ÀÀ ™›
6C:\work\code\OWASP-WebGoat\WebGoat\App_Code\Encoder.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
App_Code $
{ 
public 

class 
Encoder 
{ 
private 
static 
byte 
[ 
] 
_salt #
=$ %
Encoding& .
.. /
ASCII/ 4
.4 5
GetBytes5 =
(= >
$str> N
)N O
;O P
public 
static 
string 
EncryptStringAES -
(- .
string. 4
	plainText5 >
,> ?
string@ F
sharedSecretG S
)S T
{ 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
	plainText% .
). /
)/ 0
throw 
new !
ArgumentNullException /
(/ 0
$str0 ;
); <
;< =
if 
( 
string 
. 
IsNullOrEmpty $
($ %
sharedSecret% 1
)1 2
)2 3
throw 
new !
ArgumentNullException /
(/ 0
$str0 >
)> ?
;? @
string!! 
outStr!! 
=!! 
null!!  
;!!  !
RijndaelManaged"" 
aesAlg"" "
=""# $
null""% )
;"") *
try$$ 
{%% 
Rfc2898DeriveBytes'' "
key''# &
=''' (
new'') ,
Rfc2898DeriveBytes''- ?
(''? @
sharedSecret''@ L
,''L M
_salt''N S
)''S T
;''T U
aesAlg++ 
=++ 
new++ 
RijndaelManaged++ ,
(++, -
)++- .
;++. /
aesAlg,, 
.,, 
Key,, 
=,, 
key,,  
.,,  !
GetBytes,,! )
(,,) *
aesAlg,,* 0
.,,0 1
KeySize,,1 8
/,,9 :
$num,,; <
),,< =
;,,= >
aesAlg-- 
.-- 
IV-- 
=-- 
key-- 
.--  
GetBytes--  (
(--( )
aesAlg--) /
.--/ 0
	BlockSize--0 9
/--: ;
$num--< =
)--= >
;--> ?
ICryptoTransform00  
	encryptor00! *
=00+ ,
aesAlg00- 3
.003 4
CreateEncryptor004 C
(00C D
aesAlg00D J
.00J K
Key00K N
,00N O
aesAlg00P V
.00V W
IV00W Y
)00Y Z
;00Z [
using33 
(33 
MemoryStream33 #
	msEncrypt33$ -
=33. /
new330 3
MemoryStream334 @
(33@ A
)33A B
)33B C
{44 
using55 
(55 
CryptoStream55 '
	csEncrypt55( 1
=552 3
new554 7
CryptoStream558 D
(55D E
	msEncrypt55E N
,55N O
	encryptor55P Y
,55Y Z
CryptoStreamMode55[ k
.55k l
Write55l q
)55q r
)55r s
{66 
using77 
(77 
StreamWriter77 +
	swEncrypt77, 5
=776 7
new778 ;
StreamWriter77< H
(77H I
	csEncrypt77I R
)77R S
)77S T
{88 
	swEncrypt;; %
.;;% &
Write;;& +
(;;+ ,
	plainText;;, 5
);;5 6
;;;6 7
}<< 
}== 
outStr>> 
=>> 
Convert>> $
.>>$ %
ToBase64String>>% 3
(>>3 4
	msEncrypt>>4 =
.>>= >
ToArray>>> E
(>>E F
)>>F G
)>>G H
;>>H I
}?? 
}@@ 
finallyAA 
{BB 
ifDD 
(DD 
aesAlgDD 
!=DD 
nullDD "
)DD" #
aesAlgEE 
.EE 
ClearEE  
(EE  !
)EE! "
;EE" #
}FF 
returnII 
outStrII 
;II 
}JJ 	
publicRR 
staticRR 
stringRR 
DecryptStringAESRR -
(RR- .
stringRR. 4

cipherTextRR5 ?
,RR? @
stringRRA G
sharedSecretRRH T
)RRT U
{SS 	
ifTT 
(TT 
stringTT 
.TT 
IsNullOrEmptyTT $
(TT$ %

cipherTextTT% /
)TT/ 0
)TT0 1
throwUU 
newUU !
ArgumentNullExceptionUU /
(UU/ 0
$strUU0 <
)UU< =
;UU= >
ifVV 
(VV 
stringVV 
.VV 
IsNullOrEmptyVV $
(VV$ %
sharedSecretVV% 1
)VV1 2
)VV2 3
throwWW 
newWW !
ArgumentNullExceptionWW /
(WW/ 0
$strWW0 >
)WW> ?
;WW? @
RijndaelManaged[[ 
aesAlg[[ "
=[[# $
null[[% )
;[[) *
string__ 
	plaintext__ 
=__ 
null__ #
;__# $
tryaa 
{bb 
Rfc2898DeriveBytesdd "
keydd# &
=dd' (
newdd) ,
Rfc2898DeriveBytesdd- ?
(dd? @
sharedSecretdd@ L
,ddL M
_saltddN S
)ddS T
;ddT U
aesAlghh 
=hh 
newhh 
RijndaelManagedhh ,
(hh, -
)hh- .
;hh. /
aesAlgii 
.ii 
Keyii 
=ii 
keyii  
.ii  !
GetBytesii! )
(ii) *
aesAlgii* 0
.ii0 1
KeySizeii1 8
/ii9 :
$numii; <
)ii< =
;ii= >
aesAlgjj 
.jj 
IVjj 
=jj 
keyjj 
.jj  
GetBytesjj  (
(jj( )
aesAlgjj) /
.jj/ 0
	BlockSizejj0 9
/jj: ;
$numjj< =
)jj= >
;jj> ?
ICryptoTransformmm  
	decryptormm! *
=mm+ ,
aesAlgmm- 3
.mm3 4
CreateDecryptormm4 C
(mmC D
aesAlgmmD J
.mmJ K
KeymmK N
,mmN O
aesAlgmmP V
.mmV W
IVmmW Y
)mmY Z
;mmZ [
byteoo 
[oo 
]oo 
bytesoo 
=oo 
Convertoo &
.oo& '
FromBase64Stringoo' 7
(oo7 8

cipherTextoo8 B
)ooB C
;ooC D
usingpp 
(pp 
MemoryStreampp #
	msDecryptpp$ -
=pp. /
newpp0 3
MemoryStreampp4 @
(pp@ A
bytesppA F
)ppF G
)ppG H
{qq 
usingrr 
(rr 
CryptoStreamrr '
	csDecryptrr( 1
=rr2 3
newrr4 7
CryptoStreamrr8 D
(rrD E
	msDecryptrrE N
,rrN O
	decryptorrrP Y
,rrY Z
CryptoStreamModerr[ k
.rrk l
Readrrl p
)rrp q
)rrq r
{ss 
usingtt 
(tt 
StreamReadertt +
	srDecrypttt, 5
=tt6 7
newtt8 ;
StreamReadertt< H
(ttH I
	csDecryptttI R
)ttR S
)ttS T
	plaintextxx %
=xx& '
	srDecryptxx( 1
.xx1 2
	ReadToEndxx2 ;
(xx; <
)xx< =
;xx= >
}yy 
}zz 
}{{ 
finally|| 
{}} 
if 
( 
aesAlg 
!= 
null "
)" #
aesAlg
€€ 
.
€€ 
Clear
€€  
(
€€  !
)
€€! "
;
€€" #
}
 
return
ƒƒ 
	plaintext
ƒƒ 
;
ƒƒ 
}
„„ 	
public
‹‹ 
static
‹‹ 
string
‹‹ 
Encode
‹‹ #
(
‹‹# $
string
‹‹$ *
s
‹‹+ ,
)
‹‹, -
{
ŒŒ 	
byte
 
[
 
]
 
bytes
 
=
 
System
 !
.
! "
Text
" &
.
& '
Encoding
' /
.
/ 0
UTF8
0 4
.
4 5
GetBytes
5 =
(
= >
s
> ?
)
? @
;
@ A
string
ŽŽ 
output
ŽŽ 
=
ŽŽ 
System
ŽŽ "
.
ŽŽ" #
Convert
ŽŽ# *
.
ŽŽ* +
ToBase64String
ŽŽ+ 9
(
ŽŽ9 :
bytes
ŽŽ: ?
)
ŽŽ? @
;
ŽŽ@ A
return
 
output
 
;
 
}
 	
public
—— 
static
—— 
String
—— 
Decode
—— #
(
——# $
string
——$ *
s
——+ ,
)
——, -
{
˜˜ 	
byte
™™ 
[
™™ 
]
™™ 
bytes
™™ 
=
™™ 
System
™™ !
.
™™! "
Convert
™™" )
.
™™) *
FromBase64String
™™* :
(
™™: ;
s
™™; <
)
™™< =
;
™™= >
string
šš 
output
šš 
=
šš 
System
šš "
.
šš" #
Text
šš# '
.
šš' (
Encoding
šš( 0
.
šš0 1
UTF8
šš1 5
.
šš5 6
	GetString
šš6 ?
(
šš? @
bytes
šš@ E
)
ššE F
;
ššF G
return
›› 
output
›› 
;
›› 
}
œœ 	
public
¤¤ 
static
¤¤ 
string
¤¤ 
ToJSONString
¤¤ )
(
¤¤) *
	DataTable
¤¤* 3
dt
¤¤4 6
)
¤¤6 7
{
¥¥ 	
string
¦¦ 
[
¦¦ 
]
¦¦ 
StrDc
¦¦ 
=
¦¦ 
new
¦¦  
string
¦¦! '
[
¦¦' (
dt
¦¦( *
.
¦¦* +
Columns
¦¦+ 2
.
¦¦2 3
Count
¦¦3 8
]
¦¦8 9
;
¦¦9 :
string
¨¨ 
HeadStr
¨¨ 
=
¨¨ 
string
¨¨ #
.
¨¨# $
Empty
¨¨$ )
;
¨¨) *
for
©© 
(
©© 
int
©© 
i
©© 
=
©© 
$num
©© 
;
©© 
i
©© 
<
©© 
dt
©©  "
.
©©" #
Columns
©©# *
.
©©* +
Count
©©+ 0
;
©©0 1
i
©©2 3
++
©©3 5
)
©©5 6
{
ªª 
StrDc
¬¬ 
[
¬¬ 
i
¬¬ 
]
¬¬ 
=
¬¬ 
dt
¬¬ 
.
¬¬ 
Columns
¬¬ %
[
¬¬% &
i
¬¬& '
]
¬¬' (
.
¬¬( )
Caption
¬¬) 0
;
¬¬0 1
HeadStr
­­ 
+=
­­ 
$str
­­ 
+
­­  !
StrDc
­­" '
[
­­' (
i
­­( )
]
­­) *
+
­­+ ,
$str
­­- 6
+
­­7 8
StrDc
­­9 >
[
­­> ?
i
­­? @
]
­­@ A
+
­­B C
i
­­D E
.
­­E F
ToString
­­F N
(
­­N O
)
­­O P
+
­­Q R
$str
­­S V
+
­­W X
$str
­­Y ^
;
­­^ _
}
¯¯ 
HeadStr
±± 
=
±± 
HeadStr
±± 
.
±± 
	Substring
±± '
(
±±' (
$num
±±( )
,
±±) *
HeadStr
±±+ 2
.
±±2 3
Length
±±3 9
-
±±: ;
$num
±±< =
)
±±= >
;
±±> ?
StringBuilder
²² 
Sb
²² 
=
²² 
new
²² "
StringBuilder
²²# 0
(
²²0 1
)
²²1 2
;
²²2 3
Sb
´´ 
.
´´ 
Append
´´ 
(
´´ 
$str
´´ 
+
´´ 
dt
´´  
.
´´  !
	TableName
´´! *
+
´´+ ,
$str
´´- 5
)
´´5 6
;
´´6 7
for
µµ 
(
µµ 
int
µµ 
i
µµ 
=
µµ 
$num
µµ 
;
µµ 
i
µµ 
<
µµ 
dt
µµ  "
.
µµ" #
Rows
µµ# '
.
µµ' (
Count
µµ( -
;
µµ- .
i
µµ/ 0
++
µµ0 2
)
µµ2 3
{
¶¶ 
string
¸¸ 
TempStr
¸¸ 
=
¸¸  
HeadStr
¸¸! (
;
¸¸( )
Sb
ºº 
.
ºº 
Append
ºº 
(
ºº 
$str
ºº 
)
ºº 
;
ºº 
for
»» 
(
»» 
int
»» 
j
»» 
=
»» 
$num
»» 
;
»» 
j
»»  !
<
»»" #
dt
»»$ &
.
»»& '
Columns
»»' .
.
»». /
Count
»»/ 4
;
»»4 5
j
»»6 7
++
»»7 9
)
»»9 :
{
¼¼ 
TempStr
¾¾ 
=
¾¾ 
TempStr
¾¾ %
.
¾¾% &
Replace
¾¾& -
(
¾¾- .
dt
¾¾. 0
.
¾¾0 1
Columns
¾¾1 8
[
¾¾8 9
j
¾¾9 :
]
¾¾: ;
+
¾¾< =
j
¾¾> ?
.
¾¾? @
ToString
¾¾@ H
(
¾¾H I
)
¾¾I J
+
¾¾K L
$str
¾¾M P
,
¾¾P Q
dt
¾¾R T
.
¾¾T U
Rows
¾¾U Y
[
¾¾Y Z
i
¾¾Z [
]
¾¾[ \
[
¾¾\ ]
j
¾¾] ^
]
¾¾^ _
.
¾¾_ `
ToString
¾¾` h
(
¾¾h i
)
¾¾i j
)
¾¾j k
;
¾¾k l
}
ÀÀ 
Sb
ÁÁ 
.
ÁÁ 
Append
ÁÁ 
(
ÁÁ 
TempStr
ÁÁ !
+
ÁÁ" #
$str
ÁÁ$ (
)
ÁÁ( )
;
ÁÁ) *
}
ÃÃ 
Sb
ÄÄ 
=
ÄÄ 
new
ÄÄ 
StringBuilder
ÄÄ "
(
ÄÄ" #
Sb
ÄÄ# %
.
ÄÄ% &
ToString
ÄÄ& .
(
ÄÄ. /
)
ÄÄ/ 0
.
ÄÄ0 1
	Substring
ÄÄ1 :
(
ÄÄ: ;
$num
ÄÄ; <
,
ÄÄ< =
Sb
ÄÄ> @
.
ÄÄ@ A
ToString
ÄÄA I
(
ÄÄI J
)
ÄÄJ K
.
ÄÄK L
Length
ÄÄL R
-
ÄÄS T
$num
ÄÄU V
)
ÄÄV W
)
ÄÄW X
;
ÄÄX Y
Sb
ÆÆ 
.
ÆÆ 
Append
ÆÆ 
(
ÆÆ 
$str
ÆÆ 
)
ÆÆ 
;
ÆÆ 
return
ÇÇ 
Sb
ÇÇ 
.
ÇÇ 
ToString
ÇÇ 
(
ÇÇ 
)
ÇÇ  
;
ÇÇ  !
}
ÈÈ 	
public
ÊÊ 
static
ÊÊ 
string
ÊÊ '
ToJSONSAutocompleteString
ÊÊ 6
(
ÊÊ6 7
string
ÊÊ7 =
query
ÊÊ> C
,
ÊÊC D
	DataTable
ÊÊE N
dt
ÊÊO Q
)
ÊÊQ R
{
ËË 	
char
ÌÌ 
[
ÌÌ 
]
ÌÌ 
	badvalues
ÌÌ 
=
ÌÌ 
{
ÌÌ  
$char
ÌÌ! $
,
ÌÌ$ %
$char
ÌÌ& )
,
ÌÌ) *
$char
ÌÌ+ .
,
ÌÌ. /
$char
ÌÌ0 3
}
ÌÌ3 4
;
ÌÌ4 5
foreach
ÎÎ 
(
ÎÎ 
char
ÎÎ 
c
ÎÎ 
in
ÎÎ 
	badvalues
ÎÎ (
)
ÎÎ( )
query
ÏÏ 
=
ÏÏ 
query
ÏÏ 
.
ÏÏ 
Replace
ÏÏ %
(
ÏÏ% &
c
ÏÏ& '
,
ÏÏ' (
$char
ÏÏ) ,
)
ÏÏ, -
;
ÏÏ- .
StringBuilder
ÑÑ 
sb
ÑÑ 
=
ÑÑ 
new
ÑÑ "
StringBuilder
ÑÑ# 0
(
ÑÑ0 1
)
ÑÑ1 2
;
ÑÑ2 3
sb
ÓÓ 
.
ÓÓ 
Append
ÓÓ 
(
ÓÓ 
$str
ÓÓ "
+
ÓÓ# $
query
ÓÓ% *
+
ÓÓ+ ,
$str
ÓÓ- 3
)
ÓÓ3 4
;
ÓÓ4 5
sb
ÔÔ 
.
ÔÔ 
Append
ÔÔ 
(
ÔÔ 
$str
ÔÔ %
)
ÔÔ% &
;
ÔÔ& '
for
ÖÖ 
(
ÖÖ 
int
ÖÖ 
i
ÖÖ 
=
ÖÖ 
$num
ÖÖ 
;
ÖÖ 
i
ÖÖ 
<
ÖÖ 
dt
ÖÖ  "
.
ÖÖ" #
Rows
ÖÖ# '
.
ÖÖ' (
Count
ÖÖ( -
;
ÖÖ- .
i
ÖÖ/ 0
++
ÖÖ0 2
)
ÖÖ2 3
{
×× 
DataRow
ØØ 
row
ØØ 
=
ØØ 
dt
ØØ  
.
ØØ  !
Rows
ØØ! %
[
ØØ% &
i
ØØ& '
]
ØØ' (
;
ØØ( )
string
ÙÙ 
email
ÙÙ 
=
ÙÙ 
row
ÙÙ "
[
ÙÙ" #
$num
ÙÙ# $
]
ÙÙ$ %
.
ÙÙ% &
ToString
ÙÙ& .
(
ÙÙ. /
)
ÙÙ/ 0
;
ÙÙ0 1
sb
ÚÚ 
.
ÚÚ 
Append
ÚÚ 
(
ÚÚ 
$str
ÚÚ 
+
ÚÚ 
email
ÚÚ  %
+
ÚÚ& '
$str
ÚÚ( ,
)
ÚÚ, -
;
ÚÚ- .
}
ÛÛ 
sb
ÝÝ 
=
ÝÝ 
new
ÝÝ 
StringBuilder
ÝÝ "
(
ÝÝ" #
sb
ÝÝ# %
.
ÝÝ% &
ToString
ÝÝ& .
(
ÝÝ. /
)
ÝÝ/ 0
.
ÝÝ0 1
	Substring
ÝÝ1 :
(
ÝÝ: ;
$num
ÝÝ; <
,
ÝÝ< =
sb
ÝÝ> @
.
ÝÝ@ A
ToString
ÝÝA I
(
ÝÝI J
)
ÝÝJ K
.
ÝÝK L
Length
ÝÝL R
-
ÝÝS T
$num
ÝÝU V
)
ÝÝV W
)
ÝÝW X
;
ÝÝX Y
sb
ÞÞ 
.
ÞÞ 
Append
ÞÞ 
(
ÞÞ 
$str
ÞÞ 
)
ÞÞ 
;
ÞÞ 
sb
ßß 
.
ßß 
Append
ßß 
(
ßß 
$str
ßß 
+
ßß 
sb
ßß  "
.
ßß" #
ToString
ßß# +
(
ßß+ ,
)
ßß, -
.
ßß- .
	Substring
ßß. 7
(
ßß7 8
sb
ßß8 :
.
ßß: ;
ToString
ßß; C
(
ßßC D
)
ßßD E
.
ßßE F
IndexOf
ßßF M
(
ßßM N
$char
ßßN Q
)
ßßQ R
,
ßßR S
(
ßßT U
sb
ßßU W
.
ßßW X
ToString
ßßX `
(
ßß` a
)
ßßa b
.
ßßb c
LastIndexOf
ßßc n
(
ßßn o
$char
ßßo r
)
ßßr s
-
ßßt u
sb
ßßv x
.
ßßx y
ToStringßßy 
(ßß ‚
)ßß‚ ƒ
.ßßƒ „
IndexOfßß„ ‹
(ßß‹ Œ
$charßßŒ 
)ßß 
)ßß ‘
+ßß’ “
$numßß” •
)ßß• –
+ßß— ˜
$strßß™ ž
)ßßž Ÿ
;ßßŸ  
return
áá 
sb
áá 
.
áá 
ToString
áá 
(
áá 
)
áá  
;
áá  !
}
ââ 	
public
ää 
string
ää 
EncodeTicket
ää "
(
ää" #
string
ää# )
token
ää* /
)
ää/ 0
{
åå 	'
FormsAuthenticationTicket
ææ %
ticket
ææ& ,
=
ææ- .
new
çç '
FormsAuthenticationTicket
çç -
(
çç- .
$num
èè 
,
èè 
token
éé 
,
éé 
DateTime
êê 
.
êê 
Now
êê  
,
êê  !
DateTime
ëë 
.
ëë 
Now
ëë  
.
ëë  !
AddDays
ëë! (
(
ëë( )
$num
ëë) +
)
ëë+ ,
,
ëë, -
true
ìì 
,
ìì 
$str
íí 
,
íí !
FormsAuthentication
îî '
.
îî' (
FormsCookiePath
îî( 7
)
ïï 
;
ïï 
return
ññ !
FormsAuthentication
ññ &
.
ññ& '
Encrypt
ññ' .
(
ññ. /
ticket
ññ/ 5
)
ññ5 6
;
ññ6 7
}
òò 	
}
ôô 
}õõ Ì
=C:\work\code\OWASP-WebGoat\WebGoat\App_Code\DB\IDbProvider.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
App_Code $
.$ %
DB% '
{ 
public 

	interface 
IDbProvider  
{ 
string 
Name 
{ 
get 
; 
} 
bool

 
TestConnection

 
(

 
)

 
;

 
DataSet 
GetCatalogData 
( 
)  
;  !
bool  
IsValidCustomerLogin !
(! "
string" (
email) .
,. /
string0 6
password7 ?
)? @
;@ A
bool 
RecreateGoatDb 
( 
) 
; 
string 
GetCustomerEmail 
(  
string  &
customerNumber' 5
)5 6
;6 7
DataSet 
GetCustomerDetails "
(" #
string# )
customerNumber* 8
)8 9
;9 :
DataSet 
	GetOffice 
( 
string  
city! %
)% &
;& '
DataSet 
GetComments 
( 
string "
productCode# .
). /
;/ 0
string 

AddComment 
( 
string  
productCode! ,
,, -
string. 4
email5 :
,: ;
string< B
commentC J
)J K
;K L
string "
UpdateCustomerPassword %
(% &
int& )
customerNumber* 8
,8 9
string: @
passwordA I
)I J
;J K
string 
[ 
] (
GetSecurityQuestionAndAnswer -
(- .
string. 4
email5 :
): ;
;; <
string   
GetPasswordByEmail   !
(  ! "
string  " (
email  ) .
)  . /
;  / 0
DataSet"" 
GetUsers"" 
("" 
)"" 
;"" 
DataSet$$ 
	GetOrders$$ 
($$ 
int$$ 

customerID$$ (
)$$( )
;$$) *
DataSet&& 
GetProductDetails&& !
(&&! "
string&&" (
productCode&&) 4
)&&4 5
;&&5 6
DataSet(( 
GetOrderDetails(( 
(((  
int((  #
orderNumber(($ /
)((/ 0
;((0 1
DataSet** 
GetPayments** 
(** 
int** 
customerNumber**  .
)**. /
;**/ 0
DataSet,, $
GetProductsAndCategories,, (
(,,( )
),,) *
;,,* +
DataSet.. $
GetProductsAndCategories.. (
(..( )
int..) ,
	catNumber..- 6
)..6 7
;..7 8
DataSet00 
GetEmailByName00 
(00 
string00 %
name00& *
)00* +
;00+ ,
string22 $
GetEmailByCustomerNumber22 '
(22' (
string22( .
num22/ 2
)222 3
;223 4
DataSet44 
GetCustomerEmails44 !
(44! "
string44" (
email44) .
)44. /
;44/ 0
}55 
}66 °
CC:\work\code\OWASP-WebGoat\WebGoat\App_Code\DB\DbProviderFactory.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
App_Code $
.$ %
DB% '
{ 
public

 

class

 
DbProviderFactory

 "
{ 
private 
static 
ILog 
log 
=  !

LogManager" ,
., -
	GetLogger- 6
(6 7

MethodBase7 A
.A B
GetCurrentMethodB R
(R S
)S T
.T U
DeclaringTypeU b
)b c
;c d
public 
static 
IDbProvider !
Create" (
(( )

ConfigFile) 3

configFile4 >
)> ?
{ 	

configFile 
. 
Load 
( 
) 
; 
string 
dbType 
= 

configFile &
.& '
Get' *
(* +
DbConstants+ 6
.6 7
KEY_DB_TYPE7 B
)B C
;C D
log 
. 
Info 
( 
$str ,
+- .
dbType/ 5
)5 6
;6 7
switch 
( 
dbType 
) 
{ 
case 
DbConstants  
.  !
DB_TYPE_MYSQL! .
:. /
return 
new 
MySqlDbProvider .
(. /

configFile/ 9
)9 :
;: ;
case 
DbConstants  
.  !
DB_TYPE_SQLITE! /
:/ 0
return 
new 
SqliteDbProvider /
(/ 0

configFile0 :
): ;
;; <
default 
: 
throw 
new 
	Exception '
(' (
string( .
.. /
Format/ 5
(5 6
$str6 Y
,Y Z
dbType[ a
)a b
)b c
;c d
} 
} 	
}   
}!! š!
7C:\work\code\OWASP-WebGoat\WebGoat\App_Code\Settings.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
App_Code $
{ 
public 

class 
Settings 
{		 
public

 
static

 
readonly

 
string

 %
DefaultConfigName

& 7
=

8 9
string

: @
.

@ A
Format

A G
(

G H
$str

H U
,

U V
DbConstants

W b
.

b c

CONFIG_EXT

c m
)

m n
;

n o
private 
const 
string 
PARENT_CONFIG_PATH /
=0 1
$str2 A
;A B
private 
const 
string 
DATA_FOLDER (
=) *
$str+ 5
;5 6
private 
const 
string 
DEFAULT_SQLITE_NAME 0
=1 2
$str3 I
;I J
public 
static 
void 
Init 
(  
HttpServerUtility  1
server2 8
)8 9
{ 	
string 

configPath 
= 
Path  $
.$ %
Combine% ,
(, -
PARENT_CONFIG_PATH- ?
,? @
DefaultConfigNameA R
)R S
;S T
DefaultConfigPath 
= 
server  &
.& '
MapPath' .
(. /

configPath/ 9
)9 :
;: ;
string 
defaultConfigPath $
=% &
DefaultConfigPath' 8
;8 9
string 

sqlitePath 
= 
Path  $
.$ %
Combine% ,
(, -
DATA_FOLDER- 8
,8 9
DEFAULT_SQLITE_NAME: M
)M N
;N O

sqlitePath 
= 
server 
.  
MapPath  '
(' (

sqlitePath( 2
)2 3
;3 4
if 
( 
! 
File 
. 
Exists 
( 
defaultConfigPath .
). /
)/ 0
{ 

ConfigFile 
file 
=  !
new" %

ConfigFile& 0
(0 1
defaultConfigPath1 B
)B C
;C D
file 
. 
Set 
( 
DbConstants $
.$ %
KEY_DB_TYPE% 0
,0 1
DbConstants2 =
.= >
DB_TYPE_SQLITE> L
)L M
;M N
file   
.   
Set   
(   
DbConstants   $
.  $ %
KEY_FILE_NAME  % 2
,  2 3

sqlitePath  4 >
)  > ?
;  ? @
file!! 
.!! 
Save!! 
(!! 
)!! 
;!! 
CurrentConfigFile## !
=##" #
file##$ (
;##( )
}$$ 
else%% 
{&& 
CurrentConfigFile'' !
=''" #
new''$ '

ConfigFile''( 2
(''2 3
defaultConfigPath''3 D
)''D E
;''E F
CurrentConfigFile(( !
.((! "
Load((" &
(((& '
)((' (
;((( )
})) 
CurrentDbProvider++ 
=++ 
DbProviderFactory++  1
.++1 2
Create++2 8
(++8 9
CurrentConfigFile++9 J
)++J K
;++K L
},, 	
public.. 
static.. 
IDbProvider.. !
CurrentDbProvider.." 3
{..4 5
get..6 9
;..9 :
set..; >
;..> ?
}..@ A
public00 
static00 
string00 
DefaultConfigPath00 .
{00/ 0
get001 4
;004 5
private006 =
set00> A
;00A B
}00C D
public22 
static22 

ConfigFile22  
CurrentConfigFile22! 2
{223 4
get225 8
;228 9
set22: =
;22= >
}22? @
}33 
}44 ü
<C:\work\code\OWASP-WebGoat\WebGoat\App_Code\CookieManager.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
App_Code $
{ 
public 

class 
CookieManager 
{ 
public		 
CookieManager		 
(		 
)		 
{

 	
} 	
public 
static 

HttpCookie  
	SetCookie! *
(* +%
FormsAuthenticationTicket+ D
ticketE K
,K L
stringM S
cookieIdT \
,\ ]
string^ d
cookieValuee p
)p q
{ 	
string 
encrypted_ticket #
=$ %
FormsAuthentication& 9
.9 :
Encrypt: A
(A B
ticketB H
)H I
;I J

HttpCookie 
cookie 
= 
new  #

HttpCookie$ .
(. /
FormsAuthentication/ B
.B C
FormsCookieNameC R
,R S
encrypted_ticketT d
)d e
;e f
if 
( 
ticket 
. 
IsPersistent #
)# $
cookie 
. 
Expires 
=  
ticket! '
.' (

Expiration( 2
;2 3
return 
cookie 
; 
}!! 	
}"" 
}## ¾.
AC:\work\code\OWASP-WebGoat\WebGoat\App_Code\DB\DummyDbProvider.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
App_Code $
.$ %
DB% '
{ 
public 

class 
DummyDbProvider  
:! "
IDbProvider# .
{ 
public		 
bool		 
TestConnection		 "
(		" #
)		# $
{

 	
return 
true 
; 
} 	
public 

ConfigFile 
DbConfigFile &
{ 	
get 
; 
set 
; 
} 	
public 
DataSet 
GetCatalogData %
(% &
)& '
{ 	
return 
null 
; 
} 	
public 
bool  
IsValidCustomerLogin (
(( )
string) /
email0 5
,5 6
string7 =
password> F
)F G
{ 	
return 
false 
; 
} 	
public 
bool 
RecreateGoatDb "
(" #
)# $
{ 	
return 
false 
; 
}   	
public"" 
string"" 
GetCustomerEmail"" &
(""& '
string""' -
customerNumber"". <
)""< =
{## 	
return$$ 
string$$ 
.$$ 
Empty$$ 
;$$  
}%% 	
public'' 
DataSet'' 
GetCustomerDetails'' )
('') *
string''* 0
customerNumber''1 ?
)''? @
{(( 	
return)) 
null)) 
;)) 
}** 	
public,, 
DataSet,, 
	GetOffice,,  
(,,  !
string,,! '
city,,( ,
),,, -
{-- 	
return.. 
null.. 
;.. 
}// 	
public11 
DataSet11 
GetComments11 "
(11" #
string11# )
productCode11* 5
)115 6
{22 	
return33 
null33 
;33 
}44 	
public66 
string66 

AddComment66  
(66  !
string66! '
productCode66( 3
,663 4
string665 ;
email66< A
,66A B
string66C I
comment66J Q
)66Q R
{77 	
return88 
string88 
.88 
Empty88 
;88  
}99 	
public;; 
string;; "
UpdateCustomerPassword;; ,
(;;, -
int;;- 0
customerNumber;;1 ?
,;;? @
string;;A G
password;;H P
);;P Q
{<< 	
return== 
string== 
.== 
Empty== 
;==  
}>> 	
public@@ 
string@@ 
[@@ 
]@@ (
GetSecurityQuestionAndAnswer@@ 4
(@@4 5
string@@5 ;
email@@< A
)@@A B
{AA 	
returnBB 
nullBB 
;BB 
}CC 	
publicEE 
stringEE 
GetPasswordByEmailEE (
(EE( )
stringEE) /
emailEE0 5
)EE5 6
{FF 	
returnGG 
stringGG 
.GG 
EmptyGG 
;GG  
}HH 	
publicJJ 
DataSetJJ 
GetUsersJJ 
(JJ  
)JJ  !
{KK 	
returnLL 
nullLL 
;LL 
}MM 	
publicOO 
DataSetOO 
	GetOrdersOO  
(OO  !
intOO! $

customerIDOO% /
)OO/ 0
{PP 	
returnQQ 
nullQQ 
;QQ 
}RR 	
publicTT 
DataSetTT 
GetProductDetailsTT (
(TT( )
stringTT) /
productCodeTT0 ;
)TT; <
{UU 	
returnVV 
nullVV 
;VV 
}WW 	
publicYY 
DataSetYY 
GetOrderDetailsYY &
(YY& '
intYY' *
orderNumberYY+ 6
)YY6 7
{ZZ 	
return[[ 
null[[ 
;[[ 
}\\ 	
public^^ 
DataSet^^ 
GetPayments^^ "
(^^" #
int^^# &
customerNumber^^' 5
)^^5 6
{__ 	
return`` 
null`` 
;`` 
}aa 	
publiccc 
DataSetcc $
GetProductsAndCategoriescc /
(cc/ 0
)cc0 1
{dd 	
returnee 
nullee 
;ee 
}ff 	
publichh 
DataSethh $
GetProductsAndCategorieshh /
(hh/ 0
inthh0 3
	catNumberhh4 =
)hh= >
{ii 	
returnjj 
nulljj 
;jj 
}kk 	
publicmm 
DataSetmm 
GetEmailByNamemm %
(mm% &
stringmm& ,
namemm- 1
)mm1 2
{nn 	
returnoo 
nulloo 
;oo 
}pp 	
publicrr 
stringrr $
GetEmailByCustomerNumberrr .
(rr. /
stringrr/ 5
numrr6 9
)rr9 :
{ss 	
returntt 
stringtt 
.tt 
Emptytt 
;tt  
}uu 	
publicww 
DataSetww 
GetCustomerEmailsww (
(ww( )
stringww) /
emailww0 5
)ww5 6
{xx 	
returnyy 
nullyy 
;yy 
}zz 	
public|| 
string|| 
Name|| 
{}} 	
get~~ 
{~~ 
return~~ 
$str~~  
;~~  !
}~~" #
} 	
}
€€ 
} Ï9
9C:\work\code\OWASP-WebGoat\WebGoat\App_Code\ConfigFile.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
App_Code $
{ 
public 

class 

ConfigFile 
{		 
private

 
string

 
	_filePath

  
;

  !
private 
IDictionary 
< 
string "
," #
string$ *
>* +
	_settings, 5
=6 7
new8 ;

Dictionary< F
<F G
stringG M
,M N
stringO U
>U V
(V W
)W X
;X Y
private 
IDictionary 
< 
string "
," #
string$ *
>* +
_settingComments, <
== >
new? B

DictionaryC M
<M N
stringN T
,T U
stringV \
>\ ]
(] ^
)^ _
;_ `
private 
UTF8Encoding 
	_encoding &
=' (
new) ,
UTF8Encoding- 9
(9 :
): ;
;; <
private 
const 
char 

SPLIT_CHAR %
=& '
$char( +
;+ ,
public 

ConfigFile 
( 
string  
fileName! )
)) *
{ 	
	_filePath 
= 
fileName  
;  !
} 	
public 
void 
Load 
( 
) 
{ 	
string 
comment 
= 
string #
.# $
Empty$ )
;) *
foreach 
( 
string 
line  
in! #
File$ (
.( )
ReadAllLines) 5
(5 6
	_filePath6 ?
)? @
)@ A
{ 
if!! 
(!! 
line!! 
.!! 
Length!! 
==!!  "
$num!!# $
)!!$ %
continue"" 
;"" 
if$$ 
($$ 
line$$ 
[$$ 
$num$$ 
]$$ 
==$$ 
$char$$ "
)$$" #
{%% 
comment&& 
=&& 
line&& "
;&&" #
continue'' 
;'' 
}(( 
string** 
[** 
]** 
tokens** 
=**  !
line**" &
.**& '
Split**' ,
(**, -

SPLIT_CHAR**- 7
)**7 8
;**8 9
if,, 
(,, 
tokens,, 
.,, 
Length,, !
>=,," $
$num,,$ %
),,% &
{-- 
string.. 
key.. 
=..  
tokens..! '
[..' (
$num..( )
]..) *
...* +
ToLower..+ 2
(..2 3
)..3 4
;..4 5
	_settings// 
[// 
key// !
]//! "
=//# $
tokens//% +
[//+ ,
$num//, -
]//- .
;//. /
if11 
(11 
!11 
string11 
.11  
IsNullOrEmpty11  -
(11- .
comment11. 5
)115 6
)116 7
_settingComments22 (
[22( )
key22) ,
]22, -
=22. /
comment220 7
;227 8
}33 
comment55 
=55 
string55  
.55  !
Empty55! &
;55& '
}66 
}77 	
public99 
void99 
Save99 
(99 
)99 
{:: 	
using;; 
(;; 

FileStream;; 
stream;; $
=;;% &
File;;' +
.;;+ ,
Create;;, 2
(;;2 3
	_filePath;;3 <
);;< =
);;= >
{<< 
byte== 
[== 
]== 
data== 
=== 
ToByteArray== )
(==) *
)==* +
;==+ ,
stream?? 
.?? 
Write?? 
(?? 
data?? !
,??! "
$num??# $
,??$ %
data??& *
.??* +
Length??+ 1
)??1 2
;??2 3
}@@ 
}AA 	
privateCC 
byteCC 
[CC 
]CC 
ToByteArrayCC "
(CC" #
)CC# $
{DD 	
StringBuilderEE 
builderEE !
=EE" #
newEE$ '
StringBuilderEE( 5
(EE5 6
)EE6 7
;EE7 8
foreachGG 
(GG 
varGG 
pairGG 
inGG  
	_settingsGG! *
)GG* +
{HH 
ifII 
(II 
_settingCommentsII $
.II$ %
ContainsKeyII% 0
(II0 1
pairII1 5
.II5 6
KeyII6 9
)II9 :
)II: ;
{JJ 
builderKK 
.KK 
AppendKK "
(KK" #
_settingCommentsKK# 3
[KK3 4
pairKK4 8
.KK8 9
KeyKK9 <
]KK< =
)KK= >
;KK> ?
builderLL 
.LL 

AppendLineLL &
(LL& '
)LL' (
;LL( )
}MM 
builderOO 
.OO 
AppendFormatOO $
(OO$ %
$strOO% .
,OO. /
pairOO0 4
.OO4 5
KeyOO5 8
,OO8 9
pairOO: >
.OO> ?
ValueOO? D
)OOD E
;OOE F
builderPP 
.PP 

AppendLinePP "
(PP" #
)PP# $
;PP$ %
}QQ 
returnSS 
	_encodingSS 
.SS 
GetBytesSS %
(SS% &
builderSS& -
.SS- .
ToStringSS. 6
(SS6 7
)SS7 8
)SS8 9
;SS9 :
}TT 	
publicVV 
stringVV 
GetVV 
(VV 
stringVV  
keyVV! $
)VV$ %
{WW 	
keyXX 
=XX 
keyXX 
.XX 
ToLowerXX 
(XX 
)XX 
;XX  
ifZZ 
(ZZ 
	_settingsZZ 
.ZZ 
ContainsKeyZZ %
(ZZ% &
keyZZ& )
)ZZ) *
)ZZ* +
return[[ 
	_settings[[  
[[[  !
key[[! $
][[$ %
;[[% &
return]] 
string]] 
.]] 
Empty]] 
;]]  
}^^ 	
public`` 
void`` 
Set`` 
(`` 
string`` 
key`` "
,``" #
string``$ *
value``+ 0
)``0 1
{aa 	
	_settingsbb 
[bb 
keybb 
.bb 
ToLowerbb !
(bb! "
)bb" #
]bb# $
=bb% &
valuebb' ,
;bb, -
}cc 	
publicee 
voidee 
Removeee 
(ee 
stringee !
keyee" %
)ee% &
{ff 	
	_settingsgg 
.gg 
Removegg 
(gg 
keygg  
.gg  !
ToLowergg! (
(gg( )
)gg) *
)gg* +
;gg+ ,
}hh 	
}ii 
}jj ´
=C:\work\code\OWASP-WebGoat\WebGoat\App_Code\DB\DbConstants.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
App_Code $
.$ %
DB% '
{ 
public 

class 
DbConstants 
{ 
public 
const 
string 
KEY_DB_TYPE '
=( )
$str* 2
;2 3
public		 
const		 
string		 
KEY_CLIENT_EXEC		 +
=		, -
$str		. 6
;		6 7
public

 
const

 
string

 
KEY_HOST

 $
=

% &
$str

' -
;

- .
public 
const 
string 
KEY_PORT $
=% &
$str' -
;- .
public 
const 
string 
KEY_FILE_NAME )
=* +
$str, 6
;6 7
public 
const 
string 
KEY_DATABASE (
=) *
$str+ 5
;5 6
public 
const 
string 
KEY_UID #
=$ %
$str& +
;+ ,
public 
const 
string 
KEY_PWD #
=$ %
$str& +
;+ ,
public 
const 
string 
DB_TYPE_MYSQL )
=* +
$str, 3
;3 4
public 
const 
string 
DB_TYPE_SQLITE *
=+ ,
$str- 5
;5 6
public 
const 
string 

CONFIG_EXT &
=' (
$str) 1
;1 2
public 
const 
string 
DB_CREATE_SCRIPT ,
=- .
$str/ S
;S T
public 
const 
string  
DB_LOAD_MYSQL_SCRIPT 0
=1 2
$str3 U
;U V
public 
const 
string !
DB_LOAD_SQLITE_SCRIPT 1
=2 3
$str4 ^
;^ _
} 
}  ,
3C:\work\code\OWASP-WebGoat\WebGoat\App_Code\Util.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
App_Code $
{		 
public

 

class

 
Util

 
{ 
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @

MethodBase@ J
.J K
GetCurrentMethodK [
([ \
)\ ]
.] ^
DeclaringType^ k
)k l
;l m
public 
static 
int 
RunProcessWithInput -
(- .
string. 4
cmd5 8
,8 9
string: @
argsA E
,E F
stringG M
inputN S
)S T
{ 	
ProcessStartInfo 
	startInfo &
=' (
new) ,
ProcessStartInfo- =
{ 
FileName 
= 
cmd 
, 
	Arguments 
= 
args  
,  !
UseShellExecute 
=  !
false" '
,' (!
RedirectStandardInput %
=& '
true( ,
,, -!
RedirectStandardError %
=& '
true( ,
,, -"
RedirectStandardOutput &
=' (
true) -
,- .
} 
; 
using 
( 
Process 
process "
=# $
new% (
Process) 0
(0 1
)1 2
)2 3
{ 
process 
. 
EnableRaisingEvents +
=, -
true. 2
;2 3
process 
. 
	StartInfo !
=" #
	startInfo$ -
;- .
process 
. 
Start 
( 
) 
;  
process   
.   
OutputDataReceived   *
+=  + -
(  . /
sender  / 5
,  5 6
e  7 8
)  8 9
=>  : <
{  = >
if!! 
(!! 
e!! 
.!! 
Data!! 
!=!! !
null!!" &
)!!& '
log"" 
."" 
Info""  
(""  !
e""! "
.""" #
Data""# '
)""' (
;""( )
}## 
;## 
process%% 
.%% 
ErrorDataReceived%% )
+=%%* ,
(%%- .
sender%%. 4
,%%4 5
e%%6 7
)%%7 8
=>%%9 ;
{&& 
if'' 
('' 
e'' 
.'' 
Data'' 
!='' !
null''" &
)''& '
log(( 
.(( 
Error(( !
(((! "
e((" #
.((# $
Data(($ (
)((( )
;(() *
})) 
;)) 
AutoResetEvent++ 
are++ "
=++# $
new++% (
AutoResetEvent++) 7
(++7 8
false++8 =
)++= >
;++> ?
process-- 
.-- 
Exited-- 
+=-- !
(--" #
sender--# )
,--) *
e--+ ,
)--, -
=>--. 0
{.. 
Thread// 
.// 
Sleep//  
(//  !
$num//! %
)//% &
;//& '
are00 
.00 
Set00 
(00 
)00 
;00 
log11 
.11 
Info11 
(11 
$str11 -
)11- .
;11. /
}22 
;22 
process44 
.44 
Start44 
(44 
)44 
;44  
using66 
(66 
StreamReader66 #
reader66$ *
=66+ ,
new66- 0
StreamReader661 =
(66= >
new66> A

FileStream66B L
(66L M
input66M R
,66R S
FileMode66T \
.66\ ]
Open66] a
)66a b
)66b c
)66c d
{77 
string88 
line88 
;88  
while:: 
(:: 
(:: 
line::  
=::! "
reader::# )
.::) *
ReadLine::* 2
(::2 3
)::3 4
)::4 5
!=::6 8
null::9 =
)::= >
process;; 
.;;  
StandardInput;;  -
.;;- .
	WriteLine;;. 7
(;;7 8
line;;8 <
);;< =
;;;= >
}<< 
process>> 
.>> 
StandardInput>> %
.>>% &
Close>>& +
(>>+ ,
)>>, -
;>>- .
processAA 
.AA 
BeginOutputReadLineAA +
(AA+ ,
)AA, -
;AA- .
processBB 
.BB 
BeginErrorReadLineBB *
(BB* +
)BB+ ,
;BB, -
areGG 
.GG 
WaitOneGG 
(GG 
$numGG 
*GG  
$numGG! %
)GG% &
;GG& '
ifII 
(II 
processII 
.II 
	HasExitedII %
)II% &
returnJJ 
processJJ "
.JJ" #
ExitCodeJJ# +
;JJ+ ,
elseKK 
{LL 
processMM 
.MM 
KillMM  
(MM  !
)MM! "
;MM" #
returnNN 
$numNN 
;NN 
}OO 
}PP 
}QQ 	
}RR 
}SS Í
8C:\work\code\OWASP-WebGoat\WebGoat\Content\Trace.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{		 
public

 

partial

 
class

 
Trace

 
:

  
System

! '
.

' (
Web

( +
.

+ ,
UI

, .
.

. /
Page

/ 3
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
if 
( 
Request 
. 
QueryString #
[# $
$str$ +
]+ ,
==- /
$str0 6
)6 7
{ 
Trace 
. 
	IsEnabled 
=  !
true" &
;& '
} 
} 	
} 
} Ý
AC:\work\code\OWASP-WebGoat\WebGoat\Content\XPathInjection.aspx.cs
	namespace

 	
OWASP


 
.

 
WebGoat

 
.

 
NET

 
{ 
public 

partial 
class 
XPathInjection '
:( )
System* 0
.0 1
Web1 4
.4 5
UI5 7
.7 8
Page8 <
{ 
private 
string 
xml 
= 
$str	 ›
;
› œ
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
if 
( 
Request 
. 
QueryString #
[# $
$str$ +
]+ ,
!=- /
null0 4
)4 5
{ 
FindSalesPerson 
(  
Request  '
.' (
QueryString( 3
[3 4
$str4 ;
]; <
)< =
;= >
} 
} 	
private 
void 
FindSalesPerson $
($ %
string% +
state, 1
)1 2
{ 	
XmlDocument 
xDoc 
= 
new "
XmlDocument# .
(. /
)/ 0
;0 1
xDoc 
. 
LoadXml 
( 
xml 
) 
; 
XmlNodeList 
list 
= 
xDoc #
.# $
SelectNodes$ /
(/ 0
$str0 G
+H I
stateJ O
+P Q
$strR V
)V W
;W X
if 
( 
list 
. 
Count 
> 
$num 
) 
{ 
}   
}"" 	
}## 
}$$ Õ
BC:\work\code\OWASP-WebGoat\WebGoat\Content\HeaderInjection.aspx.cs
	namespace		 	
OWASP		
 
.		 
WebGoat		 
.		 
NET		 
{

 
public 

partial 
class 
HeaderInjection (
:) *
System+ 1
.1 2
Web2 5
.5 6
UI6 8
.8 9
Page9 =
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	

lblHeaders 
. 
Text 
= 
Request %
.% &
Headers& -
.- .
ToString. 6
(6 7
)7 8
.8 9
Replace9 @
(@ A
$strA D
,D E
$strF N
)N O
;O P
;P Q
	ArrayList 

colCookies  
=! "
new# &
	ArrayList' 0
(0 1
)1 2
;2 3
for 
( 
int 
i 
= 
$num 
; 
i 
< 
Request  '
.' (
Cookies( /
./ 0
Count0 5
;5 6
i7 8
++8 :
): ;

colCookies 
. 
Add 
( 
Request &
.& '
Cookies' .
[. /
i/ 0
]0 1
)1 2
;2 3
	gvCookies 
. 

DataSource  
=! "

colCookies# -
;- .
	gvCookies 
. 
DataBind 
( 
)  
;  !
} 	
} 
} Î
@C:\work\code\OWASP-WebGoat\WebGoat\Content\MessageDigest.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
Content #
{		 
public

 

partial

 
class

 
MessageDigest

 &
:

' (
System

) /
.

/ 0
Web

0 3
.

3 4
UI

4 6
.

6 7
Page

7 ;
{ 
private 
readonly 
ILog 
log !
=" #

LogManager$ .
.. /
	GetLogger/ 8
(8 9

MethodBase9 C
.C D
GetCurrentMethodD T
(T U
)U V
.V W
DeclaringTypeW d
)d e
;e f
private 
const 
string 
MSG  
=! "
$str	# ”
;
” •
public 
void 
	Page_Load 
( 
object $
sender% +
,+ ,
	EventArgs- 6
args7 ;
); <
{ 	
	lblDigest 
. 
Text 
= 
WeakMessageDigest .
.. /
GenerateWeakDigest/ A
(A B
MSGB E
)E F
;F G
} 	
public 
void 
btnDigest_Click #
(# $
object$ *
sender+ 1
,1 2
	EventArgs3 <
args= A
)A B
{ 	
string 
result 
= 
WeakMessageDigest -
.- .
GenerateWeakDigest. @
(@ A
	txtBoxMsgA J
.J K
TextK O
)O P
;P Q
log 
. 
Info 
( 
string 
. 
Format "
(" #
$str# ;
,; <
	txtBoxMsg= F
.F G
TextG K
,K L
resultM S
)S T
)T U
;U V
lblResultDigest 
. 
Text  
=! "
result# )
;) *
} 	
} 
} —
?C:\work\code\OWASP-WebGoat\WebGoat\Content\XMLInjection.aspx.cs
	namespace

 	
OWASP


 
.

 
WebGoat

 
.

 
NET

 
{ 
public 

partial 
class 
XMLInjection %
:& '
System( .
.. /
Web/ 2
.2 3
UI3 5
.5 6
Page6 :
{ 
	protected 
void 
	Page_Load  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
} 	
} 
} ”"
@C:\work\code\OWASP-WebGoat\WebGoat\App_Code\WeakMessageDigest.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
. 
App_Code $
{ 
public 

class 
WeakMessageDigest "
{		 
private

 
static

 
readonly

 
ASCIIEncoding

  -
ascii

. 3
=

4 5
new

6 9
ASCIIEncoding

: G
(

G H
)

H I
;

I J
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @

MethodBase@ J
.J K
GetCurrentMethodK [
([ \
)\ ]
.] ^
DeclaringType^ k
)k l
;l m
public 
static 
string 
GenerateWeakDigest /
(/ 0
string0 6
msg7 :
): ;
{ 	
string 
[ 
] 
tokens 
= 
msg !
.! "
Split" '
(' (
new( +
[+ ,
], -
{. /
$char0 3
}4 5
)5 6
;6 7
byte 
[ 
] 
bytes 
= 
new 
byte #
[# $
tokens$ *
.* +
Length+ 1
]1 2
;2 3
for 
( 
int 
i 
= 
$num 
; 
i 
< 
tokens #
.# $
Length$ *
;* +
i, -
++- /
)/ 0
{ 
string 
token 
= 
tokens %
[% &
i& '
]' (
;( )
bytes 
[ 
i 
] 
= 
GenByte "
(" #
token# (
)( )
;) *
} 
log 
. 
Debug 
( 
string 
. 
Format #
(# $
$str$ 6
,6 7
msg8 ;
); <
)< =
;= >
log 
. 
Debug 
( 
Print 
( 
bytes !
)! "
)" #
;# $
return 
ascii 
. 
	GetString "
(" #
bytes# (
)( )
;) *
} 	
public!! 
static!! 
byte!! 
GenByte!! "
(!!" #
string!!# )
word!!* .
)!!. /
{"" 	
int## 
val## 
=## 
$num## 
;## 
byte$$ 
bVal$$ 
;$$ 
foreach&& 
(&& 
char&& 
c&& 
in&& 
word&& "
)&&" #
val'' 
+='' 
('' 
byte'' 
)'' 
c'' 
;''  
bVal** 
=** 
(** 
byte** 
)** 
(** 
val** 
%**  
(**! "
$num**" %
-**& '
$num**( *
-**+ ,
$num**, -
)**- .
+**/ 0
$num**1 3
)**3 4
;**4 5
return,, 
bVal,, 
;,, 
}-- 	
private// 
static// 
string// 
Print// #
(//# $
byte//$ (
[//( )
]//) *
bytes//+ 0
)//0 1
{00 	
StringBuilder11 
strBuild11 "
=11# $
new11% (
StringBuilder11) 6
(116 7
)117 8
;118 9
foreach33 
(33 
byte33 
b33 
in33 
bytes33 #
)33# $
strBuild44 
.44 
AppendFormat44 %
(44% &
$str44& ,
,44, -
b44. /
)44/ 0
;440 1
return66 
strBuild66 
.66 
ToString66 $
(66$ %
)66% &
;66& '
}77 	
}88 
}:: 
>C:\work\code\OWASP-WebGoat\WebGoat\Content\ReadlineDoS.aspx.cs
	namespace 	
OWASP
 
. 
WebGoat 
. 
NET 
{ 
public 

partial 
class 
ReadlineDoS $
:% &
System' -
.- .
Web. 1
.1 2
UI2 4
.4 5
Page5 9
{		 
	protected

 
void

 
	Page_Load

  
(

  !
object

! '
sender

( .
,

. /
	EventArgs

0 9
e

: ;
)

; <
{ 	
} 	
	protected 
void 
btnUpload_Click &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
lblFileContent 
. 
Text 
=  !
String" (
.( )
Empty) .
;. /
Stream 
fileContents 
=  !
file1" '
.' (

PostedFile( 2
.2 3
InputStream3 >
;> ?
using 
( 
StreamReader 
reader  &
=' (
new) ,
StreamReader- 9
(9 :
fileContents: F
)F G
)G H
{ 
while 
( 
! 
reader 
. 
EndOfStream *
)* +
{ 
lblFileContent "
." #
Text# '
+=( *
reader+ 1
.1 2
ReadLine2 :
(: ;
); <
+= >
$str? G
;G H
} 
} 
} 	
} 
} 